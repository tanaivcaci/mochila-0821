(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1334:function(t,e){e.__esModule=!0;e.ATTRIBUTE_NAMES={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"};var n=e.TAG_NAMES={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"},r=(e.VALID_TAG_NAMES=Object.keys(n).map(function(t){return n[t]}),e.TAG_PROPERTIES={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src"},e.REACT_TAG_MAP={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"});e.HELMET_PROPS={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},e.HTML_TAG_MAP=Object.keys(r).reduce(function(t,e){return t[r[e]]=e,t},{}),e.SELF_CLOSING_TAGS=[n.NOSCRIPT,n.SCRIPT,n.STYLE],e.HELMET_ATTRIBUTE="data-react-helmet"},1352:function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}n.r(e),n.d(e,"LogLevel",function(){return i}),n.d(e,"Logger",function(){return u}),n.d(e,"setLogLevel",function(){return c});var i,o=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));var a=i.INFO,s=function(t,e){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(!(e<t.logLevel)){var a=(new Date).toISOString();switch(e){case i.DEBUG:case i.VERBOSE:console.log.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.INFO:console.info.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.WARN:console.warn.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.ERROR:console.error.apply(console,r(["["+a+"]  "+t.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},u=function(){function t(t){this.name=t,this._logLevel=a,this._logHandler=s,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.ERROR],t))},t}();function c(t){o.forEach(function(e){e.logLevel=t})}},1391:function(t,e,n){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var i=n(0),o=r(i),a=r(n(906)),s=r(n(365));t.exports=function(t,e,n){if("function"!=typeof t)throw new Error("Expected reducePropsToState to be a function.");if("function"!=typeof e)throw new Error("Expected handleStateChangeOnClient to be a function.");if(void 0!==n&&"function"!=typeof n)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(r){if("function"!=typeof r)throw new Error("Expected WrappedComponent to be a React component.");var u=[],c=void 0;function h(){c=t(u.map(function(t){return t.props})),l.canUseDOM?e(c):n&&(c=n(c))}var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.peek=function(){return c},e.rewind=function(){if(e.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var t=c;return c=void 0,u=[],t},e.prototype.shouldComponentUpdate=function(t){return!s(t,this.props)},e.prototype.componentWillMount=function(){u.push(this),h()},e.prototype.componentDidUpdate=function(){h()},e.prototype.componentWillUnmount=function(){var t=u.indexOf(this);u.splice(t,1),h()},e.prototype.render=function(){return o.createElement(r,this.props)},e}(i.Component);return l.displayName="SideEffect("+function(t){return t.displayName||t.name||"Component"}(r)+")",l.canUseDOM=a.canUseDOM,l}}},1392:function(t,e,n){var r=Array.prototype.slice,i=n(1393),o=n(1394),a=t.exports=function(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?n.strict?t===e:t==e:function(t,e,n){var c,h;if(s(t)||s(e))return!1;if(t.prototype!==e.prototype)return!1;if(o(t))return!!o(e)&&(t=r.call(t),e=r.call(e),a(t,e,n));if(u(t)){if(!u(e))return!1;if(t.length!==e.length)return!1;for(c=0;c<t.length;c++)if(t[c]!==e[c])return!1;return!0}try{var l=i(t),f=i(e)}catch(p){return!1}if(l.length!=f.length)return!1;for(l.sort(),f.sort(),c=l.length-1;c>=0;c--)if(l[c]!=f[c])return!1;for(c=l.length-1;c>=0;c--)if(h=l[c],!a(t[h],e[h],n))return!1;return typeof t==typeof e}(t,e,n))};function s(t){return null==t}function u(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}},1393:function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n},1394:function(t,e){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function i(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=n?r:i).supported=r,e.unsupported=i},1395:function(t,e,n){(function(t){e.__esModule=!0,e.warn=e.requestAnimationFrame=e.reducePropsToState=e.mapStateOnServer=e.handleClientStateChange=e.convertReactPropstoHtmlAttributes=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=u(n(0)),a=u(n(17)),s=n(1334);function u(t){return t&&t.__esModule?t:{default:t}}var c,h=function(t){return!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},l=function(t){var e=y(t,s.TAG_NAMES.TITLE),n=y(t,s.HELMET_PROPS.TITLE_TEMPLATE);if(n&&e)return n.replace(/%s/g,function(){return e});var r=y(t,s.HELMET_PROPS.DEFAULT_TITLE);return e||r||void 0},f=function(t){return y(t,s.HELMET_PROPS.ON_CHANGE_CLIENT_STATE)||function(){}},p=function(t,e){return e.filter(function(e){return void 0!==e[t]}).map(function(e){return e[t]}).reduce(function(t,e){return i({},t,e)},{})},d=function(t,e){return e.filter(function(t){return void 0!==t[s.TAG_NAMES.BASE]}).map(function(t){return t[s.TAG_NAMES.BASE]}).reverse().reduce(function(e,n){if(!e.length)for(var r=Object.keys(n),i=0;i<r.length;i++){var o=r[i].toLowerCase();if(-1!==t.indexOf(o)&&n[o])return e.concat(n)}return e},[])},m=function(t,e,n){var i={};return n.filter(function(e){return!!Array.isArray(e[t])||(void 0!==e[t]&&T("Helmet: "+t+' should be of type "Array". Instead found type "'+r(e[t])+'"'),!1)}).map(function(e){return e[t]}).reverse().reduce(function(t,n){var r={};n.filter(function(t){for(var n=void 0,o=Object.keys(t),a=0;a<o.length;a++){var u=o[a],c=u.toLowerCase();-1===e.indexOf(c)||n===s.TAG_PROPERTIES.REL&&"canonical"===t[n].toLowerCase()||c===s.TAG_PROPERTIES.REL&&"stylesheet"===t[c].toLowerCase()||(n=c),-1===e.indexOf(u)||u!==s.TAG_PROPERTIES.INNER_HTML&&u!==s.TAG_PROPERTIES.CSS_TEXT&&u!==s.TAG_PROPERTIES.ITEM_PROP||(n=u)}if(!n||!t[n])return!1;var h=t[n].toLowerCase();return i[n]||(i[n]={}),r[n]||(r[n]={}),!i[n][h]&&(r[n][h]=!0,!0)}).reverse().forEach(function(e){return t.push(e)});for(var o=Object.keys(r),u=0;u<o.length;u++){var c=o[u],h=(0,a.default)({},i[c],r[c]);i[c]=h}return t},[]).reverse()},y=function(t,e){for(var n=t.length-1;n>=0;n--){var r=t[n];if(r.hasOwnProperty(e))return r[e]}return null},g=(c=Date.now(),function(t){var e=Date.now();e-c>16?(c=e,t(e)):setTimeout(function(){g(t)},0)}),v=function(t){return clearTimeout(t)},b="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||g:t.requestAnimationFrame||g,w="undefined"!=typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||v:t.cancelAnimationFrame||v,T=function(t){return console&&"function"==typeof console.warn&&console.warn(t)},E=null,S=function(t,e){var n=t.baseTag,r=t.bodyAttributes,i=t.htmlAttributes,o=t.linkTags,a=t.metaTags,u=t.noscriptTags,c=t.onChangeClientState,h=t.scriptTags,l=t.styleTags,f=t.title,p=t.titleAttributes;A(s.TAG_NAMES.BODY,r),A(s.TAG_NAMES.HTML,i),_(f,p);var d={baseTag:C(s.TAG_NAMES.BASE,n),linkTags:C(s.TAG_NAMES.LINK,o),metaTags:C(s.TAG_NAMES.META,a),noscriptTags:C(s.TAG_NAMES.NOSCRIPT,u),scriptTags:C(s.TAG_NAMES.SCRIPT,h),styleTags:C(s.TAG_NAMES.STYLE,l)},m={},y={};Object.keys(d).forEach(function(t){var e=d[t],n=e.newTags,r=e.oldTags;n.length&&(m[t]=n),r.length&&(y[t]=d[t].oldTags)}),e&&e(),c(t,m,y)},I=function(t){return Array.isArray(t)?t.join(""):t},_=function(t,e){void 0!==t&&document.title!==t&&(document.title=I(t)),A(s.TAG_NAMES.TITLE,e)},A=function(t,e){var n=document.getElementsByTagName(t)[0];if(n){for(var r=n.getAttribute(s.HELMET_ATTRIBUTE),i=r?r.split(","):[],o=[].concat(i),a=Object.keys(e),u=0;u<a.length;u++){var c=a[u],h=e[c]||"";n.getAttribute(c)!==h&&n.setAttribute(c,h),-1===i.indexOf(c)&&i.push(c);var l=o.indexOf(c);-1!==l&&o.splice(l,1)}for(var f=o.length-1;f>=0;f--)n.removeAttribute(o[f]);i.length===o.length?n.removeAttribute(s.HELMET_ATTRIBUTE):n.getAttribute(s.HELMET_ATTRIBUTE)!==a.join(",")&&n.setAttribute(s.HELMET_ATTRIBUTE,a.join(","))}},C=function(t,e){var n=document.head||document.querySelector(s.TAG_NAMES.HEAD),r=n.querySelectorAll(t+"["+s.HELMET_ATTRIBUTE+"]"),i=Array.prototype.slice.call(r),o=[],a=void 0;return e&&e.length&&e.forEach(function(e){var n=document.createElement(t);for(var r in e)if(e.hasOwnProperty(r))if(r===s.TAG_PROPERTIES.INNER_HTML)n.innerHTML=e.innerHTML;else if(r===s.TAG_PROPERTIES.CSS_TEXT)n.styleSheet?n.styleSheet.cssText=e.cssText:n.appendChild(document.createTextNode(e.cssText));else{var u=void 0===e[r]?"":e[r];n.setAttribute(r,u)}n.setAttribute(s.HELMET_ATTRIBUTE,"true"),i.some(function(t,e){return a=e,n.isEqualNode(t)})?i.splice(a,1):o.push(n)}),i.forEach(function(t){return t.parentNode.removeChild(t)}),o.forEach(function(t){return n.appendChild(t)}),{oldTags:i,newTags:o}},N=function(t){return Object.keys(t).reduce(function(e,n){var r=void 0!==t[n]?n+'="'+t[n]+'"':""+n;return e?e+" "+r:r},"")},D=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).reduce(function(e,n){return e[s.REACT_TAG_MAP[n]||n]=t[n],e},e)},k=function(t,e,n){switch(t){case s.TAG_NAMES.TITLE:return{toComponent:function(){return t=e.title,n=e.titleAttributes,(r={key:t})[s.HELMET_ATTRIBUTE]=!0,i=D(n,r),[o.default.createElement(s.TAG_NAMES.TITLE,i,t)];var t,n,r,i},toString:function(){return function(t,e,n,r){var i=N(n),o=I(e);return i?"<"+t+" "+s.HELMET_ATTRIBUTE+'="true" '+i+">"+h(o,r)+"</"+t+">":"<"+t+" "+s.HELMET_ATTRIBUTE+'="true">'+h(o,r)+"</"+t+">"}(t,e.title,e.titleAttributes,n)}};case s.ATTRIBUTE_NAMES.BODY:case s.ATTRIBUTE_NAMES.HTML:return{toComponent:function(){return D(e)},toString:function(){return N(e)}};default:return{toComponent:function(){return function(t,e){return e.map(function(e,n){var r,i=((r={key:n})[s.HELMET_ATTRIBUTE]=!0,r);return Object.keys(e).forEach(function(t){var n=s.REACT_TAG_MAP[t]||t;if(n===s.TAG_PROPERTIES.INNER_HTML||n===s.TAG_PROPERTIES.CSS_TEXT){var r=e.innerHTML||e.cssText;i.dangerouslySetInnerHTML={__html:r}}else i[n]=e[t]}),o.default.createElement(t,i)})}(t,e)},toString:function(){return function(t,e,n){return e.reduce(function(e,r){var i=Object.keys(r).filter(function(t){return!(t===s.TAG_PROPERTIES.INNER_HTML||t===s.TAG_PROPERTIES.CSS_TEXT)}).reduce(function(t,e){var i=void 0===r[e]?e:e+'="'+h(r[e],n)+'"';return t?t+" "+i:i},""),o=r.innerHTML||r.cssText||"",a=-1===s.SELF_CLOSING_TAGS.indexOf(t);return e+"<"+t+" "+s.HELMET_ATTRIBUTE+'="true" '+i+(a?"/>":">"+o+"</"+t+">")},"")}(t,e,n)}}}};e.convertReactPropstoHtmlAttributes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).reduce(function(e,n){return e[s.HTML_TAG_MAP[n]||n]=t[n],e},e)},e.handleClientStateChange=function(t){E&&w(E),t.defer?E=b(function(){S(t,function(){E=null})}):(S(t),E=null)},e.mapStateOnServer=function(t){var e=t.baseTag,n=t.bodyAttributes,r=t.encode,i=t.htmlAttributes,o=t.linkTags,a=t.metaTags,u=t.noscriptTags,c=t.scriptTags,h=t.styleTags,l=t.title,f=void 0===l?"":l,p=t.titleAttributes;return{base:k(s.TAG_NAMES.BASE,e,r),bodyAttributes:k(s.ATTRIBUTE_NAMES.BODY,n,r),htmlAttributes:k(s.ATTRIBUTE_NAMES.HTML,i,r),link:k(s.TAG_NAMES.LINK,o,r),meta:k(s.TAG_NAMES.META,a,r),noscript:k(s.TAG_NAMES.NOSCRIPT,u,r),script:k(s.TAG_NAMES.SCRIPT,c,r),style:k(s.TAG_NAMES.STYLE,h,r),title:k(s.TAG_NAMES.TITLE,{title:f,titleAttributes:p},r)}},e.reducePropsToState=function(t){return{baseTag:d([s.TAG_PROPERTIES.HREF],t),bodyAttributes:p(s.ATTRIBUTE_NAMES.BODY,t),defer:y(t,s.HELMET_PROPS.DEFER),encode:y(t,s.HELMET_PROPS.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:p(s.ATTRIBUTE_NAMES.HTML,t),linkTags:m(s.TAG_NAMES.LINK,[s.TAG_PROPERTIES.REL,s.TAG_PROPERTIES.HREF],t),metaTags:m(s.TAG_NAMES.META,[s.TAG_PROPERTIES.NAME,s.TAG_PROPERTIES.CHARSET,s.TAG_PROPERTIES.HTTPEQUIV,s.TAG_PROPERTIES.PROPERTY,s.TAG_PROPERTIES.ITEM_PROP],t),noscriptTags:m(s.TAG_NAMES.NOSCRIPT,[s.TAG_PROPERTIES.INNER_HTML],t),onChangeClientState:f(t),scriptTags:m(s.TAG_NAMES.SCRIPT,[s.TAG_PROPERTIES.SRC,s.TAG_PROPERTIES.INNER_HTML],t),styleTags:m(s.TAG_NAMES.STYLE,[s.TAG_PROPERTIES.CSS_TEXT],t),title:l(t),titleAttributes:p(s.ATTRIBUTE_NAMES.TITLE,t)}},e.requestAnimationFrame=b,e.warn=T}).call(this,n(25))},1476:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r,i,o=(r=n(898))&&"object"==typeof r&&"default"in r?r.default:r,a=n(793),s=n(1352),u=n(923),c=n(924),h=n(1477),l=o.SDK_VERSION,f=new s.Logger("@firebase/firestore");function p(){return f.logLevel===s.LogLevel.DEBUG?i.DEBUG:f.logLevel===s.LogLevel.SILENT?i.SILENT:i.ERROR}function d(t){switch(t){case i.DEBUG:f.logLevel=s.LogLevel.DEBUG;break;case i.ERROR:f.logLevel=s.LogLevel.ERROR;break;case i.SILENT:f.logLevel=s.LogLevel.SILENT;break;default:f.error("Firestore ("+l+"): Invalid value passed to `setLogLevel`")}}function m(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(f.logLevel<=s.LogLevel.DEBUG){var i=n.map(g);f.debug.apply(f,a.__spreadArrays(["Firestore ("+l+") ["+t+"]: "+e],i))}}function y(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=s.LogLevel.ERROR){var r=e.map(g);f.error.apply(f,a.__spreadArrays(["Firestore ("+l+"): "+t],r))}}function g(t){if("string"==typeof t)return t;var e=w.getPlatform();try{return e.formatJSON(t)}catch(n){return t}}function v(t){var e="FIRESTORE ("+l+") INTERNAL ASSERTION FAILED: "+t;throw y(e),new Error(e)}function b(t,e){t||v(e)}!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(i||(i={}));var w=function(){function t(){}return t.setPlatform=function(e){t.platform&&v("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||v("Platform not set"),t.platform},t}();function T(){return w.getPlatform().emptyByteString}var E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},S=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return a.__extends(e,t),e}(Error);function I(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new S(E.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function _(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function A(t,e){return void 0!==t?t:e}function C(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function N(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function D(t){for(var e in b(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function k(t,e){if(0!==e.length)throw new S(E.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Q(e.length,"argument")+".")}function R(t,e,n){if(e.length!==n)throw new S(E.INVALID_ARGUMENT,"Function "+t+"() requires "+Q(n,"argument")+", but was called with "+Q(e.length,"argument")+".")}function O(t,e,n){if(e.length<n)throw new S(E.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Q(n,"argument")+", but was called with "+Q(e.length,"argument")+".")}function P(t,e,n,r){if(e.length<n||e.length>r)throw new S(E.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Q(e.length,"argument")+".")}function L(t,e,n,r){B(t,e,z(n)+" argument",r)}function M(t,e,n,r){void 0!==r&&L(t,e,n,r)}function x(t,e,n,r){B(t,e,n+" option",r)}function U(t,e,n,r){void 0!==r&&x(t,e,n,r)}function F(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new S(E.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+j(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new S(E.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+j(r[o]))}(t,e,n,r,i)}function V(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(j(u))}var c=j(r);throw new S(E.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function B(t,e,n,r){if(!("object"===e?q(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=j(r);throw new S(E.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function q(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function j(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":v("Unknown wrong type: "+typeof t)}function G(t,e,n){if(void 0===n)throw new S(E.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+z(e)+" argument, but it was undefined.")}function W(t,e,n){N(e,function(e,r){if(n.indexOf(e)<0)throw new S(E.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function K(t,e,n,r){var i=j(r);return new S(E.INVALID_ARGUMENT,"Function "+t+"() requires its "+z(n)+" argument to be a "+e+", but it was: "+i)}function H(t,e,n){if(n<=0)throw new S(E.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+z(e)+" argument to be a positive number, but it was: "+n+".")}function z(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Q(t,e){return t+" "+e+(1===t?"":"s")}var Y=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return b(20===e.length,"Invalid auto ID: "+e),e},t}();function X(t,e){return t<e?-1:t>e?1:0}function J(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function $(t){return t+"\0"}function Z(){if("undefined"==typeof Uint8Array)throw new S(E.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function tt(){if(!w.getPlatform().base64Available)throw new S(E.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var et,nt=function(){function t(t){tt(),this._binaryString=t}return t.fromBase64String=function(e){R("Blob.fromBase64String",arguments,1),L("Blob.fromBase64String","string",1,e),tt();try{return new t(w.getPlatform().atob(e))}catch(n){throw new S(E.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+n)}},t.fromUint8Array=function(e){if(R("Blob.fromUint8Array",arguments,1),Z(),!(e instanceof Uint8Array))throw K("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return R("Blob.toBase64",arguments,0),tt(),w.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){R("Blob.toUint8Array",arguments,0),Z();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._approximateByteSize=function(){return 2*this._binaryString.length},t.prototype._compareTo=function(t){return X(this._binaryString,t._binaryString)},t}(),rt=I(nt,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),it=function(){return function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}}(),ot="(default)",at=function(){function t(t,e){this.projectId=t,this.database=e||ot}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===ot},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return X(this.projectId,t.projectId)||X(this.database,t.database)},t}(),st=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),ut=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&v("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&v("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,b(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return b(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return b(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return b(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new S(E.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(ut),ht=/^[_a-zA-Z][_a-zA-Z0-9]*$/,lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return ht.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new S(E.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new S(E.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new S(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new S(E.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(ut),ft=function(){function t(e){this.path=e,b(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ct.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ct.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ct(e.slice()))},t.fromPathString=function(e){return new t(ct.fromString(e))},t.EMPTY=new t(new ct([])),t}(),pt=function(){return function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}}();!function(t){t.All="all",t.ListenStreamIdle="listen_stream_idle",t.ListenStreamConnectionBackoff="listen_stream_connection_backoff",t.WriteStreamIdle="write_stream_idle",t.WriteStreamConnectionBackoff="write_stream_connection_backoff",t.OnlineStateTimeout="online_state_timeout",t.ClientMetadataRefresh="client_metadata_refresh",t.LruGarbageCollection="lru_garbage_collection",t.RetryTransaction="retry_transaction"}(et||(et={}));var dt=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new pt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new S(E.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),mt=function(){function t(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenAfterShutdown=function(t){this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueEvenAfterShutdown=function(t){return this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueAndInitiateShutdown=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.enqueue=function(t){return this.verifyNotFailed(),this._isShuttingDown?new Promise(function(t){}):this.enqueueInternal(t)},t.prototype.enqueueInternal=function(t){var e=this,n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw y("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),b(e>=0,"Attempted to schedule an operation with a negative delay of "+e),this.timerIdsToSkip.indexOf(t)>-1&&(e=0);var i=dt.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&v("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){b(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueueEvenAfterShutdown(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++){if(n[e].timerId===t)return!0}return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){b(t===et.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==et.All&&i.timerId===t)break}return e.drain()})},t.prototype.skipDelaysForTimerId=function(t){this.timerIdsToSkip.push(t)},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);b(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),yt="",gt="",vt="",bt="";function wt(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Et(e)),e=Tt(t.get(n),e);return Et(e)}function Tt(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=yt+vt;break;case yt:n+=yt+bt;break;default:n+=o}}return n}function Et(t){return t+yt+gt}function St(t){var e=t.length;if(b(e>=2,"Invalid path "+t),2===e)return b(t.charAt(0)===yt&&t.charAt(1)===gt,"Non-empty path "+t+" had length 2"),ct.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(yt,o);switch((a<0||a>n)&&v('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case gt:var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case vt:i+=t.substring(o,a),i+="\0";break;case bt:i+=t.substring(o,a+1);break;default:v('Invalid encoded resource path: "'+t+'"')}o=a+2}return new ct(r)}var It=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new S(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new S(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new S(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new S(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?X(this.nanoseconds,t.nanoseconds):X(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),_t=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new It(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new It(0,0)),t}(),At=function(){function t(t,e){this.comparator=t,this.root=e||Nt.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Nt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nt.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Ct(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Ct(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Ct(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Ct(this.root,t,this.comparator,!0)},t}(),Ct=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){b(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Nt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw v("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw v("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw v("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Dt=function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw v("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw v("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw v("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw v("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw v("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Nt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();Nt.EMPTY=new Dt;var kt=function(){function t(t){this.comparator=t,this.data=new At(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Rt(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Rt(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Rt=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Ot=new At(ft.comparator);function Pt(){return Ot}function Lt(){return Pt()}var Mt=new At(ft.comparator);function xt(){return Mt}var Ut=new At(ft.comparator);function Ft(){return Ut}var Vt=new kt(ft.comparator);function Bt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Vt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var qt=new kt(X);function jt(){return qt}var Gt=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r,b(r.length>0,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&b(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;b(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&b(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++){(s=r[n]).key.isEqual(t)&&(e=s.applyToLocalView(e,e,this.localWriteTime))}for(var i=e,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(t)&&(e=s.applyToLocalView(e,i,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Bt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&J(this.mutations,t.mutations)&&J(this.baseMutations,t.baseMutations)},t}(),Wt=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){b(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Ft(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),Kt=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&v("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++){r(o[i])}return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Ht="SimpleDb",zt=function(){function e(t){this.db=t,12.2===e.getIOSVersion(u.getUA())&&y("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.openOrCreate=function(t,n,r){return b(e.isAvailable(),"IndexedDB not supported in current environment."),m(Ht,"Opening database:",t),new Kt(function(i,o){var a=window.indexedDB.open(t,n);a.onsuccess=function(t){var n=t.target.result;i(new e(n))},a.onblocked=function(){o(new S(E.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new S(E.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},a.onupgradeneeded=function(e){m(Ht,'Database "'+t+'" requires upgrade from version:',e.oldVersion);var n=e.target.result;r.createOrUpgrade(n,a.transaction,e.oldVersion,rn).next(function(){m(Ht,"Database upgrade to version "+rn+" complete")})}}).toPromise()},e.delete=function(t){return m(Ht,"Removing database:",t),Jt(window.indexedDB.deleteDatabase(t)).toPromise()},e.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(e.isMockPersistence())return!0;if(void 0===window.navigator)return!1;var t=u.getUA(),n=e.getIOSVersion(t),r=0<n&&n<10,i=e.getAndroidVersion(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.isMockPersistence=function(){var e;return void 0!==t&&"YES"===(null===(e={})||void 0===e?void 0:e.USE_MOCK_PERSISTENCE)},e.getStore=function(t,e){return t.store(e)},e.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},e.prototype.runTransaction=function(t,e,n){return a.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u,c;return a.__generator(this,function(h){switch(h.label){case 0:r=t.startsWith("readonly"),i=t.endsWith("idempotent"),o=0,s=function(){var t,s,c,h;return a.__generator(this,function(a){switch(a.label){case 0:++o,t=Yt.open(u.db,r?"readonly":"readwrite",e),a.label=1;case 1:return a.trys.push([1,3,,4]),(s=n(t).catch(function(e){return t.abort(e),Kt.reject(e)}).toPromise()).catch(function(){}),[4,t.completionPromise];case 2:return a.sent(),[2,{value:s}];case 3:return c=a.sent(),h=i&&"FirebaseError"!==c.name&&o<3,m(Ht,"Transaction failed with error: %s. Retrying: %s.",c.message,h),h?[3,4]:[2,{value:Promise.reject(c)}];case 4:return[2]}})},u=this,h.label=1;case 1:return[5,s()];case 2:return"object"==typeof(c=h.sent())?[2,c.value]:[3,1];case 3:return[2]}})})},e.prototype.close=function(){this.db.close()},e}(),Qt=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return Jt(this.dbCursor.delete())},t}(),Yt=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new pt,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=Zt(t.target.error);e.completionDeferred.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(m(Ht,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return b(!!e,"Object store not part of transaction: "+t),new Xt(e)},t}(),Xt=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(m(Ht,"PUT",this.store.name,t,e),n=this.store.put(e,t)):(m(Ht,"PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Jt(n)},t.prototype.add=function(t){return m(Ht,"ADD",this.store.name,t,t),Jt(this.store.add(t))},t.prototype.get=function(t){var e=this;return Jt(this.store.get(t)).next(function(n){return void 0===n&&(n=null),m(Ht,"GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return m(Ht,"DELETE",this.store.name,t),Jt(this.store.delete(t))},t.prototype.count=function(){return m(Ht,"COUNT",this.store.name),Jt(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){m(Ht,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new Kt(function(n,r){e.onerror=function(t){var e=Zt(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.iterateCursor=function(t,e){var n=[];return new Kt(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Qt(i),a=e(i.primaryKey,i.value,o);if(a instanceof Kt){var s=a.catch(function(t){return o.done(),Kt.reject(t)});n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return Kt.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(b(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Jt(t){return new Kt(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Zt(t.target.error);n(e)}})}var $t=!1;function Zt(t){var e=zt.getIOSVersion(u.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new S("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return $t||($t=!0,setTimeout(function(){throw r},0)),r}}return t}var te=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){return b(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ie(t).iterate({index:cn.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next(function(e){return e.lastStreamToken=re(n),ae(t).put(e)})},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next(function(t){return t.lastStreamToken})},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next(function(n){return n.lastStreamToken=re(e),ae(t).put(n)})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=oe(t),a=ie(t);return a.add({}).next(function(s){b("number"==typeof s,"Auto-generated key is not a number");for(var u=new Gt(s,e,n,r),c=i.serializer.toDbMutationBatch(i.userId,u),h=[],l=new kt(function(t,e){return X(t.canonicalString(),e.canonicalString())}),f=0,p=r;f<p.length;f++){var d=p[f],m=hn.key(i.userId,d.key.path,s);l=l.add(d.key.path.popLast()),h.push(a.put(c)),h.push(o.put(m,hn.PLACEHOLDER))}return l.forEach(function(e){h.push(i.indexManager.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.documentKeysByBatchId[s]=u.keys()}),Kt.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return ie(t).get(e).next(function(t){return t?(b(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null})},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?Kt.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return ie(t).iterate({index:cn.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(b(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ie(t).iterate({index:cn.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ie(t).loadAll(cn.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=hn.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return oe(t).iterate({range:i},function(r,i,a){var s=r[0],u=r[1],c=r[2],h=St(u);if(s===n.userId&&e.path.isEqual(h))return ie(t).get(c).next(function(t){if(!t)throw v("Dangling document-mutation reference found: "+r+" which points to "+c);b(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))});a.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new kt(X),i=[];return e.forEach(function(e){var o=hn.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=oe(t).iterate({range:a},function(t,i,o){var a=t[0],s=t[1],u=t[2],c=St(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()});i.push(s)}),Kt.waitFor(i).next(function(){return n.lookupMutationBatches(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;b(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),b(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=hn.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new kt(X);return oe(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],h=St(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()}).next(function(){return n.lookupMutationBatches(t,s)})},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(ie(t).get(e).next(function(t){if(null===t)throw v("Dangling document-mutation reference found, which points to "+e);b(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))}))}),Kt.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return ne(t.simpleDbTransaction,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.removeCachedMutationKeys(e.batchId)}),Kt.forEach(r,function(e){return n.referenceDelegate.removeMutationReference(t,e)})})},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Kt.resolve();var r=IDBKeyRange.lowerBound(hn.prefixForUser(e.userId)),i=[];return oe(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=St(t[1]);i.push(o)}else r.done()}).next(function(){b(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.containsKey=function(t,e){return ee(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return ae(t).get(this.userId).next(function(t){return t||new un(e.userId,-1,"")})},t}();function ee(t,e,n){var r=hn.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return oe(t).iterate({range:o,keysOnly:!0},function(t,n,r){var o=t[0],s=t[1];t[2];o===e&&s===i&&(a=!0),r.done()}).next(function(){return a})}function ne(t,e,n){var r=t.store(cn.store),i=t.store(hn.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},function(t,e,n){return s++,n.delete()});o.push(u.next(function(){b(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=hn.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Kt.waitFor(o).next(function(){return c})}function re(t){return t instanceof Uint8Array?(b(zt.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function ie(t){return zn.getStore(t,cn.store)}function oe(t){return zn.getStore(t,hn.store)}function ae(t){return zn.getStore(t,un.store)}var se,ue=1;!function(t){t[t.QueryCache=0]="QueryCache",t[t.SyncEngine=1]="SyncEngine"}(se||(se={}));var ce=function(){function t(t,e){this.generatorId=t,b((t&ue)===t,"Generator ID "+t+" contains more than "+ue+" reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<ue,t},t.prototype.after=function(t){return this.seek(t+(1<<ue)),this.next()},t.prototype.seek=function(t){b((t&ue)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forTargetCache=function(){return new t(se.QueryCache,2)},t.forSyncEngine=function(){return new t(se.SyncEngine)},t}(),he=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=ce.forTargetCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next(function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next(function(t){return _t.fromTimestamp(new It(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return pe(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.saveTargetData(t,e).next(function(){return n.retrieveMetadata(t).next(function(r){return r.targetCount+=1,n.updateMetadataFromTargetData(e,r),n.saveMetadata(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.saveTargetData(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return le(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return b(e.targetCount>0,"Removing from an empty target cache"),e.targetCount-=1,n.saveMetadata(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return le(t).iterate(function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return Kt.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){var n=this;return le(t).iterate(function(t,r){var i=n.serializer.fromDbTarget(r);e(i)})},t.prototype.retrieveMetadata=function(t){return fe(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,zn.getStore(n,gn.store)).put(gn.key,e);var n},t.prototype.saveTargetData=function(t,e){return le(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromTargetData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.retrieveMetadata(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return le(t).iterate({range:i,index:mn.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.target)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=de(t);return e.forEach(function(e){var a=wt(e.path);i.push(o.put(new yn(n,a))),i.push(r.referenceDelegate.addReference(t,e))}),Kt.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=de(t);return Kt.forEach(e,function(e){var o=wt(e.path);return Kt.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=de(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=de(t),i=Bt();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=St(t[1]),o=new ft(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=wt(e.path),r=IDBKeyRange.bound([n],[$(n)],!1,!0),i=0;return de(t).iterate({index:yn.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){var r=t[0];t[1];0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.getTargetDataForTarget=function(t,e){var n=this;return le(t).get(e).next(function(t){return t?n.serializer.fromDbTarget(t):null})},t}();function le(t){return zn.getStore(t,mn.store)}function fe(t){return zt.getStore(t,gn.store).get(gn.key).next(function(t){return b(null!==t,"Missing metadata row."),t})}function pe(t){return fe(t).next(function(t){return t.highestListenSequenceNumber})}function de(t){return zn.getStore(t,yn.store)}var me,ye=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new kt(lt.comparator);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach(function(n){n.isPrefixOf(t)&&(e=!0)}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),ge=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),ve=function(){return function(t,e){this.version=t,this.transformResults=e}}();!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete",t[t.Verify=4]="Verify"}(me||(me={}));var be,we,Te=function(){function t(t,e){this.updateTime=t,this.exists=e,b(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof Ke&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof Ke:(b(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!=e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),Ee=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&b(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof Ke?t.version:_t.MIN},t}(),Se=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=me.Set,i}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),b(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new Ke(this.key,n,{hasCommittedMutations:!0},this.value)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Ee.getPostMutationVersion(t);return new Ke(this.key,r,{hasLocalMutations:!0},this.value)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(Ee),Ie=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=me.Patch,o}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),b(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new ze(this.key,e.version);var n=this.patchDocument(t);return new Ke(this.key,e.version,{hasCommittedMutations:!0},n)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Ee.getPostMutationVersion(t),i=this.patchDocument(t);return new Ke(this.key,r,{hasLocalMutations:!0},i)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof Ke?t.data():je.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t=null!==r?t.set(n,r):t.delete(n)}}),t},e}(Ee),_e=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=me.Transform,r.precondition=Te.exists(!0),r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),b(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new ze(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data(),r);return new Ke(this.key,i,{hasCommittedMutations:!0},o)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,t,e),o=this.transformObject(r.data(),i);return new Ke(this.key,r.version,{hasLocalMutations:!0},o)},e.prototype.extractBaseValue=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ke?t.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(e=null==e?je.EMPTY.set(i.field,a):e.set(i.field,a))}return e},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&J(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){return b(t instanceof Ke,"Unknown MaybeDocument type "+t),b(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},e.prototype.serverTransformResults=function(t,e){var n=[];b(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof Ke&&(a=t.field(i.field)),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;e instanceof Ke&&(u=e.field(a.field)),null===u&&n instanceof Ke&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,t))}return r},e.prototype.transformObject=function(t,e){b(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},e}(Ee),Ae=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=me.Delete,r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),b(null==e.transformResults,"Transform results received by DeleteMutation."),new He(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&b(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new He(this.key,_t.forDeletedDoc())):t},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(Ee),Ce=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=me.Verify,r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){v("VerifyMutation should only be used in Transactions.")},e.prototype.applyToLocalView=function(t,e,n){v("VerifyMutation should only be used in Transactions.")},e.prototype.extractBaseValue=function(t){v("VerifyMutation should only be used in Transactions.")},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(Ee);!function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(be||(be={})),function(t){t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous"}(we||(we={}));var Ne=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(we.Estimate,n);case"previous":return new t(we.Previous,n);case"none":case void 0:return new t(we.Default,n);default:return v("fromSnapshotOptions() called with invalid options.")}},t}(),De=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return b(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),X(this.typeOrder,t.typeOrder)},t}(),ke=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=be.NullValue,e.internalValue=null,e}return a.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.prototype.approximateByteSize=function(){return 4},e.INSTANCE=new e,e}(De),Re=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.BooleanValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?X(this,t):this.defaultCompareTo(t)},e.prototype.approximateByteSize=function(){return 4},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(De),Oe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.NumberValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue,r=t.internalValue,n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1):this.defaultCompareTo(t);var n,r},e.prototype.approximateByteSize=function(){return 8},e}(De);function Pe(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var Le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Pe(this.internalValue,t.internalValue)},e}(Oe),Me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Pe(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(Oe),xe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.StringValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?X(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e.prototype.approximateByteSize=function(){return 2*this.internalValue.length},e}(De),Ue=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.TimestampValue,n}return a.__extends(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof Fe?-1:this.defaultCompareTo(t)},e.prototype.approximateByteSize=function(){return 16},e}(De),Fe=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=be.TimestampValue,r}return a.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===we.Estimate?new Ue(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===we.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Ue?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e.prototype.approximateByteSize=function(){return 16+(this.previousValue?this.previousValue.approximateByteSize():0)},e}(De),Ve=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.BlobValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e.prototype.approximateByteSize=function(){return this.internalValue._approximateByteSize()},e}(De),Be=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=be.RefValue,r}return a.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:ft.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e.prototype.approximateByteSize=function(){return this.databaseId.projectId.length+this.databaseId.database.length+this.key.toString().length},e}(De),qe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.GeoPointValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e.prototype.approximateByteSize=function(){return 16},e}(De),je=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.ObjectValue,n}return a.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=X(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return X(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(b(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(b(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return null!==this.field(t)},e.prototype.field=function(t){b(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e?n.internalValue.get(t):null}),n},e.prototype.fieldMask=function(){var t=new kt(lt.comparator);return this.internalValue.forEach(function(n,r){var i=new lt([n]);if(r instanceof e){var o=r.fieldMask().fields;o.isEmpty()?t=t.add(i):o.forEach(function(e){t=t.add(i.child(e))})}else t=t.add(i)}),ye.fromSet(t)},e.prototype.approximateByteSize=function(){var t=0;return this.internalValue.inorderTraversal(function(e,n){t+=e.length+n.approximateByteSize()}),t},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new At(X)),e}(De),Ge=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=be.ArrayValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.contains=function(t){for(var e=0,n=this.internalValue;e<n.length;e++){if(n[e].isEqual(t))return!0}return!1},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return X(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.approximateByteSize=function(){return this.internalValue.reduce(function(t,e){return t+e.approximateByteSize()},0)},e.prototype.toString=function(){return"["+this.internalValue.map(function(t){return t.toString()}).join(",")+"]"},e}(De),We=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return ft.comparator(t.key,e.key)},t}(),Ke=function(t){function e(e,n,r,i,o,a){var s=t.call(this,e,n)||this;return s.objectValue=i,s.proto=o,s.converter=a,b(void 0!==s.objectValue||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.hasLocalMutations=!!r.hasLocalMutations,s.hasCommittedMutations=!!r.hasCommittedMutations,s}return a.__extends(e,t),e.prototype.field=function(t){if(this.objectValue)return this.objectValue.field(t);this.fieldValueCache||(this.fieldValueCache=new Map);var e=t.canonicalString(),n=this.fieldValueCache.get(e);if(void 0===n){var r=this.getProtoField(t);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(e,n)}return n},e.prototype.data=function(){var t=this;if(!this.objectValue){var e=je.EMPTY;N(this.proto.fields||{},function(n,r){e=e.set(new lt([n]),t.converter(r))}),this.objectValue=e,this.fieldValueCache=void 0}return this.objectValue},e.prototype.value=function(){return this.data().value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.getProtoField=function(t){b(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields?this.proto.fields[t.firstSegment()]:void 0,n=1;n<t.length;++n){if(!e||!e.mapValue||!e.mapValue.fields)return;e=e.mapValue.fields[t.get(n)]}return e},e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.compareTo(i):v("Trying to compare documents on fields that don't exist")},e}(We),He=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return a.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(We),ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(We),Qe=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){N(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return D(this.inner)},t}(),Ye=function(){function t(){this.changes=new Qe(function(t){return t.toString()}),this.changesApplied=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return b(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(t){b(void 0===this._readTime||this._readTime.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=t},enumerable:!0,configurable:!0}),t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.readTime=e,this.changes.set(t.key,t)},t.prototype.removeEntry=function(t,e){this.assertNotApplied(),e&&(this.readTime=e),this.changes.set(t,null)},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Kt.resolve(n):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){b(!this.changesApplied,"Changes have already been applied.")},t}(),Xe=function(){function t(t,e){this.serializer=t,this.indexManager=e}return t.prototype.addEntry=function(t,e,n){return $e(t).put(Ze(e),n)},t.prototype.removeEntry=function(t,e){var n=$e(t),r=Ze(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.setMetadata(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return $e(t).get(Ze(e)).next(function(t){return n.maybeDecodeDocument(t)})},t.prototype.getSizedEntry=function(t,e){var n=this;return $e(t).get(Ze(e)).next(function(t){var e=n.maybeDecodeDocument(t);return e?{maybeDocument:e,size:tn(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Lt();return this.forEachDbEntry(t,e,function(t,e){var i=n.maybeDecodeDocument(e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.getSizedEntries=function(t,e){var n=this,r=Lt(),i=new At(ft.comparator);return this.forEachDbEntry(t,e,function(t,e){var o=n.maybeDecodeDocument(e);o?(r=r.insert(t,o),i=i.insert(t,tn(e))):(r=r.insert(t,null),i=i.insert(t,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return Kt.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return $e(t).iterate({range:r},function(t,e,r){for(var a=ft.fromSegments(t);o&&ft.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this;b(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=xt(),o=e.path.length+1,a={};if(n.isEqual(_t.MIN)){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=this.serializer.toDbTimestampKey(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=pn.collectionReadTimeIndex}return $e(t).iterate(a,function(t,n,a){if(t.length===o){var s=r.serializer.fromDbRemoteDocument(n);e.path.isPrefixOf(s.key.path)?s instanceof Ke&&e.matches(s)&&(i=i.insert(s.key,s)):a.done()}}).next(function(){return i})},t.prototype.getNewDocumentChanges=function(t,e){var n=this,r=Pt(),i=this.serializer.toDbTimestampKey(e),o=$e(t),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:pn.readTimeIndex,range:a},function(t,e){var o=n.serializer.fromDbRemoteDocument(e);r=r.insert(o.key,o),i=e.readTime}).next(function(){return{changedDocs:r,readTime:n.serializer.fromDbTimestampKey(i)}})},t.prototype.getLastReadTime=function(t){var e=this,n=$e(t),r=_t.MIN;return n.iterate({index:pn.readTimeIndex,reverse:!0},function(t,n,i){n.readTime&&(r=e.serializer.fromDbTimestampKey(n.readTime)),i.done()}).next(function(){return r})},t.prototype.newChangeBuffer=function(e){return new t.RemoteDocumentChangeBuffer(this,!!e&&e.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Je(t).get(dn.key).next(function(t){return b(!!t,"Missing document cache metadata"),t})},t.prototype.setMetadata=function(t,e){return Je(t).put(dn.key,e)},t.prototype.maybeDecodeDocument=function(t){if(t){var e=this.serializer.fromDbRemoteDocument(t);return e instanceof He&&e.version.isEqual(_t.forDeletedDoc())?null:e}return null},t.RemoteDocumentChangeBuffer=function(t){function e(e,n){var r=t.call(this)||this;return r.documentCache=e,r.trackRemovals=n,r.documentSizes=new Qe(function(t){return t.toString()}),r}return a.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new kt(function(t,e){return X(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,a){var s=e.documentSizes.get(o);if(b(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){b(!e.readTime.isEqual(_t.MIN),"Cannot add a document with a read time of zero");var u=e.documentCache.serializer.toDbRemoteDocument(a,e.readTime);i=i.add(o.path.popLast());var c=tn(u);r+=c-s,n.push(e.documentCache.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var h=e.documentCache.serializer.toDbRemoteDocument(new He(o,_t.forDeletedDoc()),e.readTime);n.push(e.documentCache.addEntry(t,o,h))}else n.push(e.documentCache.removeEntry(t,o))}),i.forEach(function(r){n.push(e.documentCache.indexManager.addToCollectionParentIndex(t,r))}),n.push(this.documentCache.updateMetadata(t,r)),Kt.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntry(t,e).next(function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntries(t,e).next(function(t){var e=t.maybeDocuments;return t.sizeMap.forEach(function(t,e){n.documentSizes.set(t,e)}),e})},e}(Ye),t}();function Je(t){return zn.getStore(t,dn.store)}function $e(t){return zn.getStore(t,pn.store)}function Ze(t){return t.path.toArray()}function tn(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw v("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var en=function(){function t(){this.collectionParentIndex=new nn}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),Kt.resolve()},t.prototype.getCollectionParents=function(t,e){return Kt.resolve(this.collectionParentIndex.getEntries(e))},t}(),nn=function(){function t(){this.index={}}return t.prototype.add=function(t){b(t.length%2==1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new kt(ct.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new kt(ct.comparator)).toArray()},t}(),rn=9,on=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;b(n<r&&n>=0&&r<=rn,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new Yt(e);n<1&&r>=1&&(function(t){t.createObjectStore(sn.store)}(t),function(t){t.createObjectStore(un.store,{keyPath:un.keyPath}),t.createObjectStore(cn.store,{keyPath:cn.keyPath,autoIncrement:!0}).createIndex(cn.userMutationsIndex,cn.userMutationsKeyPath,{unique:!0}),t.createObjectStore(hn.store)}(t),bn(t),function(t){t.createObjectStore(pn.store)}(t));var a=Kt.resolve();return n<3&&r>=3&&(0!==n&&(!function(t){t.deleteObjectStore(yn.store),t.deleteObjectStore(mn.store),t.deleteObjectStore(gn.store)}(t),bn(t)),a=a.next(function(){return t=o.store(gn.store),e=new gn(0,0,_t.MIN.toTimestamp(),0),t.put(gn.key,e);var t,e})),n<4&&r>=4&&(0!==n&&(a=a.next(function(){return function(t,e){return e.store(cn.store).loadAll().next(function(n){t.deleteObjectStore(cn.store);var r=t.createObjectStore(cn.store,{keyPath:cn.keyPath,autoIncrement:!0});r.createIndex(cn.userMutationsIndex,cn.userMutationsKeyPath,{unique:!0});var i=e.store(cn.store),o=n.map(function(t){return i.put(t)});return Kt.waitFor(o)})}(t,o)})),a=a.next(function(){!function(t){t.createObjectStore(wn.store,{keyPath:wn.keyPath})}(t)})),n<5&&r>=5&&(a=a.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(a=a.next(function(){return function(t){t.createObjectStore(dn.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(a=a.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(a=a.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(a=a.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(pn.store);e.createIndex(pn.readTimeIndex,pn.readTimeIndexPath,{unique:!1}),e.createIndex(pn.collectionReadTimeIndex,pn.collectionReadTimeIndexPath,{unique:!1})}(e)})),a},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(pn.store).iterate(function(t,n){e+=tn(n)}).next(function(){var n=new dn(e);return t.store(dn.store).put(dn.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(un.store),r=t.store(cn.store);return n.loadAll().next(function(n){return Kt.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(cn.userMutationsIndex,i).next(function(r){return Kt.forEach(r,function(r){b(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return ne(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(yn.store),n=t.store(pn.store);return pe(t).next(function(t){var r=[];return n.iterate(function(n,i){var o=new ct(n),a=function(t){return[0,wt(t)]}(o);r.push(e.get(a).next(function(n){return n?Kt.resolve():function(n){return e.put(new yn(0,wt(n),t))}(o)}))}).next(function(){return Kt.waitFor(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(vn.store,{keyPath:vn.keyPath});var n=e.store(vn.store),r=new nn,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:wt(i)})}};return e.store(pn.store).iterate({keysOnly:!0},function(t,e){var n=new ct(t);return i(n.popLast())}).next(function(){return e.store(hn.store).iterate({keysOnly:!0},function(t,e){t[0];var n=t[1],r=(t[2],St(n));return i(r.popLast())})})},t}();var an=function(){return function(t,e){this.seconds=t,this.nanoseconds=e}}(),sn=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}();var un=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),cn=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}();var hn=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,wt(e)]},t.key=function(t,e,n){return[t,wt(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}();var ln=function(){return function(t,e){this.path=t,this.readTime=e}}(),fn=function(){return function(t,e){this.path=t,this.version=e}}(),pn=function(){function t(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}return t.store="remoteDocuments",t.readTimeIndex="readTimeIndex",t.readTimeIndexPath="readTime",t.collectionReadTimeIndex="collectionReadTimeIndex",t.collectionReadTimeIndexPath=["parentPath","readTime"],t}(),dn=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}();var mn=function(){function t(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),yn=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,b(0===t==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),gn=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),vn=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function bn(t){t.createObjectStore(yn.store,{keyPath:yn.keyPath}).createIndex(yn.documentTargetsIndex,yn.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(mn.store,{keyPath:mn.keyPath}).createIndex(mn.queryTargetsIndexName,mn.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(gn.store)}var wn=function(){function t(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}return t.store="clientMetadata",t.keyPath="clientId",t}();var Tn,En=[un.store,cn.store,hn.store,pn.store,mn.store,sn.store,gn.store,yn.store],Sn=a.__spreadArrays(En,[wn.store]),In=a.__spreadArrays(Sn,[dn.store]),_n=a.__spreadArrays(In,[vn.store]),An=function(){function t(){this.collectionParentsCache=new nn}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(b(e.length%2==1,"Expected a collection path."),!this.collectionParentsCache.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.collectionParentsCache.add(e)});var o={collectionId:r,parent:wt(i)};return Cn(t).put(o)}return Kt.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[$(e),""],!1,!0);return Cn(t).loadAll(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(St(o.parent))}return n})},t}();function Cn(t){return zn.getStore(t,vn.store)}!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(Tn||(Tn={}));var Nn=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=_t.MIN),void 0===o&&(o=_t.MIN),void 0===a&&(a=T()),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken===t.resumeToken&&this.target.isEqual(t.target)},t}(),Dn=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=ft.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new He(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){e=ft.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version);return new ze(e,n)}return v("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t,e){var n=this.toDbTimestampKey(e),r=t.key.path.popLast().toArray();if(t instanceof Ke){var i=t.proto?t.proto:this.remoteSerializer.toDocument(t),o=t.hasCommittedMutations;return new pn(null,null,i,o,n,r)}if(t instanceof He){var a=t.key.path.toArray(),s=this.toDbTimestamp(t.version);o=t.hasCommittedMutations;return new pn(null,new ln(a,s),null,o,n,r)}if(t instanceof ze){a=t.key.path.toArray();var u=this.toDbTimestamp(t.version);return new pn(new fn(a,u),null,null,!0,n,r)}return v("Unexpected MaybeDocument")},t.prototype.toDbTimestampKey=function(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]},t.prototype.fromDbTimestampKey=function(t){var e=new It(t[0],t[1]);return _t.fromTimestamp(e)},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new an(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new It(t.seconds,t.nanoseconds);return _t.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.remoteSerializer.toMutation(t)}),i=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new cn(t,e.batchId,e.localWriteTime.toMillis(),r,i)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.remoteSerializer.fromMutation(t)}),r=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),i=It.fromMillis(t.localWriteTimeMs);return new Gt(t.batchId,i,n,r)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach(function(t){e.push(wt(t.path))}),e},t.prototype.fromDbResourcePaths=function(t){for(var e=Bt(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new ft(St(i)))}return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(t.lastLimboFreeSnapshotVersion):_t.MIN,i=t.resumeToken;return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new Nn(e,t.targetId,Tn.Listen,t.lastListenSequenceNumber,n,r,i)},t.prototype.toDbTarget=function(t){b(Tn.Listen===t.purpose,"Only queries with purpose "+Tn.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion),i=this.toDbTimestamp(t.lastLimboFreeSnapshotVersion);return e=t.target.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.target):this.remoteSerializer.toQueryTarget(t.target),t.resumeToken instanceof Uint8Array?(b(zt.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence ."),n=t.resumeToken.toString()):n=t.resumeToken,new mn(t.targetId,t.target.canonicalId(),r,n,t.sequenceNumber,i,e)},t}();var kn=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.getDocumentInternal(t,e,r)})},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++){t=i[r].applyToLocalView(e,t)}return t})},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=Lt();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++){e=o[i].applyToLocalView(t,e)}r=r.insert(t,e)}),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Pt();return i.forEach(function(t,e){e||(e=new He(t,_t.forDeletedDoc())),o=o.insert(t,e)}),o})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new ft(e)).next(function(t){var e=xt();return t instanceof Ke&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e,n){var r=this;b(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=e.collectionGroup,o=xt();return this.indexManager.getCollectionParents(t,i).next(function(a){return Kt.forEach(a,function(a){var s=e.asCollectionQueryAtPath(a.child(i));return r.getDocumentsMatchingCollectionQuery(t,s,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e,n){var r,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return i=e,o.addMissingBaseDocuments(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,h=r.get(c),l=u.applyToLocalView(h,h,o.localWriteTime);r=l instanceof Ke?r.insert(c,l):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){e.matches(n)||(r=r.remove(t))}),r})},t.prototype.addMissingBaseDocuments=function(t,e,n){for(var r=Bt(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Ie&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ke&&(c=c.insert(t,e))}),c})},t}(),Rn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",On=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),Pn=function(){function t(){this.refsByKey=new kt(Ln.compareByKey),this.refsByTarget=new kt(Ln.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new Ln(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new Ln(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=ft.EMPTY,r=new Ln(n,t),i=new Ln(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t),o.push(t.key)}),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=ft.EMPTY,n=new Ln(e,t),r=new Ln(e,t+1),i=Bt();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new Ln(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Ln=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return ft.comparator(t.key,e.key)||X(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return X(t.targetOrBatchId,e.targetOrBatchId)||ft.comparator(t.key,e.key)},t}(),Mn="LocalStore",xn=function(){function t(t,e,n){this.persistence=t,this.queryEngine=e,this.localViewReferences=new Pn,this.targetDataByTarget=new At(X),this.targetIdByTarget=new Qe(function(t){return t.canonicalId()}),this.lastDocumentChangeReadTime=_t.MIN,b(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(n),this.remoteDocuments=t.getRemoteDocumentCache(),this.targetCache=t.getTargetCache(),this.localDocuments=new kn(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}return t.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},t.prototype.handleUserChange=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r,i=this;return a.__generator(this,function(o){switch(o.label){case 0:return e=this.mutationQueue,n=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",function(r){var o;return i.mutationQueue.getAllMutationBatches(r).next(function(a){return o=a,e=i.persistence.getMutationQueue(t),n=new kn(i.remoteDocuments,e,i.persistence.getIndexManager()),e.getAllMutationBatches(r)}).next(function(t){for(var e=[],i=[],a=Bt(),s=0,u=o;s<u.length;s++){var c=u[s];e.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var p=0,d=t;p<d.length;p++){c=d[p];i.push(c.batchId);for(var m=0,y=c.mutations;m<y.length;m++){f=y[m];a=a.add(f.key)}}return n.getDocuments(r,a).next(function(t){return{affectedDocuments:t,removedBatchIds:e,addedBatchIds:i}})})})];case 1:return r=o.sent(),this.mutationQueue=e,this.localDocuments=n,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,r]}})})},t.prototype.localWrite=function(t){var e,n=this,r=It.now(),i=t.reduce(function(t,e){return t.add(e.key)},Bt());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",function(o){return n.localDocuments.getDocuments(o,i).next(function(i){e=i;for(var a=[],s=0,u=t;s<u.length;s++){var c=u[s],h=c.extractBaseValue(e.get(c.key));null!=h&&a.push(new Ie(c.key,h,h.fieldMask(),Te.exists(!0)))}return n.mutationQueue.addMutationBatch(o,r,a,t)})}).then(function(t){var n=t.applyToLocalDocumentSet(e);return{batchId:t.batchId,changes:n}})},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",function(n){return e.mutationQueue.lookupMutationKeys(n,t).next(function(t){return t?e.localDocuments.getDocuments(n,t):Kt.resolve(null)})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer({trackRemovals:!0});return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){return e.applyWriteToRemoteDocuments(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next(function(t){return b(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.getHighestUnacknowledgedBatchId=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",function(e){return t.targetCache.getLastRemoteSnapshotVersion(e)})},t.prototype.applyRemoteEvent=function(e){var n=this,r=e.snapshotVersion,i=this.targetDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",function(o){var a=n.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=n.targetDataByTarget;var s=[];C(e.targetChanges,function(e,a){var u=i.get(e);if(u){s.push(n.targetCache.removeMatchingKeys(o,a.removedDocuments,e).next(function(){return n.targetCache.addMatchingKeys(o,a.addedDocuments,e)}));var c=a.resumeToken;if(c.length>0){var h=u.withResumeToken(c,r).withSequenceNumber(o.currentSequenceNumber);i=i.insert(e,h),t.shouldPersistTargetData(u,h,a)&&s.push(n.targetCache.updateTargetData(o,h))}}});var u=Pt(),c=Bt();if(e.documentUpdates.forEach(function(t,e){c=c.add(t)}),s.push(a.getEntries(o,c).next(function(t){e.documentUpdates.forEach(function(i,c){var h=t.get(i);c instanceof He&&c.version.isEqual(_t.MIN)?(a.removeEntry(i,r),u=u.insert(i,c)):null==h||c.version.compareTo(h.version)>0||0===c.version.compareTo(h.version)&&h.hasPendingWrites?(b(!_t.MIN.isEqual(r),"Cannot add a document when the remote version is zero"),a.addEntry(c,r),u=u.insert(i,c)):m(Mn,"Ignoring outdated watch update for ",i,". Current version:",h.version," Watch version:",c.version),e.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(o,i))})})),!r.isEqual(_t.MIN)){var h=n.targetCache.getLastRemoteSnapshotVersion(o).next(function(t){return b(r.compareTo(t)>=0,"Watch stream reverted to previous snapshot?? "+r+" < "+t),n.targetCache.setTargetsMetadata(o,o.currentSequenceNumber,r)});s.push(h)}return Kt.waitFor(s).next(function(){return a.apply(o)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(o,u)})}).then(function(t){return n.targetDataByTarget=i,t})},t.shouldPersistTargetData=function(t,e,n){return b(e.resumeToken.length>0,"Attempted to persist target data with no resume token"),0===t.resumeToken.length||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)},t.prototype.notifyLocalViewChanges=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.targetDataByTarget.get(o);b(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.snapshotVersion,u=a.withLastLimboFreeSnapshotVersion(s);this.targetDataByTarget=this.targetDataByTarget.insert(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",function(n){return Kt.forEach(t,function(t){return Kt.forEach(t.removedKeys,function(t){return e.persistence.referenceDelegate.removeReference(n,t)})})})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly-idempotent",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateTarget=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",function(n){var r;return e.targetCache.getTargetData(n,t).next(function(i){return i?(r=i,Kt.resolve(r)):e.targetCache.allocateTargetId(n).next(function(i){return r=new Nn(t,i,Tn.Listen,n.currentSequenceNumber),e.targetCache.addTargetData(n,r).next(function(){return r})})})}).then(function(n){return null===e.targetDataByTarget.get(n.targetId)&&(e.targetDataByTarget=e.targetDataByTarget.insert(n.targetId,n),e.targetIdByTarget.set(t,n.targetId)),n})},t.prototype.getTargetData=function(t,e){var n=this.targetIdByTarget.get(e);return void 0!==n?Kt.resolve(this.targetDataByTarget.get(n)):this.targetCache.getTargetData(t,e)},t.prototype.releaseTarget=function(t,e){var n=this,r=this.targetDataByTarget.get(t);b(null!==r,"Tried to release nonexistent target: "+t);var i=e?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",i,function(i){var o=n.localViewReferences.removeReferencesForId(t);return e?Kt.resolve():Kt.forEach(o,function(t){return n.persistence.referenceDelegate.removeReference(i,t)}).next(function(){n.persistence.referenceDelegate.removeTarget(i,r)})}).then(function(){n.targetDataByTarget=n.targetDataByTarget.remove(t),n.targetIdByTarget.delete(r.target)})},t.prototype.executeQuery=function(t,e){var n=this,r=_t.MIN,i=Bt();return this.persistence.runTransaction("Execute query","readonly-idempotent",function(o){return n.getTargetData(o,t.toTarget()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(o,t.targetId).next(function(t){i=t})}).next(function(){return n.queryEngine.getDocumentsMatchingQuery(o,t,e?r:_t.MIN,e?i:Bt())}).next(function(t){return{documents:t,remoteKeys:i}})})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",function(n){return e.targetCache.getMatchingKeysForTargetId(n,t)})},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=Kt.resolve();return o.forEach(function(r){a=a.next(function(){return n.getEntry(t,r)}).next(function(t){var o=t,a=e.docVersions.get(r);b(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o,e.commitVersion):b(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))})}),a.next(function(){return r.mutationQueue.removeMutationBatch(t,i)})},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",function(n){return t.collect(n,e.targetDataByTarget)})},t.prototype.getTarget=function(t){var e=this,n=this.targetDataByTarget.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly-idempotent",function(n){return e.targetCache.getTargetDataForTarget(n,t).next(function(t){return t?t.target:null})})},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",function(e){return t.remoteDocuments.getNewDocumentChanges(e,t.lastDocumentChangeReadTime)}).then(function(e){var n=e.changedDocs,r=e.readTime;return t.lastDocumentChangeReadTime=r,n})},t.prototype.synchronizeLastDocumentChangeReadTime=function(){return a.__awaiter(this,void 0,void 0,function(){var t,e=this;return a.__generator(this,function(n){switch(n.label){case 0:return t=this,[4,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",function(t){return e.remoteDocuments.getLastReadTime(t)})];case 1:return t.lastDocumentChangeReadTime=n.sent(),[2]}})})},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}();function Un(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){if(t.code!==E.FAILED_PRECONDITION||t.message!==Rn)throw t;return m(Mn,"Unexpectedly lost primary lease"),[2]})})}function Fn(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=X(n,i);return 0===a?X(r,o):a}var Vn=function(){function t(t){this.maxElements=t,this.buffer=new kt(Fn),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Fn(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),Bn={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qn=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),jn=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.hasRun=!1,this.gcTask=null}return t.prototype.start=function(){b(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==qn.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;b(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;m("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(et.LruGarbageCollection,e,function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then(function(){return t.scheduleGC()}).catch(Un)})},t}(),Gn=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Kt.resolve(st.INVALID);var r=new Vn(e);return this.delegate.forEachTarget(t,function(t){return r.addElement(t.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,function(t){return r.addElement(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===qn.COLLECTION_DISABLED?(m("LruGarbageCollector","Garbage collection skipped; disabled"),Kt.resolve(Bn)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(m("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Bn):n.runGarbageCollection(t,e)})},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,o,a,s,u,c,h=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>h.params.maximumSequenceNumbersToCollect?(m("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.maximumSequenceNumbersToCollect+" from "+e),r=h.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),h.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),h.removeTargets(t,n,e)}).next(function(e){return o=e,u=Date.now(),h.removeOrphanedDocuments(t,n)}).next(function(t){(c=Date.now(),p()<=i.DEBUG)&&m("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+o+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-l)+"ms");return Kt.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:t})})},t}(),Wn="IndexedDbPersistence",Kn="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Hn=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return a.__extends(e,t),e}(On),zn=function(){function t(e,n,r,i,o,a,s,u){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.queue=a,this.sequenceNumberSyncer=u,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},this.referenceDelegate=new Xn(this,o),this.dbName=n+t.MAIN_DATABASE,this.serializer=new Dn(s),this.document=i.document,this.targetCache=new he(this.referenceDelegate,this.serializer),this.indexManager=new An,this.remoteDocumentCache=new Xe(this.serializer,this.indexManager),!i.window||!i.window.localStorage)throw new S(E.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof Hn)return zt.getStore(t.simpleDbTransaction,e);throw v("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(r){switch(r.label){case 0:if(!t.isAvailable())throw new S(E.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(n=new t(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.lruParams,e.queue,e.serializer,e.sequenceNumberSyncer)).start()];case 1:return r.sent(),[2,n]}})})},t.prototype.start=function(){var t=this;return b(!this.started,"IndexedDbPersistence double-started!"),b(null!==this.window,"Expected 'window' to be defined"),zt.openOrCreate(this.dbName,rn,new on(this.serializer)).then(function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()}).then(function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.simpleDb.runTransaction("readonly-idempotent",[gn.store],function(t){return pe(t)})}).then(function(e){t.listenSequence=new st(e,t.sequenceNumberSyncer)}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener(function(n){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget(function(){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite-idempotent",_n,function(e){return Yn(e).put(new wn(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next(function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget(function(){return t.primaryStateListener(!1)}))})}).next(function(){return t.canActAsPrimary(e)}).next(function(n){return t.isPrimary&&!n?t.releasePrimaryLeaseIfHeld(e).next(function(){return!1}):!!n&&t.acquireOrExtendPrimaryLease(e).next(function(){return!0})})}).catch(function(e){if(!t.allowTabSynchronization)throw e;return m(Wn,"Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.queue.enqueueAndForget(function(){return t.primaryStateListener(e)}),t.isPrimary=e})},t.prototype.verifyPrimaryLease=function(t){var e=this;return Qn(t).get(sn.key).next(function(t){return Kt.resolve(e.isLocalClient(t))})},t.prototype.removeClientMetadata=function(t){return Yn(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return a.__awaiter(this,void 0,void 0,function(){var e=this;return a.__generator(this,function(n){switch(n.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",function(n){var r=t.getStore(n,wn.store);return r.loadAll().next(function(t){var n=e.filterActiveClients(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Kt.forEach(i,function(t){return r.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:n.sent().forEach(function(t){e.window.localStorage.removeItem(e.zombiedClientLocalStorageKey(t.clientId))}),n.label=2;case 2:return[2]}})})},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(et.ClientMetadataRefresh,4e3,function(){return t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.maybeGarbageCollectMultiClientState()}).then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return Qn(t).get(sn.key).next(function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new S(E.FAILED_PRECONDITION,Kn);return!1}}return!(!e.networkEnabled||!e.inForeground)||Yn(t).loadAll().next(function(t){return void 0===e.filterActiveClients(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&m(Wn,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,function(){var t=this;return a.__generator(this,function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[sn.store,wn.store],function(e){return t.releasePrimaryLeaseIfHeld(e).next(function(){return t.removeClientMetadata(e)})})];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter(function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)})},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly-idempotent",[wn.store],function(e){return Yn(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(e){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(r){switch(r.label){case 0:return t.isAvailable()?(n=e+t.MAIN_DATABASE,[4,zt.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}})})},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return b(this.started,"Cannot initialize MutationQueue before persistence is started."),te.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getTargetCache=function(){return b(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},t.prototype.getRemoteDocumentCache=function(){return b(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return b(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;m(Wn,"Starting transaction:",t);var i,o=e.endsWith("idempotent"),a=e.startsWith("readonly")?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite";return this.simpleDb.runTransaction(a,_n,function(o){return i=new Hn(o,r.listenSequence.next()),"readwrite-primary"===e||"readwrite-primary-idempotent"===e?r.verifyPrimaryLease(o).next(function(t){return!!t||r.canActAsPrimary(o)}).next(function(e){if(!e)throw y("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new S(E.FAILED_PRECONDITION,Rn);return n(i)}).next(function(t){return r.acquireOrExtendPrimaryLease(o).next(function(){return t})}):r.verifyAllowTabSynchronization(o).next(function(){return n(i)})}).then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return Qn(t).get(sn.key).next(function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new S(E.FAILED_PRECONDITION,Kn)})},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new sn(this.clientId,this.allowTabSynchronization,Date.now());return Qn(t).put(sn.key,e)},t.isAvailable=function(){return zt.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=Qn(t);return n.get(sn.key).next(function(t){return e.isLocalClient(t)?(m(Wn,"Releasing primary lease."),n.delete(sn.key)):Kt.resolve()})},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e)&&(!(t>n)||(y("Detected an update time that is in the future: "+t+" > "+n),!1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(b(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(b("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return m(Wn,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(n){return y(Wn,"Failed to get zombied client id.",n),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){y("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function Qn(t){return t.store(sn.store)}function Yn(t){return t.store(wn.store)}var Xn=function(){function t(t,e){this.db=t,this.inMemoryPins=null,this.garbageCollector=new Gn(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,function(t,n){return e(n)})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return Jn(t,e)},t.prototype.removeReference=function(t,e){return Jn(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return Jn(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?Kt.resolve(!0):function(t,e){var n=!1;return ae(t).iterateSerial(function(r){return ee(t,r,e).next(function(t){return t&&(n=!0),Kt.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(t,function(a,s){if(s<=e){var u=n.isPinned(t,a).next(function(e){if(!e)return o++,r.getEntry(t,a).next(function(){return r.removeEntry(a),de(t).delete([0,wt(a.path)])})});i.push(u)}}).next(function(){return Kt.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Jn(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=de(t),i=st.INVALID;return r.iterate({index:yn.documentTargetsIndex},function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==st.INVALID&&e(new ft(St(n)),i),i=s,n=a):i=st.INVALID}).next(function(){i!==st.INVALID&&e(new ft(St(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Jn(t,e){return de(t).put(function(t,e){return new yn(0,wt(t.path),e)}(e,t.currentSequenceNumber))}var $n=Number,Zn=$n.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),tr=$n.MAX_SAFE_INTEGER||Math.pow(2,53)-1,er=$n.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function nr(t){return null==t}function rr(t){return er(t)&&t<=tr&&t>=Zn}var ir,or=function(){function t(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}return t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=","}t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=","}nr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t=this.path.canonicalString();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),nr(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&(!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)))},t.prototype.isDocumentQuery=function(){return ft.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}();!function(t){t.First="F",t.Last="L"}(ir||(ir={}));var ar=function(){function t(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=ir.First),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memoizedTarget=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[vr]:this.memoizedOrderBy=[new gr(t),vr];else{b(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:mr.ASCENDING;this.memoizedOrderBy.push(a===mr.ASCENDING?vr:br)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){b(null==this.getInequalityFilterField()||!(e instanceof cr)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),b(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){b(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.withLimitToFirst=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,ir.First,this.startAt,this.endAt)},t.prototype.withLimitToLast=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,ir.Last,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},t.prototype.canonicalId=function(){return this.toTarget().canonicalId()+"|lt:"+this.limitType},t.prototype.toString=function(){return"Query(target="+this.toTarget().toString()+"; limitType="+this.limitType+")"},t.prototype.isEqual=function(t){return this.toTarget().isEqual(t.toTarget())&&this.limitType===t.limitType},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return b(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimitToFirst=function(){return!nr(this.limit)&&this.limitType===ir.First},t.prototype.hasLimitToLast=function(){return!nr(this.limit)&&this.limitType===ir.Last},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof cr&&n.isInequality())return n.field}return null},t.prototype.findFilterOperator=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof cr&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.isDocumentQuery=function(){return this.toTarget().isDocumentQuery()},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.toTarget=function(){if(!this.memoizedTarget)if(this.limitType===ir.First)this.memoizedTarget=new or(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===mr.DESCENDING?mr.ASCENDING:mr.DESCENDING;t.push(new gr(r.field,i))}var o=this.endAt?new yr(this.endAt.position,!this.endAt.before):null,a=this.startAt?new yr(this.startAt.position,!this.startAt.before):null;this.memoizedTarget=new or(this.path,this.collectionGroup,t,this.filters,this.limit,o,a)}return this.memoizedTarget},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):ft.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){b(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),sr=function(){return function(){}}(),ur=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return v("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),cr=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return a.__extends(e,t),e.create=function(t,n,r){if(t.isKeyField())return n===ur.IN?(b(r instanceof Ge,"Comparing on key with IN, but filter value not an ArrayValue"),b(r.internalValue.every(function(t){return t instanceof Be}),"Comparing on key with IN, but an array value was not a RefValue"),new lr(t,r)):(b(r instanceof Be,"Comparing on key, but filter value not a RefValue"),b(n!==ur.ARRAY_CONTAINS&&n!==ur.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new hr(t,n,r));if(r.isEqual(ke.INSTANCE)){if(n!==ur.EQUAL)throw new S(E.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(r.isEqual(Me.NAN)){if(n!==ur.EQUAL)throw new S(E.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return n===ur.ARRAY_CONTAINS?new fr(t,r):n===ur.IN?(b(r instanceof Ge,"IN filter has invalid value: "+r.toString()),new pr(t,r)):n===ur.ARRAY_CONTAINS_ANY?(b(r instanceof Ge,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new dr(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case ur.LESS_THAN:return t<0;case ur.LESS_THAN_OR_EQUAL:return t<=0;case ur.EQUAL:return 0===t;case ur.GREATER_THAN:return t>0;case ur.GREATER_THAN_OR_EQUAL:return t>=0;default:return v("Unknown FieldFilter operator: "+this.op)}},e.prototype.isInequality=function(){return[ur.LESS_THAN,ur.LESS_THAN_OR_EQUAL,ur.GREATER_THAN,ur.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&(this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value))},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(sr),hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=ft.comparator(t.key,e.key);return this.matchesComparison(n)},e}(cr),lr=function(t){function e(e,n){var r=t.call(this,e,ur.IN,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){return this.value.internalValue.some(function(e){return t.key.isEqual(e.key)})},e}(cr),fr=function(t){function e(e,n){return t.call(this,e,ur.ARRAY_CONTAINS,n)||this}return a.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof Ge&&e.contains(this.value)},e}(cr),pr=function(t){function e(e,n){var r=t.call(this,e,ur.IN,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},e}(cr),dr=function(t){function e(e,n){var r=t.call(this,e,ur.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof Ge&&n.internalValue.some(function(t){return e.value.contains(t)})},e}(cr),mr=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),yr=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){b(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())b(o instanceof Be,"Bound has a non-key value where the key path is being used."),n=ft.comparator(o.key,e.key);else{var a=e.field(i.field);b(null!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===mr.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},t}(),gr=function(){function t(t,e){this.field=t,void 0===e&&(e=mr.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?Ke.compareByKey(t,e):Ke.compareByField(this.field,t,e);switch(this.dir){case mr.ASCENDING:return n;case mr.DESCENDING:return-1*n;default:return v("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),vr=new gr(lt.keyField(),mr.ASCENDING),br=new gr(lt.keyField(),mr.DESCENDING),wr=function(){function t(){}return t.prototype.setLocalDocumentsView=function(t){this.localDocumentsView=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var o=this;return b(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),e.matchesAllDocuments()?this.executeFullCollectionScan(t,e):n.isEqual(_t.MIN)?this.executeFullCollectionScan(t,e):this.localDocumentsView.getDocuments(t,r).next(function(a){var s=o.applyQuery(e,a);return(e.hasLimitToFirst()||e.hasLimitToLast())&&o.needsRefill(e.limitType,s,r,n)?o.executeFullCollectionScan(t,e):(p()<=i.DEBUG&&m("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),o.localDocumentsView.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.applyQuery=function(t,e){var n=new kt(function(e,n){return t.docComparator(e,n)});return e.forEach(function(e,r){r instanceof Ke&&t.matches(r)&&(n=n.add(r))}),n},t.prototype.needsRefill=function(t,e,n,r){if(n.size!==e.size)return!0;var i=t===ir.First?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.executeFullCollectionScan=function(t,e){return p()<=i.DEBUG&&m("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.localDocumentsView.getDocumentsMatchingQuery(t,e,_t.MIN)},t}(),Tr=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=T(),this.batchesByDocumentKey=new kt(Ln.compareByKey)}return t.prototype.checkEmpty=function(t){return Kt.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");b(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return b(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,Kt.resolve()},t.prototype.getLastStreamToken=function(t){return Kt.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,Kt.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){b(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;(this.nextBatchId++,this.mutationQueue.length>0)&&b(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new Gt(i,e,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Ln(u.key,i)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast())}return Kt.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Kt.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return b(null!=n,"Failed to find local mutation batch."),Kt.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return Kt.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Kt.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},t.prototype.getAllMutationBatches=function(t){return Kt.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Ln(e,0),i=new Ln(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){b(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);b(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),Kt.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new kt(X);return e.forEach(function(t){var e=new Ln(t,0),i=new Ln(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],function(e){b(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)})}),Kt.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){b(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;ft.isDocumentKey(i)||(i=i.child(""));var o=new Ln(new ft(i),0),a=new kt(X);return this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)},o),Kt.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;b(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return Kt.forEach(e.mutations,function(i){var o=new Ln(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)}).next(function(){n.batchesByDocumentKey=r})},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new Ln(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Kt.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&b(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Kt.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return b(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return b(n.batchId===t,"If found batch must match"),n},t}();var Er,Sr=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=new At(ft.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){b(!n.isEqual(_t.MIN),"Cannot add a document with a read time of zero");var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.sizer(e);return this.docs=this.docs.insert(r,{maybeDocument:e,size:a,readTime:n}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Kt.resolve(n?n.maybeDocument:null)},t.prototype.getEntries=function(t,e){var n=this,r=Lt();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)}),Kt.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){b(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=xt(),i=new ft(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.maybeDocument,h=u.readTime;if(!e.path.isPrefixOf(s.path))break;h.compareTo(n)<=0||c instanceof Ke&&e.matches(c)&&(r=r.insert(c.key,c))}return Kt.resolve(r)},t.prototype.forEachDocumentKey=function(t,e){return Kt.forEach(this.docs,function(t){return e(t)})},t.prototype.getNewDocumentChanges=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},t.prototype.getLastReadTime=function(t){return Kt.resolve(_t.MIN)},t.prototype.newChangeBuffer=function(e){return new t.RemoteDocumentChangeBuffer(this)},t.prototype.getSize=function(t){return Kt.resolve(this.size)},t.RemoteDocumentChangeBuffer=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return a.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i?n.push(e.documentCache.addEntry(t,i,e.readTime)):e.documentCache.removeEntry(r)}),Kt.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.documentCache.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getEntries(t,e)},e}(Ye),t}(),Ir=function(){function t(t){this.persistence=t,this.targets=new Qe(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=_t.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Pn,this.targetCount=0,this.targetIdGenerator=ce.forTargetCache()}return t.prototype.forEachTarget=function(t,e){return this.targets.forEach(function(t,n){return e(n)}),Kt.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Kt.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Kt.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,Kt.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),Kt.resolve()},t.prototype.saveTargetData=function(t){this.targets.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return b(!this.targets.has(e.target),"Adding a target that already exists"),this.saveTargetData(e),this.targetCount+=1,Kt.resolve()},t.prototype.updateTargetData=function(t,e){return b(this.targets.has(e.target),"Updating a non-existent target"),this.saveTargetData(e),Kt.resolve()},t.prototype.removeTargetData=function(t,e){return b(this.targetCount>0,"Removing a target from an empty cache"),b(this.targets.has(e.target),"Removing a non-existent target from the cache"),this.targets.delete(e.target),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,Kt.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.targets.forEach(function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.targets.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)}),Kt.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return Kt.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.targets.get(e)||null;return Kt.resolve(n)},t.prototype.getTargetDataForTarget=function(t,e){return v("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.addReference(t,e))}),Kt.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.removeReference(t,e))}),Kt.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),Kt.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return Kt.resolve(n)},t.prototype.containsKey=function(t,e){return Kt.resolve(this.references.containsKey(e))},t}(),_r=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new st(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new Ir(this);this.indexManager=new en,this.remoteDocumentCache=new Sr(this.indexManager,function(t){return n.referenceDelegate.documentSize(t)})}return t.createLruPersistence=function(e,n){return new t(e,function(t){return new Nr(t,n)})},t.createEagerPersistence=function(e){return new t(e,function(t){return new Cr(t)})},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return[2,[this.clientId]]})})},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Tr(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.targetCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;m("MemoryPersistence","Starting transaction:",t);var i=new Ar(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(t){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.mutationQueuesContainKey=function(t,e){return Kt.or((n=this.mutationQueues,r=[],N(n,function(t,e){return r.push(e)}),r).map(function(n){return function(){return n.containsKey(t,e)}}));var n,r},t}(),Ar=function(t){function e(e){var n=t.call(this)||this;return n.currentSequenceNumber=e,n}return a.__extends(e,t),e}(On),Cr=function(){function t(t){this.persistence=t,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(t.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw v("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),Kt.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),Kt.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),Kt.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.orphanedDocuments.add(t)})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Kt.forEach(this.orphanedDocuments,function(r){return e.isReferenced(t,r).next(function(t){t||n.removeEntry(r)})}).next(function(){return e._orphanedDocuments=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next(function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)})},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return Kt.or([function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return Kt.resolve(n.inMemoryPins.containsKey(e))}])},t}(),Nr=function(){function t(t,e){this.persistence=t,this.inMemoryPins=null,this.orphanedSequenceNumbers=new Qe(function(t){return wt(t.path)}),this.garbageCollector=new Gn(this,e)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return Kt.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return Kt.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(t,r,i).next(function(t){return t?Kt.resolve():e(i)})})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(t,function(i){return n.isPinned(t,i,e).next(function(t){t||(r++,o.removeEntry(i))})}).next(function(){return o.apply(t)}).next(function(){return r})},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Kt.resolve()},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Kt.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Kt.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Kt.resolve()},t.prototype.documentSize=function(t){var e=t.key.toString().length;return t instanceof Ke&&(e+=t.data().approximateByteSize()),e},t.prototype.isPinned=function(t,e,n){var r=this;return Kt.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return Kt.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getTargetCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return Kt.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),Dr=1e3,kr=1.5,Rr=6e4,Or=function(){function t(t,e,n,r,i){void 0===n&&(n=Dr),void 0===r&&(r=kr),void 0===i&&(i=Rr),this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&m("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return e.lastAttemptTime=Date.now(),t()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}();!function(t){t[t.Initial=0]="Initial",t[t.Starting=1]="Starting",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff"}(Er||(Er={}));var Pr,Lr,Mr=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=Er.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Or(t,e)}return t.prototype.isStarted=function(){return this.state===Er.Starting||this.state===Er.Open||this.state===Er.Backoff},t.prototype.isOpen=function(){return this.state===Er.Open},t.prototype.start=function(){this.state!==Er.Error?(b(this.state===Er.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(Er.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.inhibitBackoff=function(){b(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Er.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return this.isOpen()?[2,this.close(Er.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(n){switch(n.label){case 0:return b(this.isStarted(),"Only started streams should be closed."),b(t===Er.Error||nr(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==Er.Error?this.backoff.reset():e&&e.code===E.RESOURCE_EXHAUSTED?(y(e.toString()),y("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===E.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;b(this.state===Er.Initial,"Must be in initial state to auth"),this.state=Er.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(e){t.closeCount===n&&t.startStream(e)},function(n){e(function(){var e=new S(E.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)})})},t.prototype.startStream=function(t){var e=this;b(this.state===Er.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return b(e.state===Er.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=Er.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.performBackoff=function(){var t=this;b(this.state===Er.Error,"Should only perform backoff when in Error state"),this.state=Er.Backoff,this.backoff.backoffAndRun(function(){return a.__awaiter(t,void 0,void 0,function(){return a.__generator(this,function(t){return b(this.state===Er.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=Er.Initial,this.start(),b(this.isStarted(),"PersistentStream should have started"),[2]})})})},t.prototype.handleStreamClose=function(t){return b(this.isStarted(),"Can't handle server close on non-started stream"),m("PersistentStream","close with error: "+t),this.stream=null,this.close(Er.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget(function(){return e.closeCount===t?n():(m("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),xr=function(t){function e(e,n,r,i,o){var a=t.call(this,e,et.ListenStreamConnectionBackoff,et.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return a.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(Mr),Ur=function(t){function e(e,n,r,i,o){var a=t.call(this,e,et.WriteStreamConnectionBackoff,et.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a.lastStreamToken=T(),a}return a.__extends(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(b(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return b(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){b(this.isOpen(),"Writing handshake requires an opened stream"),b(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;b(this.isOpen(),"Writing mutations requires an opened stream"),b(this.handshakeComplete_,"Handshake must be complete before writing mutations"),b(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(Mr),Fr=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new Ur(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new xr(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=Pt();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);b(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(t,e,r)}).catch(function(t){throw t.code===E.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(t,e,r)}).catch(function(t){throw t.code===E.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t}(),Vr=function(){function t(t){this.datastore=t,this.readVersions=Ft(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n=this;return a.__generator(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new S(E.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(t)];case 1:return(e=r.sent()).forEach(function(t){t instanceof He||t instanceof Ke?n.recordVersion(t):v("Document in a transaction was a "+t.constructor.name)}),[2,e]}})})},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t))),this.writtenDocs.add(t)},t.prototype.update=function(t,e){try{this.write(e.toMutations(t,this.preconditionForUpdate(t)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(t)},t.prototype.delete=function(t){this.write([new Ae(t,this.precondition(t))]),this.writtenDocs.add(t)},t.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,function(){var t,e=this;return a.__generator(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t=t.remove(e.key)}),t.forEach(function(t,n){e.mutations.push(new Ce(t,e.precondition(t)))}),[4,this.datastore.commit(this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t instanceof Ke)e=t.version;else{if(!(t instanceof He))throw v("Document in a transaction was a "+t.constructor.name);e=_t.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new S(E.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return!this.writtenDocs.has(t)&&e?Te.updateTime(e):Te.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(!this.writtenDocs.has(t)&&e){if(e.isEqual(_t.forDeletedDoc()))throw new S(E.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Te.updateTime(e)}return Te.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(t)},t.prototype.ensureCommitNotCalled=function(){b(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},t}();!function(t){t[t.Unknown=0]="Unknown",t[t.Online=1]="Online",t[t.Offline=2]="Offline"}(Pr||(Pr={})),function(t){t[t.RemoteStore=0]="RemoteStore",t[t.SharedClientState=1]="SharedClientState"}(Lr||(Lr={}));var Br,qr=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=Pr.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Pr.Unknown),b(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(et.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,b(t.state===Pr.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(Pr.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===Pr.Online?(this.setAndBroadcast(Pr.Unknown),b(0===this.watchStreamFailures,"watchStreamFailures must be 0"),b(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(Pr.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===Pr.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(y(e),this.shouldWarnClientIsOffline=!1):m("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}();function jr(t){switch(t){case E.OK:return v("Treated status OK as error");case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0;default:return v("Unknown status code: "+t)}}function Gr(t){if(void 0===t)return y("GRPC error has no .code"),E.UNKNOWN;switch(t){case Br.OK:return E.OK;case Br.CANCELLED:return E.CANCELLED;case Br.UNKNOWN:return E.UNKNOWN;case Br.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case Br.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case Br.INTERNAL:return E.INTERNAL;case Br.UNAVAILABLE:return E.UNAVAILABLE;case Br.UNAUTHENTICATED:return E.UNAUTHENTICATED;case Br.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case Br.NOT_FOUND:return E.NOT_FOUND;case Br.ALREADY_EXISTS:return E.ALREADY_EXISTS;case Br.PERMISSION_DENIED:return E.PERMISSION_DENIED;case Br.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case Br.ABORTED:return E.ABORTED;case Br.OUT_OF_RANGE:return E.OUT_OF_RANGE;case Br.UNIMPLEMENTED:return E.UNIMPLEMENTED;case Br.DATA_LOSS:return E.DATA_LOSS;default:return v("Unknown status code: "+t)}}function Wr(t){if(void 0===t)return Br.OK;switch(t){case E.OK:return Br.OK;case E.CANCELLED:return Br.CANCELLED;case E.UNKNOWN:return Br.UNKNOWN;case E.DEADLINE_EXCEEDED:return Br.DEADLINE_EXCEEDED;case E.RESOURCE_EXHAUSTED:return Br.RESOURCE_EXHAUSTED;case E.INTERNAL:return Br.INTERNAL;case E.UNAVAILABLE:return Br.UNAVAILABLE;case E.UNAUTHENTICATED:return Br.UNAUTHENTICATED;case E.INVALID_ARGUMENT:return Br.INVALID_ARGUMENT;case E.NOT_FOUND:return Br.NOT_FOUND;case E.ALREADY_EXISTS:return Br.ALREADY_EXISTS;case E.PERMISSION_DENIED:return Br.PERMISSION_DENIED;case E.FAILED_PRECONDITION:return Br.FAILED_PRECONDITION;case E.ABORTED:return Br.ABORTED;case E.OUT_OF_RANGE:return Br.OUT_OF_RANGE;case E.UNIMPLEMENTED:return Br.UNIMPLEMENTED;case E.DATA_LOSS:return Br.DATA_LOSS;default:return v("Unknown status code: "+t)}}!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(Br||(Br={}));var Kr,Hr,zr=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ft.comparator(e.key,n.key)}:function(t,e){return ft.comparator(t.key,e.key)},this.keyedMap=xt(),this.sortedSet=new At(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(Kr||(Kr={})),function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(Hr||(Hr={}));var Qr,Yr=function(){function t(){this.changeMap=new At(ft.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Kr.Added&&n.type===Kr.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Kr.Metadata&&n.type!==Kr.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Kr.Modified&&n.type===Kr.Modified?this.changeMap=this.changeMap.insert(e,{type:Kr.Modified,doc:t.doc}):t.type===Kr.Modified&&n.type===Kr.Added?this.changeMap=this.changeMap.insert(e,{type:Kr.Added,doc:t.doc}):t.type===Kr.Removed&&n.type===Kr.Added?this.changeMap=this.changeMap.remove(e):t.type===Kr.Removed&&n.type===Kr.Modified?this.changeMap=this.changeMap.insert(e,{type:Kr.Removed,doc:n.doc}):t.type===Kr.Added&&n.type===Kr.Removed?this.changeMap=this.changeMap.insert(e,{type:Kr.Modified,doc:t.doc}):v("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Xr=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:Kr.Added,doc:t})}),new t(e,n,zr.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Jr=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=$r.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(_t.MIN,i,jt(),Pt(),Bt())},t}(),$r=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(T(),n,Bt(),Bt(),Bt())},t}(),Zr=function(){return function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}}(),ti=function(){return function(t,e){this.targetId=t,this.existenceFilter=e}}();!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(Qr||(Qr={}));var ei=function(){return function(t,e,n,r){void 0===n&&(n=T()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}(),ni=function(){function t(){this.pendingResponses=0,this.documentChanges=oi(),this._resumeToken=T(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=Bt(),e=Bt(),n=Bt();return this.documentChanges.forEach(function(r,i){switch(i){case Kr.Added:t=t.add(r);break;case Kr.Modified:e=e.add(r);break;case Kr.Removed:n=n.add(r);break;default:v("Encountered invalid change type: "+i)}}),new $r(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=oi()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),ri=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Pt(),this.pendingDocumentTargetMapping=ii(),this.pendingTargetResets=new kt(X)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof Ke?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof He&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){r=o[i];this.removeDocumentFromTarget(r,t.key,t.newDoc)}},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.ensureTargetState(n);switch(t.state){case Qr.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case Qr.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case Qr.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),b(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Qr.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case Qr.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:v("Unknown target watch change state: "+t.state)}})},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):C(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.targetDataForActiveTarget(e);if(r){var i=r.target;if(i.isDocumentQuery())if(0===n){var o=new ft(i.path);this.removeDocumentFromTarget(e,o,new He(o,_t.forDeletedDoc()))}else b(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};C(this.targetStates,function(r,i){var o=e.targetDataForActiveTarget(r);if(o){if(i.current&&o.target.isDocumentQuery()){var a=new ft(o.target.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new He(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=Bt();this.pendingDocumentTargetMapping.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.targetDataForActiveTarget(t);return!n||n.purpose===Tn.LimboResolution||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Jr(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Pt(),this.pendingDocumentTargetMapping=ii(),this.pendingTargetResets=new kt(X),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Kr.Modified:Kr.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Kr.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new ni),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new kt(X),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){var e=null!==this.targetDataForActiveTarget(t);return e||m("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.targetDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getTargetDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;b(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new ni,this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(n){e.removeDocumentFromTarget(t,n,null)})},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function ii(){return new At(ft.comparator)}function oi(){return new At(ft.comparator)}var ai="RemoteStore",si=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(t){n.enqueueAndForget(function(){return a.__awaiter(o,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(m(ai,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new qr(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Pr.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Pr.Offline),[2]}})})},t.prototype.disableNetworkInternal=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(m(ai,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},t.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return m(ai,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(Pr.Unknown),[2]}})})},t.prototype.listen=function(t){_(this.listenTargets,t.targetId)||(this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t))},t.prototype.unlisten=function(t){b(_(this.listenTargets,t),"unlisten called on target no currently watched: "+t),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),D(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Pr.Unknown))},t.prototype.getTargetDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){b(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new ri(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!D(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return a.__awaiter(this,void 0,void 0,function(){var t=this;return a.__generator(this,function(e){return C(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return void 0===t&&b(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(Pr.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Pr.Online),t instanceof ei&&t.state===Qr.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof Zr?this.watchChangeAggregator.handleDocumentChange(t):t instanceof ti?this.watchChangeAggregator.handleExistenceFilter(t):(b(t instanceof ei,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(_t.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.raiseWatchSnapshot=function(t){var e=this;b(!t.isEqual(_t.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return C(n.targetChanges,function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.withResumeToken(r.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.withResumeToken(T(),n.snapshotVersion),e.sendUnwatchRequest(t);var r=new Nn(n.target,t,Tn.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;b(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(e){return _(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.fillWritePipeline=function(){return a.__awaiter(this,void 0,void 0,function(){var t,e;return a.__generator(this,function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){b(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){b(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}}).catch(Un)},t.prototype.onMutationResult=function(t,e){var n=this;b(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Wt.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return a.__awaiter(this,void 0,void 0,function(){var e=this;return a.__generator(this,function(n){return void 0===t&&b(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&this.writePipeline.length>0?(void 0,[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})]):[2]})})},t.prototype.handleHandshakeError=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return jr(t.code)?(m(ai,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=T(),[2,this.localStore.setLastStreamToken(T()).catch(Un)]):[2]})})},t.prototype.handleWriteError=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n=this;return a.__generator(this,function(r){return jr(i=t.code)&&i!==E.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2];var i})})},t.prototype.createTransaction=function(){return new Vr(this.datastore)},t.prototype.restartNetwork=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Pr.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.handleCredentialChange=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(m(ai,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.applyPrimaryState=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(Pr.Unknown),e.label=4;case 4:return[2]}})})},t}(),ui=function(){function t(t,e){if(R("GeoPoint",arguments,2),L("GeoPoint","number",1,t),L("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new S(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new S(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return X(this._lat,t._lat)||X(this._long,t._long)},t}(),ci=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new Fe(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),hi=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=pi(t),n=function(t){e.find(function(e){return e.isEqual(t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new Ge(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&J(e.elements,this.elements)},t}(),li=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=pi(t),n=function(t){e=e.filter(function(e){return!e.isEqual(t)})},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new Ge(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&J(e.elements,this.elements)},t}(),fi=function(){function t(t){this.operand=t}return t.prototype.applyToLocalView=function(t,e){var n=this.computeBaseValue(t);if(n instanceof Le&&this.operand instanceof Le){var r=n.internalValue+this.operand.internalValue;return new Le(r)}r=n.internalValue+this.operand.internalValue;return new Me(r)},t.prototype.applyToRemoteDocument=function(t,e){return b(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.computeBaseValue=function(t){return t instanceof Oe?t:new Le(0)},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function pi(t){return t instanceof Ge?t.internalValue.slice():[]}var di,mi,yi=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}(),gi=((di={})[mr.ASCENDING.name]="ASCENDING",di[mr.DESCENDING.name]="DESCENDING",di),vi=((mi={})[ur.LESS_THAN.name]="LESS_THAN",mi[ur.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",mi[ur.GREATER_THAN.name]="GREATER_THAN",mi[ur.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",mi[ur.EQUAL.name]="EQUAL",mi[ur.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",mi[ur.IN.name]="IN",mi[ur.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",mi),bi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wi(t,e){b(!nr(t),e+" is missing")}function Ti(t){return"number"==typeof t?t:"string"==typeof t?Number(t):v("can't parse "+t)}var Ei=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?E.UNKNOWN:Gr(t.code);return new S(e,t.message||"")},t.prototype.toInt32Value=function(t){return this.options.useProto3Json||nr(t)?t:{value:t}},t.prototype.fromInt32Value=function(t){var e;return nr(e="object"==typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return this.options.useProto3Json?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);b(!!t,"Cannot deserialize null or undefined timestamp.");var e=Ti(t.seconds||"0"),n=t.nanos||0;return new It(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=bi.exec(t);if(b(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new It(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(b(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),nt.fromBase64String(t)):(b(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),nt.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return b(!!t,"Trying to deserialize version that isn't set"),_t.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=ct.fromString(t);return b(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return b(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),b(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new ft(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?ct.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new ct(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new ct(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return b(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof ke)return{nullValue:"NULL_VALUE"};if(t instanceof Re)return{booleanValue:t.value()};if(t instanceof Le)return{integerValue:""+t.value()};if(t instanceof Me){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof xe?{stringValue:t.value()}:t instanceof je?{mapValue:this.toMapValue(t)}:t instanceof Ge?{arrayValue:this.toArrayValue(t)}:t instanceof Ue?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof qe?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Ve?{bytesValue:this.toBytes(t.value())}:t instanceof Be?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:v("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return ke.INSTANCE;if("booleanValue"in t)return Re.of(t.booleanValue);if("integerValue"in t)return new Le(Ti(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Me.NAN;if("Infinity"===t.doubleValue)return Me.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Me.NEGATIVE_INFINITY}return new Me(t.doubleValue)}if("stringValue"in t)return new xe(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t){wi(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new Ge(n.map(function(t){return e.fromValue(t)}))}if("timestampValue"in t)return wi(t.timestampValue,"timestampValue"),new Ue(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t){wi(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new qe(new ui(r,i))}if("bytesValue"in t){wi(t.bytesValue,"bytesValue");var o=this.fromBlob(t.bytesValue);return new Ve(o)}if("referenceValue"in t){wi(t.referenceValue,"referenceValue");var a=this.fromResourceName(t.referenceValue),s=new at(a.get(1),a.get(3)),u=new ft(this.extractLocalPathFromResourceName(a));return new Be(s,u)}return v("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return b(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data()),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){var n=this,r=this.fromName(t.name),i=this.fromVersion(t.updateTime);return new Ke(r,i,{hasCommittedMutations:!!e},void 0,t,function(t){return n.fromValue(t)})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=je.EMPTY;return N(n,function(t,n){r=r.set(new lt([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){var e=this;b(!!t.found,"Tried to deserialize a found document from a missing document."),wi(t.found.name,"doc.found.name"),wi(t.found.updateTime,"doc.found.updateTime");var n=this.fromName(t.found.name),r=this.fromVersion(t.found.updateTime);return new Ke(n,r,{},void 0,t.found,function(t){return e.fromValue(t)})},t.prototype.fromMissing=function(t){b(!!t.missing,"Tried to deserialize a missing document from a found document."),b(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new He(e,n)},t.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):v("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Qr.Added:return"ADD";case Qr.Current:return"CURRENT";case Qr.NoChange:return"NO_CHANGE";case Qr.Removed:return"REMOVE";case Qr.Reset:return"RESET";default:return v("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof ti)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof Zr){if(t.newDoc instanceof Ke){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof He){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof ei){var n=void 0;return t.cause&&(n={code:Wr(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return v("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=this;if("targetChange"in t){wi(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new ei(r,i,o,s||null)}else if("documentChange"in t){wi(t.documentChange,"documentChange");var u=t.documentChange;wi(u.document,"documentChange.name"),wi(u.document.name,"documentChange.document.name"),wi(u.document.updateTime,"documentChange.document.updateTime");var c=this.fromName(u.document.name),h=this.fromVersion(u.document.updateTime),l=new Ke(c,h,{},void 0,u.document,function(t){return n.fromValue(t)}),f=u.targetIds||[],p=u.removedTargetIds||[];e=new Zr(f,p,l.key,l)}else if("documentDelete"in t){wi(t.documentDelete,"documentDelete");var d=t.documentDelete;wi(d.document,"documentDelete.document");c=this.fromName(d.document),h=d.readTime?this.fromVersion(d.readTime):_t.forDeletedDoc(),l=new He(c,h),p=d.removedTargetIds||[];e=new Zr([],p,l.key,l)}else if("documentRemove"in t){wi(t.documentRemove,"documentRemove");var m=t.documentRemove;wi(m.document,"documentRemove");c=this.fromName(m.document),p=m.removedTargetIds||[];e=new Zr([],p,c,null)}else{if(!("filter"in t))return v("Unknown change type "+JSON.stringify(t));wi(t.filter,"filter");var y=t.filter;wi(y.targetId,"filter.targetId");var g=y.count||0,b=new yi(g),w=y.targetId;e=new ti(w,b)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Qr.NoChange:"ADD"===t?Qr.Added:"REMOVE"===t?Qr.Removed:"CURRENT"===t?Qr.Current:"RESET"===t?Qr.Reset:v("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return _t.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?_t.MIN:e.readTime?this.fromVersion(e.readTime):_t.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof Se)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof Ae)e={delete:this.toName(t.key)};else if(t instanceof Ie)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else if(t instanceof _e)e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}};else{if(!(t instanceof Ce))return v("Unknown mutation type "+t.type);e={verify:this.toName(t.key)}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):Te.NONE;if(t.update){wi(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new Ie(r,i,o,n)}return new Se(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new Ae(r,n)}if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return b(!0===n.exists,'Transforms only support precondition "exists == true"'),new _e(r,a)}if(t.verify){r=this.fromName(t.verify);return new Ce(r,n)}return v("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return b(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:v("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?Te.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Te.exists(t.exists):Te.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);r.isEqual(_t.MIN)&&(r=this.fromVersion(e));var i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map(function(t){return n.fromValue(t)})),new ve(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(b(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.fromWriteResult(t,e)})):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof ci)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof hi)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof li)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof fi)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw v("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)b("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=ci.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new hi(r.map(function(t){return e.fromValue(t)}))}else if("removeAllFromArray"in t){r=t.removeAllFromArray.values||[];n=new li(r.map(function(t){return e.fromValue(t)}))}else if("increment"in t){var i=this.fromValue(t.increment);b(i instanceof Oe,"NUMERIC_ADD transform requires a NumberValue"),n=new fi(i)}else v("Unknown transform proto: "+JSON.stringify(t));var o=lt.fromServerFormat(t.fieldPath);return new ge(o,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;b(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return ar.atPath(this.fromQueryPath(n)).toTarget()},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(b(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(b(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){b(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new ar(e,i,s,a,u,ir.First,c,h).toTarget()},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case Tn.Listen:return null;case Tn.ExistenceFilterMismatch:return"existence-filter-mismatch";case Tn.LimboResolution:return"limbo-document";default:return v("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.target;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof cr?e.toUnaryOrFieldFilter(t):v("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):v("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new yr(r,n)},t.prototype.toDirection=function(t){return gi[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return mr.ASCENDING;case"DESCENDING":return mr.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return vi[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return ur.EQUAL;case"GREATER_THAN":return ur.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return ur.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return ur.LESS_THAN;case"LESS_THAN_OR_EQUAL":return ur.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return ur.ARRAY_CONTAINS;case"IN":return ur.IN;case"ARRAY_CONTAINS_ANY":return ur.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return v("Unspecified operator");default:return v("Unknown operator")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return lt.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new gr(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.fromFieldFilter=function(t){return cr.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryOrFieldFilter=function(t){if(t.op===ur.EQUAL){if(t.value.isEqual(Me.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}};if(t.value.isEqual(ke.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return cr.create(e,ur.EQUAL,Me.NAN);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return cr.create(n,ur.EQUAL,ke.INSTANCE);case"OPERATOR_UNSPECIFIED":return v("Unspecified filter");default:return v("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return lt.fromServerFormat(t)});return ye.fromArray(e)},t}(),Si=function(){return function(){this.viewSnap=null,this.targetId=0,this.listeners=[]}}(),Ii=function(){function t(t){this.syncEngine=t,this.queries=new Qe(function(t){return t.canonicalId()}),this.onlineState=Pr.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);(r||(n=!0,r=new Si,this.queries.set(e,r)),r.listeners.push(t),b(!t.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.viewSnap)&&(t.onViewSnapshot(r.viewSnap)&&this.raiseSnapshotsInSyncEvent());return n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r,i;return a.__generator(this,function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onWatchChange=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,a=this.queries.get(o);if(a){for(var s=0,u=a.listeners;s<u.length;s++){u[s].onViewSnapshot(i)&&(e=!0)}a.viewSnap=i}}e&&this.raiseSnapshotsInSyncEvent()},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){i[r].onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t;var e=!1;this.queries.forEach(function(n,r){for(var i=0,o=r.listeners;i<o.length;i++){o[i].applyOnlineStateChange(t)&&(e=!0)}}),e&&this.raiseSnapshotsInSyncEvent()},t.prototype.addSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.add(t),t.next()},t.prototype.removeSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.delete(t)},t.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach(function(t){t.next()})},t}(),_i=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=Pr.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(b(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Kr.Metadata&&e.push(i)}t=new Xr(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(t)&&(this.queryObserver.next(t),o=!0):this.shouldRaiseInitialEvent(t,this.onlineState)&&(this.raiseInitialEvent(t),o=!0),this.snap=t,o},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t;var e=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&(this.raiseInitialEvent(this.snap),e=!0),e},t.prototype.shouldRaiseInitialEvent=function(t,e){if(b(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==Pr.Offline;return this.options.waitForSyncWhenOnline&&n?(b(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===Pr.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){b(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=Xr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),Ai=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.addedKeys=n,this.removedKeys=r}return t.fromSnapshot=function(e,n){for(var r=Bt(),i=Bt(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Kr.Added:r=r.add(s.doc.key);break;case Kr.Removed:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ci=function(){return function(t){this.key=t}}(),Ni=function(){return function(t){this.key=t}}(),Di=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=Bt(),this.mutatedKeys=Bt(),this.documentSet=new zr(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Yr,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimitToFirst()&&i.size===this.query.limit?i.last():null,c=this.query.hasLimitToLast()&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=e instanceof Ke?e:null;l&&(b(t.isEqual(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null);var f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:Kr.Metadata,doc:l}),d=!0):n.shouldWaitForSyncedDocument(h,l)||(r.track({type:Kr.Modified,doc:l}),d=!0,(u&&n.query.docComparator(l,u)>0||c&&n.query.docComparator(l,c)<0)&&(s=!0)):!h&&l?(r.track({type:Kr.Added,doc:l}),d=!0):h&&!l&&(r.track({type:Kr.Removed,doc:h}),d=!0,(u||c)&&(s=!0));d&&(l?(a=a.add(l),o=p?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))}),this.query.hasLimitToFirst()||this.query.hasLimitToLast())for(;a.size>this.query.limit;){var h=this.query.hasLimitToFirst()?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),r.track({type:Kr.Removed,doc:h})}return b(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;b(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case Kr.Added:return 1;case Kr.Modified:case Kr.Metadata:return 2;case Kr.Removed:return 0;default:return v("Unknown ChangeType: "+t)}};return n(t)-n(e)}(t.type,e.type)||r.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?Hr.Synced:Hr.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new Xr(this.query,t.documentSet,i,o,t.mutatedKeys,s===Hr.Local,u,!1),limboChanges:a}:{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===Pr.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Yr,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.add(t)}),t.modifiedDocuments.forEach(function(t){return b(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")}),t.removedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)}),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=Bt(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new Ni(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new Ci(t))}),n},t.prototype.synchronizeWithPersistedState=function(t){this._syncedDocuments=t.remoteKeys,this.limboDocuments=Bt();var e=this.computeDocChanges(t.documents);return this.applyChanges(e,!0)},t.prototype.computeInitialSnapshot=function(){return Xr.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Hr.Local)},t}();var ki=5,Ri=function(){function t(t,e,n,r){this.asyncQueue=t,this.remoteStore=e,this.updateFunction=n,this.deferred=r,this.retries=ki,this.backoff=new Or(this.asyncQueue,et.RetryTransaction)}return t.prototype.run=function(){this.runWithBackOff()},t.prototype.runWithBackOff=function(){var t=this;this.backoff.backoffAndRun(function(){return a.__awaiter(t,void 0,void 0,function(){var t,e,n=this;return a.__generator(this,function(r){return t=this.remoteStore.createTransaction(),(e=this.tryRunUpdateFunction(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.handleTransactionError(t)})})}).catch(function(t){n.handleTransactionError(t)}),[2]})})})},t.prototype.tryRunUpdateFunction=function(t){try{var e=this.updateFunction(t);return!nr(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(y){return this.deferred.reject(y),null}},t.prototype.handleTransactionError=function(t){var e=this;this.retries>0&&this.isRetryableTransactionError(t)?(this.retries-=1,this.asyncQueue.enqueueAndForget(function(){return e.runWithBackOff(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.isRetryableTransactionError=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!jr(e)}return!1},t}(),Oi=function(){return function(t,e,n){this.query=t,this.targetId=e,this.view=n}}(),Pi=function(){return function(t){this.key=t,this.receivedDocument=!1}}(),Li=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Qe(function(t){return t.canonicalId()}),this.queriesByTarget={},this.limboTargetsByKey=new At(ft.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Pn,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=ce.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Pr.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){b(null!==t,"SyncEngine listener cannot be null"),b(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o;return a.__generator(this,function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateTarget(t.toTarget())];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(t,e,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}})})},t.prototype.initializeViewAndComputeSnapshot=function(t,e,n){return a.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u,c;return a.__generator(this,function(a){switch(a.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return r=a.sent(),i=new Di(t,r.remoteKeys),o=i.computeDocChanges(r.documents),s=$r.createSynthesizedTargetChangeForCurrentChange(e,n&&this.onlineState!==Pr.Offline),b(0===(u=i.applyChanges(o,!0===this.isPrimary,s)).limboChanges.length,"View returned limbo docs before target ack from the server."),b(!!u.snapshot,"applyChanges for new view should always return a snapshot"),c=new Oi(t,e,i),this.queryViewsByQuery.set(t,c),this.queriesByTarget[e]||(this.queriesByTarget[e]=[]),this.queriesByTarget[e].push(t),[2,u.snapshot]}})})},t.prototype.synchronizeViewAndComputeSnapshot=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n;return a.__generator(this,function(r){switch(r.label){case 0:return[4,this.localStore.executeQuery(t.query,!0)];case 1:return e=r.sent(),n=t.view.synchronizeWithPersistedState(e),this.isPrimary&&this.updateTrackedLimbos(t.targetId,n.limboChanges),[2,n]}})})},t.prototype.unlisten=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r=this;return a.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),b(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),(n=this.queriesByTarget[e.targetId]).length>1?(this.queriesByTarget[e.targetId]=n.filter(function(e){return!e.isEqual(t)}),this.queryViewsByQuery.delete(t),[2]):this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseTarget(e.targetId,!1).then(function(){r.sharedClientState.clearQueryState(e.targetId),r.remoteStore.unlisten(e.targetId),r.removeAndCleanupTarget(e.targetId)}).catch(Un)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupTarget(e.targetId),[4,this.localStore.releaseTarget(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(t)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,e),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}})})},t.prototype.runTransaction=function(t,e,n){new Ri(t,this.remoteStore,e,n).run()},t.prototype.applyRemoteEvent=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n=this;return a.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(t)];case 2:return e=r.sent(),N(t.targetChanges,function(t,e){var r=n.limboResolutionsByTarget[Number(t)];r&&(b(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),e.addedDocuments.size>0?r.receivedDocument=!0:e.modifiedDocuments.size>0?b(r.receivedDocument,"Received change for limbo target document without add."):e.removedDocuments.size>0&&(b(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),[4,this.emitNewSnapsAndNotifyLocalStore(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,Un(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===Lr.RemoteStore||!this.isPrimary&&e===Lr.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach(function(e,r){var i=r.view.applyOnlineStateChange(t);b(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u=this;return a.__generator(this,function(a){switch(a.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new At(ft.comparator)).insert(r,new He(r,_t.forDeletedDoc())),o=Bt().add(r),s=new Jr(_t.MIN,{},new kt(X),i,o),[2,this.applyRemoteEvent(s)]):[3,1];case 1:return[4,this.localStore.releaseTarget(t,!1).then(function(){return u.removeAndCleanupTarget(t,e)}).catch(Un)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.applyBatchState=function(t,e,n){return a.__awaiter(this,void 0,void 0,function(){var r;return a.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(m("SyncEngine","Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):v("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},t.prototype.applySuccessfulWrite=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n;return a.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),e=t.batch.batchId,this.processUserCallback(e,null),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Un(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.rejectFailedWrite=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"rejected",e),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Un(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.registerPendingWritesCallback=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n;return a.__generator(this,function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||m("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(e=r.sent())?(t.resolve(),[2]):((n=this.pendingWritesCallbacks.get(e)||[]).push(t),this.pendingWritesCallbacks.set(e,n),[2])}})})},t.prototype.triggerPendingWritesCallbacks=function(t){(this.pendingWritesCallbacks.get(t)||[]).forEach(function(t){t.resolve()}),this.pendingWritesCallbacks.delete(t)},t.prototype.rejectOutstandingPendingWritesCallbacks=function(t){this.pendingWritesCallbacks.forEach(function(e){e.forEach(function(e){e.reject(new S(E.CANCELLED,t))})}),this.pendingWritesCallbacks.clear()},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new At(X)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(b(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupTarget=function(t,e){var n=this;void 0===e&&(e=null),this.sharedClientState.removeLocalQueryTarget(t),b(this.queriesByTarget[t]&&0!==this.queriesByTarget[t].length,"There are no queries mapped to target id "+t);for(var r=0,i=this.queriesByTarget[t];r<i.length;r++){var o=i[r];this.queryViewsByQuery.delete(o),e&&this.syncEngineListener.onWatchError(o,e)}if(delete this.queriesByTarget[t],this.isPrimary){var a=this.limboDocumentRefs.referencesForId(t);this.limboDocumentRefs.removeReferencesForId(t),a.forEach(function(t){n.limboDocumentRefs.containsKey(t)||n.removeLimboTarget(t)})}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i instanceof Ci)this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i);else if(i instanceof Ni){m("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)}else v("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){m("SyncEngine","New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=ar.atPath(e.path);this.limboResolutionsByTarget[n]=new Pi(e),this.remoteStore.listen(new Nn(r.toTarget(),n,Tn.LimboResolution,st.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n,r,i,o=this;return a.__generator(this,function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(a,s){i.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query,!1).then(function(t){var n=t.documents;return s.view.computeDocChanges(n,e)}):e}).then(function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=Ai.fromSnapshot(s.targetId,a.snapshot);r.push(u)}}))}),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}})})},t.prototype.assertSubscribed=function(t){b(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n;return a.__generator(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(t)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},t.prototype.applyPrimaryState=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,s,u,c=this;return a.__generator(this,function(a){switch(a.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return a.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=a.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),C(this.queriesByTarget,function(t,e){c.sharedClientState.isLocalQueryTarget(t)?s.push(t):u=u.then(function(){return c.removeAndCleanupTarget(t),c.localStore.releaseTarget(t,!0)}),c.remoteStore.unlisten(t)}),[4,u]);case 4:return a.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(s)];case 5:return a.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:a.sent(),a.label=7;case 7:return[2]}})})},t.prototype.resetLimboDocuments=function(){var t=this;C(this.limboResolutionsByTarget,function(e){t.remoteStore.unlisten(e)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new At(ft.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,s,u,c,h,l,f,p,d;return a.__generator(this,function(a){switch(a.label){case 0:e=[],n=[],r=0,i=t,a.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.queriesByTarget[o])&&0!==u.length?[4,this.localStore.releaseTarget(o,!0)]:[3,8]):[3,14];case 2:return a.sent(),[4,this.localStore.allocateTarget(u[0].toTarget())];case 3:s=a.sent(),c=0,h=u,a.label=4;case 4:return c<h.length?(l=h[c],b(!!(f=this.queryViewsByQuery.get(l)),"No query view found for "+l),[4,this.synchronizeViewAndComputeSnapshot(f)]):[3,7];case 5:(p=a.sent()).snapshot&&n.push(p.snapshot),a.label=6;case 6:return c++,[3,4];case 7:return[3,12];case 8:return b(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.localStore.getTarget(o)];case 9:return b(!!(d=a.sent()),"Target for id "+o+" not found"),[4,this.localStore.allocateTarget(d)];case 10:return s=a.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(d),o,!1)];case 11:a.sent(),a.label=12;case 12:e.push(s),a.label=13;case 13:return r++,[3,1];case 14:return this.syncEngineListener.onWatchChange(n),[2,e]}})})},t.prototype.synthesizeTargetToQuery=function(t){return new ar(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,ir.First,t.startAt,t.endAt)},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return a.__awaiter(this,void 0,void 0,function(){var r,i;return a.__generator(this,function(o){switch(o.label){case 0:if(this.isPrimary)return m("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queriesByTarget[t])return[3,7];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return r=o.sent(),i=Jr.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.localStore.releaseTarget(t,!0)];case 5:return o.sent(),this.removeAndCleanupTarget(t,n),[3,7];case 6:v("Unexpected target state: "+e),o.label=7;case 7:return[2]}})})},t.prototype.applyActiveTargetsChange=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u,c,h,l,f=this;return a.__generator(this,function(p){switch(p.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,p.label=1;case 1:return n<r.length?(l=r[n],b(!this.queriesByTarget[l],"Trying to add an already active target"),[4,this.localStore.getTarget(l)]):[3,6];case 2:return b(!!(i=p.sent()),"Query data for active target "+l+" not found"),[4,this.localStore.allocateTarget(i)];case 3:return o=p.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(i),o.targetId,!1)];case 4:p.sent(),this.remoteStore.listen(o),p.label=5;case 5:return n++,[3,1];case 6:s=function(t){return a.__generator(this,function(e){switch(e.label){case 0:return u.queriesByTarget[t]?[4,u.localStore.releaseTarget(t,!1).then(function(){f.remoteStore.unlisten(t),f.removeAndCleanupTarget(t)}).catch(Un)]:[2,"continue"];case 1:return e.sent(),[2]}})},u=this,c=0,h=e,p.label=7;case 7:return c<h.length?(l=h[c],[5,s(l)]):[3,10];case 8:p.sent(),p.label=9;case 9:return c++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];if(e&&e.receivedDocument)return Bt().add(e.key);var n=Bt(),r=this.queriesByTarget[t];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var a=o[i],s=this.queryViewsByQuery.get(a);b(!!s,"No query view found for "+a),n=n.unionWith(s.view.syncedDocuments)}return n},t}(),Mi=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),xi="firestore_clients";function Ui(t,e){return b(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),xi+"_"+t+"_"+e}var Fi="firestore_mutations";function Vi(t,e,n){var r=Fi+"_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}var Bi="firestore_targets";function qi(t,e){return Bi+"_"+t+"_"+e}var ji="firestore_online_state";var Gi="firestore_sequence_number";var Wi="SharedClientState",Ki=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,b(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new S(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(y(Wi,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Hi=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,b(void 0!==n==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new S(r.error.code,r.error.message)),i?new t(e,r.state,o):(y(Wi,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),zi=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=jt(),a=0;i&&a<r.activeTargetIds.length;++a)i=rr(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(y(Wi,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Qi=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return"object"==typeof n&&n.onlineState in Pr&&"string"==typeof n.clientId?new t(n.clientId,Pr[n.onlineState]):(y(Wi,"Failed to parse online state: "+e),null)},t}(),Yi=function(){function t(){this.activeTargetIds=jt()}return t.prototype.addQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Xi=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new S(E.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=Ui(this.persistenceKey,this.localClientId),this.sequenceNumberKey=function(t){return Gi+"_"+t}(this.persistenceKey),this.activeClients[this.localClientId]=new Yi,this.clientStateKeyRe=new RegExp("^"+xi+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Fi+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+Bi+"_"+a+"_(\\d+)$"),this.onlineStateKey=function(t){return ji+"_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return a.__awaiter(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,c,h,l,f=this;return a.__generator(this,function(a){switch(a.label){case 0:return b(!this.started,"WebStorageSharedClientState already started"),b(null!==this.syncEngine,"syncEngine property must be set before calling start()"),b(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(Ui(this.persistenceKey,r)))&&(o=zi.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(s=this.storage.getItem(this.onlineStateKey))&&(u=this.fromWebStorageOnlineState(s))&&this.handleOnlineStateEvent(u),c=0,h=this.earlyEvents;c<h.length;c++)l=h[c],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return f.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=jt();return N(this.activeClients,function(e,n){t=t.unionWith(n.activeTargetIds)}),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(qi(this.persistenceKey,t));if(n){var r=Hi.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(qi(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.removeMutationState(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return m(Wi,"READ",t,e),e},t.prototype.setItem=function(t,e){m(Wi,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){m(Wi,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(m(Wi,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void y("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return a.__awaiter(e,void 0,void 0,function(){var e,n,r,i,o,s;return a.__generator(this,function(a){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(b(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(s=function(t){var e=st.INVALID;if(null!=t)try{var n=JSON.parse(t);b("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(r){y(Wi,"Failed to read sequence number from WebStorage",r)}return e}(t.newValue))!==st.INVALID&&this.sequenceNumberHandler(s));return[2]})})})}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Ki(this.currentUser,t,e,n),i=Vi(this.persistenceKey,this.currentUser,t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=Vi(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:Pr[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=qi(this.persistenceKey,t),i=new Hi(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return b(null!==n,"Cannot parse client state key '"+t+"'"),zi.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);b(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ki.fromWebStorageEntry(new Mi(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);b(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return Hi.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return Qi.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return t.user.uid!==this.currentUser.uid?(m(Wi,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],s=[];return i.forEach(function(t){return a.__awaiter(n,void 0,void 0,function(){return a.__generator(this,function(e){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return a.__awaiter(n,void 0,void 0,function(){return a.__generator(this,function(e){return i.has(t)||s.push(t),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,s)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}();var Ji=function(){function t(){this.localState=new Yi,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new Yi,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),$i=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return qn.withCacheSize(this.cacheSizeBytes)},t}(),Zi=function(){return function(){}}(),to=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=Y.newId()}return t.prototype.start=function(t){var e=this;this.verifyNotTerminated();var n=new pt,r=new pt,i=!1;return this.credentials.setChangeListener(function(o){i?e.asyncQueue.enqueueAndForget(function(){return e.handleCredentialChange(o)}):(i=!0,e.initializePersistence(t,r,o).then(function(t){return e.initializeRest(o,t)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return t.syncEngine.enableNetwork()})},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof $i?this.startIndexedDbPersistence(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof S?t.code===E.FAILED_PRECONDITION||t.code===E.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new S(E.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=zn.buildStoragePrefix(this.databaseInfo),i=new Ei(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return a.__awaiter(n,void 0,void 0,function(){var n,o;return a.__generator(this,function(a){switch(a.label){case 0:if(e.synchronizeTabs&&!Xi.isAvailable(this.platform))throw new S(E.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=e.lruParams(),this.sharedClientState=e.synchronizeTabs?new Xi(this.asyncQueue,this.platform,r,this.clientId,t):new Ji,[4,zn.createIndexedDbPersistence({allowTabSynchronization:e.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return o=a.sent(),this.persistence=o,[2,o.referenceDelegate.garbageCollector]}})})})},t.prototype.startMemoryPersistence=function(){return this.persistence=_r.createEagerPersistence(this.clientId),this.sharedClientState=new Ji,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return m("FirestoreClient","Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return a.__awaiter(n,void 0,void 0,function(){var n,i,o,s,u,c,h=this;return a.__generator(this,function(l){switch(l.label){case 0:return n=new wr,this.localStore=new xn(this.persistence,n,t),[4,this.localStore.start()];case 1:return l.sent(),e&&(this.lruScheduler=new jn(e,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),o=this.platform.newSerializer(this.databaseInfo.databaseId),s=new Fr(this.asyncQueue,r,this.credentials,o),u=function(t){return h.syncEngine.applyOnlineStateChange(t,Lr.RemoteStore)},c=function(t){return h.syncEngine.applyOnlineStateChange(t,Lr.SharedClientState)},this.remoteStore=new si(this.localStore,s,this.asyncQueue,u,i),this.syncEngine=new Li(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=c,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new Ii(this.syncEngine),[4,this.sharedClientState.start()];case 2:return l.sent(),[4,this.remoteStore.start()];case 3:return l.sent(),[4,this.persistence.setPrimaryStateListener(function(t){return a.__awaiter(h,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}})})})];case 4:return l.sent(),[4,this.persistence.setDatabaseDeletedListener(function(){return a.__awaiter(h,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})})];case 5:return l.sent(),[2]}})})})},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),m("FirestoreClient","Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return t.syncEngine.disableNetwork()})},t.prototype.terminate=function(){var t=this;return this.asyncQueue.enqueueAndInitiateShutdown(function(){return a.__awaiter(t,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.removeChangeListener(),[2]}})})})},t.prototype.waitForPendingWrites=function(){var t=this;this.verifyNotTerminated();var e=new pt;return this.asyncQueue.enqueueAndForget(function(){return t.syncEngine.registerPendingWritesCallback(e)}),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotTerminated();var i=new _i(t,e,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.clientTerminated||this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof Ke)return t;if(t instanceof He)return null;throw new S(E.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return a.__awaiter(e,void 0,void 0,function(){var e,n,r;return a.__generator(this,function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return e=i.sent(),n=new Di(t,e.remoteKeys),r=n.computeDocChanges(e.documents),[2,n.applyChanges(r,!1).snapshot]}})})})},t.prototype.write=function(t){var e=this;this.verifyNotTerminated();var n=new pt;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.addSnapshotsInSyncListener=function(t){var e=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.addSnapshotsInSyncListener(t),Promise.resolve()})},t.prototype.removeSnapshotsInSyncListener=function(t){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(t)},Object.defineProperty(t.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.verifyNotTerminated();var n=new pt;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.runTransaction(e.asyncQueue,t,n),Promise.resolve()}),n.promise},t}(),eo=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),no=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new S(E.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+Q(r,"element")+".")}("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(L("FieldPath","string",n,t[n]),0===t[n].length)throw new S(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw K("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(lt.keyField().canonicalString()),t}(),ro=new RegExp("[~\\*/\\[\\]]");var io=function(){return function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t}}(),oo=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){b(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(Mi.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){b(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),ao=function(){function t(t){var e=this;this.tokenListener=null,this.currentUser=Mi.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.tokenListener):(this.tokenListener(null),t.get().then(function(t){e.auth=t,e.tokenListener&&e.auth.addAuthTokenListener(e.tokenListener)},function(){}))}return t.prototype.getToken=function(){var t=this;b(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){if(t.tokenCounter!==e)throw new S(E.ABORTED,"getToken aborted due to token change.");return n?(b("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new io(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){b(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){b(null!=this.tokenListener,"removeChangeListener() called twice"),b(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.auth&&this.auth.getUid();return b(null===t||"string"==typeof t,"Received invalid UID: "+t),new Mi(t)},t}(),so=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Mi.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),uo=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new so(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(Mi.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function co(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t,["next","error","complete"])}var ho,lo=function(){function t(t){this._methodName=t}return t.delete=function(){return k("FieldValue.delete",arguments),fo.instance},t.serverTimestamp=function(){return k("FieldValue.serverTimestamp",arguments),po.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return O("FieldValue.arrayUnion",arguments,1),new mo(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return O("FieldValue.arrayRemove",arguments,1),new yo(t)},t.increment=function(t){return L("FieldValue.increment","number",1,t),R("FieldValue.increment",arguments,1),new go(t)},t.prototype.isEqual=function(t){return this===t},t}(),fo=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return a.__extends(e,t),e.instance=new e,e}(lo),po=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return a.__extends(e,t),e.instance=new e,e}(lo),mo=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return a.__extends(e,t),e}(lo),yo=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return a.__extends(e,t),e}(lo),go=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n._operand=e,n}return a.__extends(e,t),e}(lo),vo=I(lo,"Use FieldValue.<field>() instead."),bo=/^__.*__$/,wo=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new Ie(t,this.data,this.fieldMask,e)):n.push(new Se(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new _e(t,this.fieldTransforms)),n},t}(),To=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new Ie(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new _e(t,this.fieldTransforms)),n},t}();function Eo(t){switch(t){case ho.Set:case ho.MergeSet:case ho.Update:return!0;case ho.Argument:case ho.ArrayArgument:return!1;default:throw v("Unexpected case for UserDataSource: "+t)}}!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.Argument=3]="Argument",t[t.ArrayArgument=4]="ArrayArgument"}(ho||(ho={}));var So=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new S(E.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(0===t.length)throw this.createError("Document fields must not be empty");if(Eo(this.dataSource)&&bo.test(t))throw this.createError('Document fields cannot begin and end with "__"')},t}(),Io=function(){return function(t,e){this.databaseId=t,this.key=e}}(),_o=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new So(ho.Set,t,lt.EMPTY_PATH);Co("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new wo(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new So(ho.MergeSet,t,lt.EMPTY_PATH);Co("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=new kt(lt.comparator),u=0,c=n;u<c.length;u++){var h=c[u],l=void 0;if(h instanceof no)l=h._internalPath;else{if("string"!=typeof h)throw v("Expected stringOrFieldPath to be a string or a FieldPath");l=Do(t,h)}if(!r.contains(l))throw new S(E.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");s=s.add(l)}i=ye.fromSet(s),o=r.fieldTransforms.filter(function(t){return i.covers(t.field)})}else i=ye.fromArray(r.fieldMask),o=r.fieldTransforms;return new wo(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new So(ho.Update,t,lt.EMPTY_PATH);Co("Data must be an object, but it was:",r,e);var i=new kt(lt.comparator),o=je.EMPTY;N(e,function(e,a){var s=Do(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof fo)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}});var a=ye.fromSet(i);return new To(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new So(ho.Update,t,lt.EMPTY_PATH),o=[No(t,e)],a=[n];if(r.length%2!=0)throw new S(E.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(No(t,r[s])),a.push(r[s+1]);var u=new kt(lt.comparator),c=je.EMPTY;for(s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof fo)u=u.add(h);else{var p=this.parseData(f,l);null!=p&&(u=u.add(h),c=c.set(h,p))}}var d=ye.fromSet(u);return new To(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e,n){void 0===n&&(n=!1);var r=new So(n?ho.ArrayArgument:ho.Argument,t,lt.EMPTY_PATH),i=this.parseData(e,r);return b(null!=i,"Parsed data should not be null."),b(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(r){var n=ko(r);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(Ao(t=this.runPreConverter(t,e)))return Co("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof lo)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement&&e.dataSource!==ho.ArrayArgument)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new At(X);return D(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):N(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new je(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=ke.INSTANCE),n.push(s),r++}return new Ge(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!Eo(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof fo){if(e.dataSource!==ho.MergeSet)throw e.dataSource===ho.Update?(b(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof po)e.fieldTransforms.push(new ge(e.path,ci.instance));else if(t instanceof mo){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new hi(n);e.fieldTransforms.push(new ge(e.path,r))}else if(t instanceof yo){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new li(n);e.fieldTransforms.push(new ge(e.path,i))}else if(t instanceof go){var o=this.parseQueryValue("FieldValue.increment",t._operand),a=new fi(o);e.fieldTransforms.push(new ge(e.path,a))}else v("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return ke.INSTANCE;if("number"==typeof t)return rr(t)?new Le(t):new Me(t);if("boolean"==typeof t)return Re.of(t);if("string"==typeof t)return new xe(t);if(t instanceof Date)return new Ue(It.fromDate(t));if(t instanceof It)return new Ue(new It(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof ui)return new qe(t);if(t instanceof nt)return new Ve(t);if(t instanceof Io)return new Be(t.databaseId,t.key);throw e.createError("Unsupported field value: "+j(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new So(ho.Argument,t,lt.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}();function Ao(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof It||t instanceof ui||t instanceof nt||t instanceof Io||t instanceof lo)}function Co(t,e,n){if(!Ao(n)||!q(n)){var r=j(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function No(t,e){if(e instanceof no)return e._internalPath;if("string"==typeof e)return Do(t,e);throw new S(E.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Do(t,e){try{return function(t){if(t.search(ro)>=0)throw new S(E.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(no.bind.apply(no,a.__spreadArrays([void 0],t.split("."))))}catch(e){throw new S(E.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(r){var n=ko(r);throw new S(E.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function ko(t){return t instanceof Error?t.message:t.toString()}var Ro="firestore.googleapis.com",Oo=!0,Po=!0,Lo=!1,Mo=qn.COLLECTION_DISABLED,xo=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new S(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ro,this.ssl=Oo}else x("settings","non-empty string","host",t.host),this.host=t.host,U("settings","boolean","ssl",t.ssl),this.ssl=A(t.ssl,Oo);if(W("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),U("settings","object","credentials",t.credentials),this.credentials=t.credentials,U("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?y("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&y("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=A(t.timestampsInSnapshots,Po),U("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=qn.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Mo&&t.cacheSizeBytes<qn.MINIMUM_CACHE_SIZE_BYTES)throw new S(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+qn.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}U("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0===t.experimentalForceLongPolling?Lo:t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Uo=function(){function t(e,n){var r=this;if(this._firebaseApp=null,this._queue=new mt,this.INTERNAL={delete:function(){return a.__awaiter(r,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof e.options){var i=e;this._firebaseApp=i,this._databaseId=t.databaseIdFromApp(i),this._persistenceKey=i.name,this._credentials=new ao(n)}else{var o=e;if(!o.projectId)throw new S(E.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new at(o.projectId,o.database),this._persistenceKey="[DEFAULT]",this._credentials=new oo}this._settings=new xo({}),this._dataConverter=this.createDataConverter(this._databaseId)}return t.prototype.settings=function(t){if(R("Firestore.settings",arguments,1),L("Firestore.settings","object",1,t),_(t,"persistence"))throw new S(E.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new xo(t);if(this._firestoreClient&&!this._settings.isEqual(e))throw new S(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=e,void 0!==e.credentials&&(this._credentials=function(t){if(!t)return new oo;switch(t.type){case"gapi":var e=t.client;return b(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new uo(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new S(E.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new S(E.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&y("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=A(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new $i(this._settings.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=zn.buildStoragePrefix(this.makeDatabaseInfo()),n=new pt;return this._queue.enqueueAndForgetEvenAfterShutdown(function(){return a.__awaiter(t,void 0,void 0,function(){var t;return a.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new S(E.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,zn.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}})})}),n.promise},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.ensureClientConfigured(),co(t))return this.onSnapshotsInSyncInternal(t);L("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.onSnapshotsInSyncInternal(e)},t.prototype.onSnapshotsInSyncInternal=function(t){var e=this,n=new eo({next:function(){t.next&&t.next()},error:function(t){throw v("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(n),function(){n.mute(),e._firestoreClient.removeSnapshotsInSyncListener(n)}},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Zi),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new it(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},t.prototype.configureClient=function(t){b(!!this._settings.host,"FirestoreSettings.host is not set"),b(!this._firestoreClient,"configureClient() called multiple times");var e=this.makeDatabaseInfo();return this._firestoreClient=new to(w.getPlatform(),e,this._credentials,this._queue),this._firestoreClient.start(t)},t.prototype.createDataConverter=function(t){return new _o(function(e){if(e instanceof Bo){var n=t,r=e.firestore._databaseId;if(!r.isEqual(n))throw new S(E.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Io(t,e._key)}return e})},t.databaseIdFromApp=function(t){var e=t.options;if(!_(e,"projectId"))throw new S(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new S(E.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new at(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._firebaseApp)throw new S(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return R("Firestore.collection",arguments,1),L("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new Ho(ct.fromString(t),this)},t.prototype.doc=function(t){return R("Firestore.doc",arguments,1),L("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),Bo.forPath(ct.fromString(t),this)},t.prototype.collectionGroup=function(t){if(R("Firestore.collectionGroup",arguments,1),L("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new S(E.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new Wo(new ar(ct.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return R("Firestore.runTransaction",arguments,1),L("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new Fo(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new Vo(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(p()){case i.DEBUG:return"debug";case i.ERROR:return"error";case i.SILENT:return"silent";default:return v("Unknown log level: "+p())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(R("Firestore.setLogLevel",arguments,1),L("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":d(i.DEBUG);break;case"error":d(i.ERROR);break;case"silent":d(i.SILENT);break;default:throw new S(E.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},t}(),Fo=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;R("Transaction.get",arguments,1);var n=Xo("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return v("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof He)return new jo(e._firestore,n._key,null,!1,!1,n._converter);if(r instanceof Ke)return new jo(e._firestore,n._key,r,!1,!1,n._converter);throw v("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},t.prototype.set=function(t,e,n){P("Transaction.set",arguments,2,3);var r=Xo("Transaction.set",t,this._firestore);n=zo("Transaction.set",n);var i=$o(r._converter,e,"Transaction.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._transaction.set(r._key,s),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof e||e instanceof no?(O("Transaction.update",arguments,3),r=Xo("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(R("Transaction.update",arguments,2),r=Xo("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){R("Transaction.delete",arguments,1);var e=Xo("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Vo=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){P("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Xo("WriteBatch.set",t,this._firestore);n=zo("WriteBatch.set",n);var i=$o(r._converter,e,"WriteBatch.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._mutations=this._mutations.concat(s.toMutations(r._key,Te.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"==typeof e||e instanceof no?(O("WriteBatch.update",arguments,3),r=Xo("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(R("WriteBatch.update",arguments,2),r=Xo("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,Te.exists(!0))),this},t.prototype.delete=function(t){R("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=Xo("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new Ae(e._key,Te.NONE)),this},t.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new S(E.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Bo=function(){function t(t,e,n){this._key=t,this.firestore=e,this._converter=n,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n,r){if(e.length%2!=0)throw new S(E.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new ft(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ho(this._key.path.popLast(),this.firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(R("DocumentReference.collection",arguments,1),L("DocumentReference.collection","non-empty string",1,t),!t)throw new S(E.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ct.fromString(t);return new Ho(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw K("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)&&this._converter===e._converter},t.prototype.set=function(t,e){P("DocumentReference.set",arguments,1,2),e=zo("DocumentReference.set",e);var n=$o(this._converter,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore._dataConverter.parseMergeData(i,r,e.mergeFields):this.firestore._dataConverter.parseSetData(i,r);return this._firestoreClient.write(o.toMutations(this._key,Te.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof no?(O("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(R("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,Te.exists(!0)))},t.prototype.delete=function(){return R("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Ae(this._key,Te.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];P("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||co(t[i])||(W("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),U("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return co(t[i])?n=t[i]:(L("DocumentReference.onSnapshot","function",i,t[i]),M("DocumentReference.onSnapshot","function",i+1,t[i+1]),M("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new eo({next:function(t){if(e.next){b(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new jo(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites,n._converter))}},error:r}),o=this._firestoreClient.listen(ar.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return P("DocumentReference.get",arguments,0,1),Yo("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new jo(e.firestore,e._key,t,!0,t instanceof Ke&&t.hasLocalMutations,e._converter))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new S(E.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new S(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this._key,this.firestore,e)},t}(),qo=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),jo=function(){function t(t,e,n,r,i,o){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i,this._converter=o}return t.prototype.data=function(t){if(P("DocumentSnapshot.data",arguments,0,1),t=Qo("DocumentSnapshot.data",t),this._document){if(this._converter){var e=new Go(this._firestore,this._key,this._document,this._fromCache,this._hasPendingWrites);return this._converter.fromFirestore(e,t)}return this.toJSObject(this._document.data(),Ne.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},t.prototype.get=function(t,e){if(P("DocumentSnapshot.get",arguments,1,2),e=Qo("DocumentSnapshot.get",e),this._document){var n=this._document.data().field(No("DocumentSnapshot.get",t));if(null!==n)return this.toJSValue(n,Ne.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Bo(this._key,this._firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new qo(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw K("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))&&this._converter===e._converter},t.prototype.toJSObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.toJSValue(i,e)}),r},t.prototype.toJSValue=function(t,e){if(t instanceof je)return this.toJSObject(t,e);if(t instanceof Ge)return this.toJSArray(t,e);if(t instanceof Be){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||y("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Bo(n,this._firestore,this._converter)}return t.value(e)},t.prototype.toJSArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.toJSValue(t,e)})},t}(),Go=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return b(void 0!==n,"Document in a QueryDocumentSnapshot should exist"),n},e}(jo),Wo=function(){function t(t,e,n){this._query=t,this.firestore=e,this._converter=n}return t.prototype.where=function(e,n,r){R("Query.where",arguments,3),G("Query.where",3,r);var i;!function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new S(E.INVALID_ARGUMENT,"Invalid value "+j(r)+" provided to function "+t+"() for its "+z(n)+" argument. Acceptable values: "+e.join(", "))}("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,n);var o=No("Query.where",e),a=ur.fromString(n);if(o.isKeyField()){if(a===ur.ARRAY_CONTAINS||a===ur.ARRAY_CONTAINS_ANY)throw new S(E.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+a.toString()+"' queries on FieldPath.documentId().");if(a===ur.IN){this.validateDisjunctiveFilterElements(r,a);for(var s=[],u=0,c=r;u<c.length;u++){var h=c[u];s.push(this.parseDocumentIdValue(h))}i=new Ge(s)}else i=this.parseDocumentIdValue(r)}else a!==ur.IN&&a!==ur.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,a),i=this.firestore._dataConverter.parseQueryValue("Query.where",r,a===ur.IN);var l=cr.create(o,a,i);return this.validateNewFilter(l),new t(this._query.addFilter(l),this.firestore,this._converter)},t.prototype.orderBy=function(e,n){var r;if(P("Query.orderBy",arguments,1,2),M("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=mr.ASCENDING;else{if("desc"!==n)throw new S(E.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=mr.DESCENDING}if(null!==this._query.startAt)throw new S(E.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new S(E.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=No("Query.orderBy",e),o=new gr(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore,this._converter)},t.prototype.limit=function(e){return R("Query.limit",arguments,1),L("Query.limit","number",1,e),H("Query.limit",1,e),new t(this._query.withLimitToFirst(e),this.firestore,this._converter)},t.prototype.limitToLast=function(e){return R("Query.limitToLast",arguments,1),L("Query.limitToLast","number",1,e),H("Query.limitToLast",1,e),new t(this._query.withLimitToLast(e),this.firestore,this._converter)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];O("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore,this._converter)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];O("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore,this._converter)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];O("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore,this._converter)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];O("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore,this._converter)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw K("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.withConverter=function(e){return new t(this._query,this.firestore,e)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(G(t,1,e),e instanceof jo){if(n.length>0)throw new S(E.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new S(E.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Be(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(s instanceof Fe)throw new S(E.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new S(E.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new yr(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new S(E.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new S(E.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(ct.fromString(a));if(!ft.isDocumentKey(s))throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new ft(s);i.push(new Be(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,a);i.push(c)}}return new yr(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];P("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||co(t[i])||(W("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),U("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),co(t[i])?n=t[i]:(L("Query.onSnapshot","function",i,t[i]),M("Query.onSnapshot","function",i+1,t[i+1]),M("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.validateHasExplicitOrderByForLimitToLast(this._query),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new eo({next:function(t){e.next&&e.next(new Ko(n.firestore,n._query,t,n._converter))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.validateHasExplicitOrderByForLimitToLast=function(t){if(t.hasLimitToLast()&&0===t.explicitOrderBy.length)throw new S(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return P("Query.get",arguments,0,1),Yo("Query.get",t),this.validateHasExplicitOrderByForLimitToLast(this._query),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new Ko(e.firestore,e._query,t,e._converter))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new S(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.parseDocumentIdValue=function(t){if("string"==typeof t){if(""===t)throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==t.indexOf("/"))throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this._query.path.child(ct.fromString(t));if(!ft.isDocumentKey(e))throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new Be(this.firestore._databaseId,new ft(e))}if(t instanceof Bo){var n=t;return new Be(this.firestore._databaseId,n._key)}throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+j(t)+".")},t.prototype.validateDisjunctiveFilterElements=function(t,e){if(!Array.isArray(t)||0===t.length)throw new S(E.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new S(E.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new S(E.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter(function(t){return Number.isNaN(t)}).length>0)throw new S(E.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.validateNewFilter=function(t){if(t instanceof cr){var e=[ur.ARRAY_CONTAINS,ur.ARRAY_CONTAINS_ANY],n=[ur.IN,ur.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new S(E.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(t.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(e)),null!=s)throw s===t.op?new S(E.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new S(E.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new S(E.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Ko=function(){function t(t,e,n,r){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._converter=r,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new qo(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;P("QuerySnapshot.forEach",arguments,1,2),L("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Wo(this._originalQuery,this._firestore,this._converter)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(W("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),U("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new S(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n,r){if(n.oldDocs.isEmpty()){var i,o=0;return n.docChanges.map(function(e){var a=new Go(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key),r);return b(e.type===Kr.Added,"Invalid event type for first snapshot"),b(!i||n.query.docComparator(i,e.doc)<0,"Got added events in wrong order"),i=e.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}})}var a=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==Kr.Metadata}).map(function(e){var i=new Go(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key),r),o=-1,s=-1;return e.type!==Kr.Added&&(b((o=a.indexOf(e.doc.key))>=0,"Index for document not found"),a=a.delete(e.doc.key)),e.type!==Kr.Removed&&(a=a.add(e.doc),s=a.indexOf(e.doc.key)),{type:Jo(e.type),doc:i,oldIndex:o,newIndex:s}})}(this._firestore,e,this._snapshot,this._converter),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw K("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)&&this._converter===e._converter},t.prototype.convertToDocumentImpl=function(t){return new Go(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key),this._converter)},t}();a.__spreadArrays(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(Ko.prototype.docChanges,t,{get:function(){return function(){throw new S(E.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(e){}});var Ho=function(t){function e(e,n,r){var i=t.call(this,ar.atPath(e),n,r)||this;if(i._path=e,e.length%2!=1)throw new S(E.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return i}return a.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Bo(new ft(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(P("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Y.newId()),L("CollectionReference.doc","non-empty string",1,t),""===t)throw new S(E.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=ct.fromString(t);return Bo.forPath(this._query.path.child(e),this.firestore,this._converter)},e.prototype.add=function(t){R("CollectionReference.add",arguments,1),L("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e.prototype.withConverter=function(t){return new e(this._path,this.firestore,t)},e}(Wo);function zo(t,e){if(void 0===e)return{merge:!1};if(W(t,e,["merge","mergeFields"]),U(t,"boolean","merge",e.merge),F(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"==typeof t||t instanceof no}),void 0!==e.mergeFields&&void 0!==e.merge)throw new S(E.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Qo(t,e){return void 0===e?{}:(W(t,e,["serverTimestamps"]),V(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Yo(t,e){M(t,"object",1,e),e&&(W(t,e,["source"]),V(t,0,"source",e.source,["default","server","cache"]))}function Xo(t,e,n){if(e instanceof Bo){if(e.firestore!==n)throw new S(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw K(t,"DocumentReference",1,e)}function Jo(t){switch(t){case Kr.Added:return"added";case Kr.Modified:case Kr.Metadata:return"modified";case Kr.Removed:return"removed";default:return v("Unknown change type: "+t)}}function $o(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}var Zo=I(Uo,"Use firebase.firestore() instead."),ta=I(Fo,"Use firebase.firestore().runTransaction() instead."),ea=I(Vo,"Use firebase.firestore().batch() instead."),na=I(Bo,"Use firebase.firestore().doc() instead."),ra=I(jo),ia=I(Go),oa=I(Wo),aa=I(Ko),sa=I(Ho,"Use firebase.firestore().collection() instead."),ua={Firestore:Zo,GeoPoint:ui,Timestamp:It,Blob:rt,Transaction:ta,WriteBatch:ea,DocumentReference:na,DocumentSnapshot:ra,Query:oa,QueryDocumentSnapshot:ia,QuerySnapshot:aa,CollectionReference:sa,FieldPath:no,FieldValue:vo,setLogLevel:Uo.setLogLevel,CACHE_SIZE_UNLIMITED:Mo};function ca(t){t.INTERNAL.registerComponent(new c.Component("firestore",function(t){var e=t.getProvider("app").getImmediate();return new Uo(e,t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(function(t){b(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(ua)))}var ha=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),la=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){m("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(0)}},t.prototype.onNetworkUnavailable=function(){m("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(1)}},t.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),fa=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){b(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){b(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){b(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){b(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){b(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){b(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),pa="Connection",da={BatchGetDocuments:"batchGet",Commit:"commit"},ma="gl-js/ fire/"+l,ya=function(){function t(t){this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=ma},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(o,s){var u=new h.XhrIo;u.listenOnce(h.EventType.COMPLETE,function(){try{switch(u.getLastErrorCode()){case h.ErrorCode.NO_ERROR:var e=u.getResponseJson();m(pa,"XHR received:",JSON.stringify(e)),o(e);break;case h.ErrorCode.TIMEOUT:m(pa,'RPC "'+t+'" timed out'),s(new S(E.DEADLINE_EXCEEDED,"Request time out"));break;case h.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(m(pa,'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=(a=r.status,c=a.toLowerCase().replace("_","-"),Object.values(E).indexOf(c)>=0?c:E.UNKNOWN);s(new S(i,r.message))}else s(new S(E.UNKNOWN,"Server responded with status "+u.getStatus()))}else m(pa,'RPC "'+t+'" failed'),s(new S(E.UNAVAILABLE,"Connection failed."));break;default:v('RPC "'+t+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{m(pa,'RPC "'+t+'" completed.')}var a,c});var c=a.__assign({},e);delete c.database;var l=JSON.stringify(c);m(pa,"XHR sending: ",i+" "+l);var f={"Content-Type":"text/plain"};r.modifyHeadersForRequest(f,n),u.send(i,"POST",l,f,15)})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=h.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),u.isReactNative()||u.isElectron()||u.isIE()||u.isUWP()||u.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");m(pa,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,c=!1,l=new fa({sendFn:function(t){c?m(pa,"Not sending because WebChannel is closed:",t):(s||(m(pa,"Opening WebChannel transport."),a.open(),s=!0),m(pa,"WebChannel sending:",t),a.send(t))},closeFn:function(){return a.close()}}),f=function(t,e){a.listen(t,function(t){try{e(t)}catch(n){setTimeout(function(){throw n},0)}})};return f(h.WebChannel.EventType.OPEN,function(){c||m(pa,"WebChannel transport opened.")}),f(h.WebChannel.EventType.CLOSE,function(){c||(c=!0,m(pa,"WebChannel transport closed"),l.callOnClose())}),f(h.WebChannel.EventType.ERROR,function(t){c||(c=!0,m(pa,"WebChannel transport errored:",t),l.callOnClose(new S(E.UNAVAILABLE,"The operation could not be completed")))}),f(h.WebChannel.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];b(!!n,"Got a webchannel message without data.");var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){m(pa,"WebChannel received error:",i);var o=i.status,s=function(t){var e=Br[t];if(void 0!==e)return Gr(e)}(o),u=i.message;void 0===s&&(s=E.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),c=!0,l.callOnClose(new S(s,u)),a.close()}else m(pa,"WebChannel received:",n),l.callOnMessage(n)}}),setTimeout(function(){l.callOnOpen()},0),l},t.prototype.makeUrl=function(t){var e=da[t];return b(void 0!==e,"Unknown REST mapping for: "+t),this.baseUrl+"/v1/projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents:"+e},t}(),ga=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new ya(t))},t.prototype.newConnectivityMonitor=function(){return la.isAvailable()?new la:new ha},t.prototype.newSerializer=function(t){return new Ei(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();w.setPlatform(new ga);var va="@firebase/firestore",ba="1.10.1";function wa(t){ca(t),t.registerVersion(va,ba)}wa(o),e.registerFirestore=wa}).call(this,n(291))},1477:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"ErrorCode",function(){return cr}),n.d(e,"EventType",function(){return hr}),n.d(e,"WebChannel",function(){return lr}),n.d(e,"XhrIo",function(){return fr}),n.d(e,"createWebChannelTransport",function(){return ur});var r,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},o=o||{},a=i;function s(t){return"string"==typeof t}function u(t){return"number"==typeof t}function c(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function h(){}function l(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function f(t){return"array"==l(t)}function p(t){var e=l(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var m="closure_uid_"+(1e9*Math.random()>>>0),y=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:v).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var T=Date.now||function(){return+new Date};function E(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.xb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function S(){this.j=this.j,this.i=this.i}S.prototype.j=!1,S.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[m]||(this[m]=++y)},S.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var I=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(s(t))return s(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},_=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=s(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function A(t){return Array.prototype.concat.apply([],arguments)}function C(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function N(t){return/^[\s\xa0]*$/.test(t)}var D,k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function R(t,e){return-1!=t.indexOf(e)}function O(t,e){return t<e?-1:t>e?1:0}t:{var P=a.navigator;if(P){var L=P.userAgent;if(L){D=L;break t}}D=""}function M(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function x(t){var e,n={};for(e in t)n[e]=t[e];return n}var U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<U.length;o++)n=U[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function V(t){return V[" "](t),t}V[" "]=h;var B,q,j=R(D,"Opera"),G=R(D,"Trident")||R(D,"MSIE"),W=R(D,"Edge"),K=W||G,H=R(D,"Gecko")&&!(R(D.toLowerCase(),"webkit")&&!R(D,"Edge"))&&!(R(D,"Trident")||R(D,"MSIE"))&&!R(D,"Edge"),z=R(D.toLowerCase(),"webkit")&&!R(D,"Edge");function Q(){var t=a.document;return t?t.documentMode:void 0}t:{var Y="",X=(q=D,H?/rv:([^\);]+)(\)|;)/.exec(q):W?/Edge\/([\d\.]+)/.exec(q):G?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(q):z?/WebKit\/(\S+)/.exec(q):j?/(?:Version)[ \/]?(\S+)/.exec(q):void 0);if(X&&(Y=X?X[1]:""),G){var J=Q();if(null!=J&&J>parseFloat(Y)){B=String(J);break t}}B=Y}var $,Z={};function tt(t){return function(t,e){var n=Z;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=k(String(B)).split("."),r=k(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=O(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||O(0==a[2].length,0==s[2].length)||O(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}var et=a.document;$=et&&G?Q()||("CSS1Compat"==et.compatMode?parseInt(B,10):5):void 0;var nt=!G||9<=Number($),rt=G&&!tt("9"),it=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",h,e),a.removeEventListener("test",h,e)}catch(n){}return t}();function ot(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function at(t,e){if(ot.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(H){t:{try{V(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=s(t.pointerType)?t.pointerType:st[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ot.prototype.b=function(){this.Ia=!1},E(at,ot);var st={2:"touch",3:"pen",4:"mouse"};at.prototype.b=function(){at.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,rt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var ut="closure_listenable_"+(1e6*Math.random()|0),ct=0;function ht(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++ct,this.X=this.Z=!1}function lt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function ft(t){this.src=t,this.a={},this.b=0}function pt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=I(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}ft.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=dt(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new ht(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var mt="closure_lm_"+(1e6*Math.random()|0),yt={};function gt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(f(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}r=_t(r);return e&&e[ut]?e.Aa(n,r,d(i)?!!i.capture:!!i,o):vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(f(e)){for(var o=0;o<e.length;o++)gt(t,e[o],n,r,i);return null}return n=_t(n),t&&t[ut]?t.za(e,n,d(r)?!!r.capture:!!r,i):vt(t,e,n,!1,r,i)}function vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=d(i)?!!i.capture:!!i;if(a&&!nt)return null;var s=St(t);if(s||(t[mt]=s=new ft(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=Et,e=nt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)it||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(wt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function bt(t){if(!u(t)&&t&&!t.X){var e=t.src;if(e&&e[ut])pt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(wt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=St(e))?(pt(n,t),0==n.b&&(n.src=null,e[mt]=null)):lt(t)}}}function wt(t){return t in yt?yt[t]:yt[t]="on"+t}function Tt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&bt(t),n.call(r,e)}function Et(t,e){return!!t.X||(nt?Tt(t,new at(e,this)):Tt(t,e=new at(e||c("window.event"),this)))}function St(t){return(t=t[mt])instanceof ft?t:null}var It="__closure_events_fn_"+(1e9*Math.random()>>>0);function _t(t){return"function"==l(t)?t:(t[It]||(t[It]=function(e){return t.handleEvent(e)}),t[It])}function At(){S.call(this),this.c=new ft(this),this.J=this,this.B=null}function Ct(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&pt(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ia}E(At,S),At.prototype[ut]=!0,(r=At.prototype).addEventListener=function(t,e,n,r){gt(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(f(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=d(i)?!!i.capture:!!i,r=_t(r),e&&e[ut]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=dt(a=e.a[n],r,i,o))&&(lt(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--))):e&&(e=St(e))&&(n=e.a[n.toString()],e=-1,n&&(e=dt(n,r,i,o)),(r=-1<e?n[e]:null)&&bt(r))}(this,t,e,n,r)},r.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(s(t))t=new ot(t,n);else if(t instanceof ot)t.target=t.target||n;else{var i=t;F(t=new ot(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Ct(a,r,!0,t)&&i}if(i=Ct(a=t.a=n,r,!0,t)&&i,i=Ct(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Ct(a=t.a=e[o],r,!1,t)&&i;return i},r.G=function(){if(At.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)lt(n[r]);delete e.a[t],e.b--}}this.B=null},r.za=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},r.Aa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Nt=a.JSON.stringify;function Dt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function kt(){this.b=this.a=null}Dt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Rt,Ot=new Dt(function(){return new Lt},function(t){t.reset()});function Pt(){var t=Ft,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Lt(){this.next=this.b=this.a=null}function Mt(t){a.setTimeout(function(){throw t},0)}function xt(t,e){Rt||function(){var t=a.Promise.resolve(void 0);Rt=function(){t.then(Vt)}}(),Ut||(Rt(),Ut=!0),Ft.add(t,e)}kt.prototype.add=function(t,e){var n=Ot.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Lt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Lt.prototype.reset=function(){this.next=this.b=this.a=null};var Ut=!1,Ft=new kt;function Vt(){for(var t;t=Pt();){try{t.a.call(t.b)}catch(n){Mt(n)}var e=Ot;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Ut=!1}function Bt(t,e){At.call(this),this.b=t||1,this.a=e||a,this.f=b(this.fb,this),this.g=T()}function qt(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function jt(t,e,n){if("function"==l(t))n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function Gt(t,e,n){S.call(this),this.f=null!=n?b(t,n):t,this.c=e,this.b=b(this.$a,this),this.a=[]}function Wt(t){t.U=jt(t.b,t.c),t.f.apply(null,t.a)}function Kt(t){S.call(this),this.b=t,this.a={}}E(Bt,At),(r=Bt.prototype).ba=!1,r.L=null,r.fb=function(){if(this.ba){var t=T()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(qt(this),this.start()))}},r.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=T())},r.G=function(){Bt.N.G.call(this),qt(this),delete this.a},E(Gt,S),(r=Gt.prototype).ea=!1,r.U=null,r.Ta=function(t){this.a=arguments,this.U?this.ea=!0:Wt(this)},r.G=function(){Gt.N.G.call(this),this.U&&(a.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},r.$a=function(){this.U=null,this.ea&&(this.ea=!1,Wt(this))},E(Kt,S);var Ht=[];function zt(t,e,n,r){f(n)||(n&&(Ht[0]=n.toString()),n=Ht);for(var i=0;i<n.length;i++){var o=gt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Qt(t){M(t.a,function(t,e){this.a.hasOwnProperty(e)&&bt(t)},t),t.a={}}function Yt(){}Kt.prototype.G=function(){Kt.N.G.call(this),Qt(this)},Kt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xt=new At;function Jt(t){ot.call(this,"serverreachability",t)}function $t(t){Xt.dispatchEvent(new Jt(Xt,t))}function Zt(t){ot.call(this,"statevent",t)}function te(t){Xt.dispatchEvent(new Zt(Xt,t))}function ee(t){ot.call(this,"timingevent",t)}function ne(t,e){if("function"!=l(t))throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){t()},e)}E(Jt,ot),E(Zt,ot),E(ee,ot);var re={NO_ERROR:0,gb:1,nb:2,mb:3,jb:4,lb:5,ob:6,La:7,TIMEOUT:8,rb:9},ie={ib:"complete",vb:"success",Ma:"error",La:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",kb:"downloadprogress",wb:"uploadprogress"};function oe(){}function ae(t){var e;return(e=t.a)||(e=t.a={}),e}function se(){}oe.prototype.a=null;var ue,ce={OPEN:"a",hb:"b",Ma:"c",qb:"d"};function he(){ot.call(this,"d")}function le(){ot.call(this,"c")}function fe(){}function pe(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Kt(this),this.O=de,t=K?125:void 0,this.P=new Bt(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}E(he,ot),E(le,ot),E(fe,oe),ue=new fe;var de=45e3,me={},ye={};function ge(t,e,n){t.F=1,t.f=je(Me(e)),t.l=n,t.H=!0,be(t,null)}function ve(t,e,n,r){t.F=1,t.f=je(Me(e)),t.l=null,t.H=n,be(t,r)}function be(t,e){t.v=T(),Ee(t),t.D=Me(t.f),qe(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new Gt(b(t.Ja,t,t.a),t.J)),zt(t.I,t.a,"readystatechange",t.cb),e=t.h?x(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),$t(1)}function we(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=Te(t,n);if(i==ye){4==e&&(t.c=4,te(14),r=!1);break}if(i==me){t.c=4,te(15),r=!1;break}Ce(t,i)}4==e&&0==n.length&&(t.c=1,te(16),r=!1),t.b=t.b&&r,r||(Ae(t),_e(t))}function Te(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?ye:(n=Number(e.substring(n,r)),isNaN(n)?me:(r+=1)+n>e.length?ye:(e=e.substr(r,n),t.A=r+n,e))}function Ee(t){t.R=T()+t.O,Se(t,t.O)}function Se(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=ne(b(t.ab,t),e)}function Ie(t){t.i&&(a.clearTimeout(t.i),t.i=null)}function _e(t){t.g.Ca()||t.m||t.g.na(t)}function Ae(t){Ie(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,qt(t.P),Qt(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ce(t,e){try{t.g.Fa(t,e),$t(4)}catch(n){}}function Ne(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||s(t))_(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(p(t)||s(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(s(t))return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function De(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof De)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ke(t,e){Oe(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Re(t))}function Re(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Oe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Oe(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Oe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(r=pe.prototype).setTimeout=function(t){this.O=t},r.cb=function(t){t=t.target;var e=this.B;e&&3==Mn(t)?e.Ta():this.Ja(t)},r.Ja=function(t){try{if(t==this.a)t:{var e=Mn(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!K&&!this.a.aa())){this.m||4!=e||7==n||$t(8==n||0>=r?3:2),Ie(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var a=xn(this.a,"X-HTTP-Initial-Response");if(a&&!N(a)){var s=a;break e}}s=null}if(!s){this.b=!1,this.c=3,te(12),Ae(this),_e(this);break t}this.s=!0,Ce(this,s)}this.H?(we(this,e,o),K&&this.b&&3==e&&(zt(this.I,this.P,"tick",this.bb),this.P.start())):Ce(this,o),4==e&&Ae(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Ee(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,te(12)):(this.c=0,te(13)),Ae(this),_e(this)}}}catch(u){}},r.bb=function(){if(this.a){var t=Mn(this.a),e=this.a.aa();this.A<e.length&&(Ie(this),we(this,t,e),this.b&&4!=t&&Ee(this))}},r.cancel=function(){this.m=!0,Ae(this)},r.ab=function(){this.i=null;var t=T();0<=t-this.R?(2!=this.F&&($t(3),te(17)),Ae(this),this.c=2,_e(this)):Se(this,this.R-t)},(r=De.prototype).C=function(){Re(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},r.K=function(){return Re(this),this.a.concat()},r.get=function(t,e){return Oe(this.b,t)?this.b[t]:e},r.set=function(t,e){Oe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},r.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Pe=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Le(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Le?(this.h=void 0!==e?e:t.h,xe(this,t.f),this.j=t.j,Ue(this,t.b),Fe(this,t.i),this.a=t.a,Ve(this,nn(t.c)),this.g=t.g):t&&(n=String(t).match(Pe))?(this.h=!!e,xe(this,n[1]||"",!0),this.j=Ge(n[2]||""),Ue(this,n[3]||"",!0),Fe(this,n[4]),this.a=Ge(n[5]||"",!0),Ve(this,n[6]||"",!0),this.g=Ge(n[7]||"")):(this.h=!!e,this.c=new Je(null,this.h))}function Me(t){return new Le(t)}function xe(t,e,n){t.f=n?Ge(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ue(t,e,n){t.b=n?Ge(e,!0):e}function Fe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Ve(t,e,n){e instanceof Je?(t.c=e,function(t,e){e&&!t.f&&($e(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Ze(this,e),en(this,n,t))},t)),t.f=e}(t.c,t.h)):(n||(e=We(e,Ye)),t.c=new Je(e,t.h))}function Be(t,e,n){t.c.set(e,n)}function qe(t,e,n){f(n)||(n=[String(n)]),en(t.c,e,n)}function je(t){return Be(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^T()).toString(36)),t}function Ge(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function We(t,e,n){return s(t)?(t=encodeURI(t).replace(e,Ke),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ke(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Le.prototype.toString=function(){var t=[],e=this.f;e&&t.push(We(e,He,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(We(e,He,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(We(n,"/"==n.charAt(0)?Qe:ze,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",We(n,Xe)),t.join("")},Le.prototype.resolve=function(t){var e=Me(this),n=!!t.f;n?xe(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?Ue(e,t.b):n=null!=t.i;var r=t.a;if(n)Fe(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(R(i,"./")||R(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?Ve(e,nn(t.c)):n=!!t.g,n&&(e.g=t.g),e};var He=/[#\/\?@]/g,ze=/[#\?:]/g,Qe=/[#\?]/g,Ye=/[#\?@]/g,Xe=/#/g;function Je(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function $e(t){t.a||(t.a=new De,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Ze(t,e){$e(t),e=rn(t,e),Oe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ke(t.a,e))}function tn(t,e){return $e(t),e=rn(t,e),Oe(t.a.b,e)}function en(t,e,n){Ze(t,e),0<n.length&&(t.c=null,t.a.set(rn(t,e),C(n)),t.b+=n.length)}function nn(t){var e=new Je;return e.c=t.c,t.a&&(e.a=new De(t.a),e.b=t.b),e}function rn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function on(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function an(t){var e=t.a.F.a;if(null!=e)te(4),e?(te(10),Qn(t.a,t,!1)):(te(11),Qn(t.a,t,!0));else{t.b=new pe(t,void 0,void 0),t.b.h=t.h,e=Zn(e=t.a,e.Y()?t.f:null,t.i),te(4),qe(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&Be(e,n,r),ve(t.b,e,!1,t.f)}}function sn(){this.a=this.b=null}function un(){this.a=new De}function cn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[m]||(t[m]=++y)):e.charAt(0)+t}function hn(t,e){this.b=t,this.a=e}function ln(t){this.g=t||fn,a.PerformanceNavigationTiming?t=0<(t=a.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(a.ka&&a.ka.Da&&a.ka.Da()&&a.ka.Da().yb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new un),this.b=null,this.c=[]}(r=Je.prototype).add=function(t,e){$e(this),this.c=null,t=rn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},r.forEach=function(t,e){$e(this),this.a.forEach(function(n,r){_(n,function(n){t.call(e,n,r,this)},this)},this)},r.K=function(){$e(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},r.C=function(t){$e(this);var e=[];if(s(t))tn(this,t)&&(e=A(e,this.a.get(rn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=A(e,t[n])}return e},r.set=function(t,e){return $e(this),this.c=null,tn(this,t=rn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},r.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},E(function(){},function(){}),(r=on.prototype).M=null,r.$=function(t){return this.a.$(t)},r.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},r.Ca=function(){return!1},r.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=xn(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=xn(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(i){return(e=this.a).m=this.c,void Jn(e,2)}this.f=r[0]}else(e=this.a).m=this.c,Jn(e,2)}else 1==this.M&&(this.g?te(6):"11111"==e?(te(5),this.g=!0,(!G||10<=Number($))&&(this.c=200,this.b.cancel(),te(11),Qn(this.a,this,!0))):(te(7),this.g=!1))},r.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,an(this)):1==this.M&&(this.g?(te(11),Qn(this.a,this,!0)):(te(10),Qn(this.a,this,!1)));else{0==this.M?te(8):1==this.M&&te(9);var t=this.a;t.m=this.c,Jn(t,2)}},r.Y=function(){return this.a.Y()},r.ma=function(){return this.a.ma()},un.prototype.add=function(t){this.a.set(cn(t),t)},un.prototype.C=function(){return this.a.C()};var fn=10;function pn(t,e){!t.a&&(R(e,"spdy")||R(e,"quic")||R(e,"h2"))&&(t.f=t.g,t.a=new un,t.b&&(gn(t,t.b),t.b=null))}function dn(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function mn(t){return t.b?1:t.a?t.a.a.c:0}function yn(t,e){return t.b?t=t.b==e:t.a?(e=cn(e),t=Oe(t.a.a.b,e)):t=!1,t}function gn(t,e){t.a?t.a.add(e):t.b=e}function vn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=cn(e),n=Oe(t.a.a.b,n)),n&&ke(t.a.a,cn(e)))}function bn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return _(t.a.C(),function(t){e=e.concat(t.j)}),e}return C(t.c)}function wn(){}function Tn(){this.a=new wn}function En(t,e,n){var r=n||"";try{Ne(t,function(t,n){var i=t;d(t)&&(i=Nt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}ln.prototype.cancel=function(){var t;this.c=bn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(_(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},wn.prototype.stringify=function(t){return a.JSON.stringify(t,void 0)},wn.prototype.parse=function(t){return a.JSON.parse(t,void 0)};var In=a.JSON.parse;function _n(t){At.call(this),this.headers=new De,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=An,this.D=this.F=!1}E(_n,At);var An="",Cn=/^https?$/i,Nn=["POST","PUT"];function Dn(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Rn(t),Pn(t)}function Rn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function On(t){if(t.b&&void 0!==o&&(!t.s[1]||4!=Mn(t)||2!=t.T()))if(t.l&&4==Mn(t))jt(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==Mn(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.A).match(Pe)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!Cn.test(s?s.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var c=2<Mn(t)?t.a.statusText:""}catch(h){c=""}t.f=c+" ["+t.T()+"]",Rn(t)}}finally{Pn(t)}}}function Pn(t,e){if(t.a){Ln(t);var n=t.a,r=t.s[0]?h:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Ln(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(a.clearTimeout(t.m),t.m=null)}function Mn(t){return t.a?t.a.readyState:0}function xn(t,e){return t.a?t.a.getResponseHeader(e):null}function Un(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e="";return M(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),s(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Be(t,e,n),t}function Fn(t){this.f=[],this.F=new sn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!c("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=c("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=c("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=c("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=c("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.zb||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new ln(t&&t.concurrentRequestLimit),this.ja=new Tn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Vn(t){if(Bn(t),3==t.u){var e=t.P++,n=Me(t.B);Be(n,"SID",t.H),Be(n,"RID",e),Be(n,"TYPE","terminate"),Wn(t,n),(e=new pe(t,e,void 0)).F=2,e.f=je(Me(n)),n=!1,a.navigator&&a.navigator.sendBeacon&&(n=a.navigator.sendBeacon(e.f.toString(),"")),!n&&a.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=T(),Ee(e)}$n(t)}function Bn(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(a.clearTimeout(t.l),t.l=null),Yn(t),t.b.cancel(),t.h&&(u(t.h)&&a.clearTimeout(t.h),t.h=null)}function qn(t,e){t.f.push(new hn(t.Qa++,e)),3==t.u&&jn(t)}function jn(t){dn(t.b)||t.h||(t.h=!0,xt(t.Ha,t),t.A=0)}function Gn(t,e){var n;n=e?e.W:t.P++;var r=Me(t.B);Be(r,"SID",t.H),Be(r,"RID",n),Be(r,"AID",t.O),Wn(t,r),t.g&&t.i&&Un(r,t.g,t.i),n=new pe(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),gn(t.b,n),ge(n,r,e)}function Wn(t,e){t.c&&Ne({},function(t,n){Be(e,n,t)})}function Kn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?b(t.c.Sa,t.c,t):null;t:for(var i=t.f,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{En(h,a,"req"+c+"_")}catch(l){r&&r(h)}}if(s){r=a.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function Hn(t){t.a||t.l||(t.S=1,xt(t.Ga,t),t.v=0)}function zn(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=ne(b(t.Ga,t),Xn(t,t.v)),t.v++,!0)}function Qn(t,e,n){var r=e.l;r&&pn(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=Zn(t,null,t.ha),jn(t)}function Yn(t){null!=t.s&&(a.clearTimeout(t.s),t.s=null)}function Xn(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function Jn(t,e){if(2==e){var n=null;t.c&&(n=null);var r=b(t.eb,t);n||(n=new Le("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||xe(n,"https"),je(n)),function(t,e){var n=new Yt;if(a.Image){var r=new Image;r.onload=w(Sn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=w(Sn,n,r,"TestLoadImage: error",!1,e),r.onabort=w(Sn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=w(Sn,n,r,"TestLoadImage: timeout",!1,e),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else te(2);t.u=0,t.c&&t.c.ta(e),$n(t),Bn(t)}function $n(t){t.u=0,t.m=-1,t.c&&(0==bn(t.b).length&&0==t.f.length||(t.b.c.length=0,C(t.f),t.f.length=0),t.c.sa())}function Zn(t,e,n){var r=function(t){return t instanceof Le?Me(t):new Le(t,void 0)}(n);if(""!=r.b)e&&Ue(r,e+"."+r.b),Fe(r,r.i);else{var i,o=a.location;i=e?e+"."+o.hostname:o.hostname,r=function(t,e,n,r){var i=new Le(null,void 0);return t&&xe(i,t),e&&Ue(i,e),n&&Fe(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return t.V&&M(t.V,function(t,e){Be(r,e,t)}),e=t.j,n=t.I,e&&n&&Be(r,e,n),Be(r,"VER",t.wa),Wn(t,r),r}function tr(){}function er(){if(G&&!(10<=Number($)))throw Error("Environmental error: no available transport.")}function nr(t,e){At.call(this),this.a=new Fn(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?e=i:((r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!N(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!N(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new or(this)}function rr(t){he.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ir(){le.call(this),this.status=1}function or(t){this.a=t}(r=_n.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ae(this.H):ae(ue),this.a.onreadystatechange=b(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(o){return void kn(this,o)}t=n||"";var i=new De(this.headers);r&&Ne(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Dn,n=t.length,r=s(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:s(t)?t.charAt(e):t[e]}(i.K()),n=a.FormData&&t instanceof a.FormData,!(0<=I(Nn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Ln(this),0<this.o&&((this.D=function(t){return G&&tt(9)&&u(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=b(this.Ba,this)):this.m=jt(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){kn(this,o)}},r.Ba=function(){void 0!==o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},r.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Pn(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Pn(this,!0)),_n.N.G.call(this)},r.Ea=function(){this.j||(this.w||this.l||this.g?On(this):this.Za())},r.Za=function(){On(this)},r.T=function(){try{return 2<Mn(this)?this.a.status:-1}catch(q){return-1}},r.aa=function(){try{return this.a?this.a.responseText:""}catch(q){return""}},r.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),In(e)}},r.ya=function(){return this.h},r.Xa=function(){return s(this.f)?this.f:String(this.f)},(r=Fn.prototype).wa=8,r.u=1,r.Ca=function(){return 0==this.u},r.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new pe(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?F(r=x(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&s(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),Be(i=Me(this.B),"RID",t),Be(i,"CVER",22),this.o&&this.j&&Be(i,"X-HTTP-Session-Id",this.j),Wn(this,i),this.g&&r&&Un(i,this.g,r),gn(this.b,n),this.W?(Be(i,"$req",e),Be(i,"SID","null"),n.S=!0,ge(n,i,null)):ge(n,i,e),this.u=2}}else 3==this.u&&(t?Gn(this,t):0==this.f.length||dn(this.b)||Gn(this))},r.Ga=function(){this.l=null,this.a=new pe(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Me(this.pa);Be(t,"RID","rpc"),Be(t,"SID",this.H),Be(t,"CI",this.ia?"0":"1"),Be(t,"AID",this.O),Wn(this,t),Be(t,"TYPE","xmlhttp"),this.g&&this.i&&Un(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),ve(this.a,t,!0,this.ga)},r.Fa=function(t,e){if(0!=this.u&&(this.a==t||yn(this.b,t)))if(this.m=t.o,!t.s&&yn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(o){n=null}if(f(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;Yn(this),this.a.cancel(),this.a=null}zn(this),te(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=ne(b(this.Ya,this),6e3));if(1>=mn(this.b)&&this.fa){try{this.fa()}catch(o){}this.fa=void 0}}else Jn(this,11)}else if((t.s||this.a==t)&&Yn(this),!N(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&u(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=xn(r,"X-Client-Wire-Protocol"))&&pn(this.b,i),this.j&&(r=xn(r,"X-HTTP-Session-Id")))&&(this.I=r,Be(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=Zn(this,this.Y()?this.ga:null,this.ha),r.s?(vn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Ie(r),Ee(r)),this.a=r):Hn(this),0<this.f.length&&jn(this)}else"stop"!=r[0]&&"close"!=r[0]||Jn(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Jn(this,7):Vn(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},r.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,zn(this),te(19))},r.na=function(t){var e=null;if(this.a==t){Yn(this),this.a=null;var n=2}else{if(!yn(this.b,t))return;e=t.j,vn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=T()-t.v,Xt.dispatchEvent(new ee(Xt,t.l?t.l.length:0,e,this.A)),jn(this)):Hn(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(mn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.f=e.j.concat(t.f),0):1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)||(t.h=ne(b(t.Ha,t,e),Xn(t,t.A)),t.A++,0)))}(this,t)||2==n&&zn(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:Jn(this,5);break;case 4:Jn(this,10);break;case 3:Jn(this,6);break;default:Jn(this,2)}}},r.eb=function(t){te(t?2:1)},r.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new _n(this.Ka)).F=this.R,t},r.ma=function(){return!!this.c&&!0},r.Y=function(){return this.R},(r=tr.prototype).va=function(){},r.ua=function(){},r.ta=function(){},r.sa=function(){},r.Sa=function(){},er.prototype.a=function(t,e){return new nr(t,e)},E(nr,At),(r=nr.prototype).addEventListener=function(t,e,n,r){nr.N.addEventListener.call(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){nr.N.removeEventListener.call(this,t,e,n,r)},r.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;te(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new on(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=Un(e,t.g,t.i)),(t=t.w).i=n,e=Zn(t.a,null,t.i),te(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,an(t)):(qe(e,"MODE","init"),!t.a.o&&t.a.j&&qe(e,"X-HTTP-Session-Id",t.a.j),t.b=new pe(t,void 0,void 0),t.b.h=t.h,ve(t.b,e,!1,null),t.M=0)},r.close=function(){Vn(this.a)},r.Wa=function(t){if(s(t)){var e={};e.__data__=t,qn(this.a,e)}else this.h?((e={}).__data__=Nt(t),qn(this.a,e)):qn(this.a,t)},r.G=function(){this.a.c=null,delete this.f,Vn(this.a),delete this.a,nr.N.G.call(this)},E(rr,he),E(ir,le),E(or,tr),or.prototype.va=function(){this.a.dispatchEvent("a")},or.prototype.ua=function(t){this.a.dispatchEvent(new rr(t))},or.prototype.ta=function(t){this.a.dispatchEvent(new ir(t))},or.prototype.sa=function(){this.a.dispatchEvent("b")};var ar=w(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},er);er.prototype.createWebChannel=er.prototype.a,nr.prototype.send=nr.prototype.Wa,nr.prototype.open=nr.prototype.Va,nr.prototype.close=nr.prototype.close,re.NO_ERROR=0,re.TIMEOUT=8,re.HTTP_ERROR=6,ie.COMPLETE="complete",se.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",At.prototype.listen=At.prototype.za,_n.prototype.listenOnce=_n.prototype.Aa,_n.prototype.getLastError=_n.prototype.Xa,_n.prototype.getLastErrorCode=_n.prototype.ya,_n.prototype.getStatus=_n.prototype.T,_n.prototype.getResponseJson=_n.prototype.Ua,_n.prototype.getResponseText=_n.prototype.aa,_n.prototype.send=_n.prototype.ca;var sr={createWebChannelTransport:ar,ErrorCode:re,EventType:ie,WebChannel:se,XhrIo:_n},ur=sr.createWebChannelTransport,cr=sr.ErrorCode,hr=sr.EventType,lr=sr.WebChannel,fr=sr.XhrIo;e.default=sr}.call(this,n(25))},1478:function(t,e,n){"use strict";(function(t){var e=n(898),r=n.n(e);(function(){var e,n="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var i=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t,e];for(var n=0;n<e.length;++n){var r=e[n];if(r&&r.Math==Math)return r}return globalThis}(this);function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,e){if(e){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(e=e(o=r[t=t[t.length-1]]))!=o&&null!=e&&n(r,t,{configurable:!0,writable:!0,value:e})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},n.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.u(t):this.h(t)}},e.prototype.u=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.o=function(t){var e=this.f();t.La(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(n){o(n)}}:e}var i,o,a=new e(function(t,e){i=t,o=e});return this.La(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.La=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).La(e,n)})},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e(function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).La(o(a.length-1),e),i=n.next()}while(!i.done)})},e});var s=s||{},u=this||self;function c(t){return"string"==typeof t}function h(t){return"boolean"==typeof t}var l=/^[\w+\/_-]+[=]{0,2}$/,f=null;function p(){}function d(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function m(t){return null===t}function y(t){return"array"==d(t)}function g(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==d(t)}function b(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var w="closure_uid_"+(1e9*Math.random()>>>0),T=0;function E(t,e,n){return t.call.apply(t.bind,arguments)}function S(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function I(t,e,n){return(I=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:S).apply(null,arguments)}function _(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var A=Date.now||function(){return+new Date};function C(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function N(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function D(t){if(Error.captureStackTrace)Error.captureStackTrace(this,D);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function k(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");D.call(this,n+t[r])}function R(t,e){throw new k("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function O(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function P(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function L(){this.b=this.a=null}C(D,Error),D.prototype.name="CustomError",C(k,D),k.prototype.name="AssertionError",O.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var M=new O(function(){return new U},function(t){t.reset()});function x(){var t=Wt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function U(){this.next=this.b=this.a=null}function F(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(b(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;R("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}L.prototype.add=function(t,e){var n=M.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},U.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},U.prototype.reset=function(){this.next=this.b=this.a=null};var V=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(c(t))return c(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=c(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var q=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=c(t)?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},j=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=c(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function G(t,e){return 0<=V(t,e)}function W(t,e){var n;return(n=0<=(e=V(t,e)))&&Array.prototype.splice.call(t,e,1),n}function K(t,e){!function(t,e){for(var n=c(t)?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0})}function H(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function Y(t){for(var e in t)return!1;return!0}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}var J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<J.length;o++)n=J[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Z(t,e){this.a=t===nt&&e||"",this.b=et}function tt(t){return t instanceof Z&&t.constructor===Z&&t.b===et?t.a:(R("expected object of type Const, got '"+t+"'"),"type_error:Const")}Z.prototype.qa=!0,Z.prototype.pa=function(){return this.a},Z.prototype.toString=function(){return"Const{"+this.a+"}"};var et={},nt={},rt=new Z(nt,"");function it(){this.a="",this.b=ct}function ot(t){return t instanceof it&&t.constructor===it&&t.b===ct?t.a:(R("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function at(t,e){var n=tt(t);if(!ut.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return ht(t=n.replace(st,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof Z?tt(t):encodeURIComponent(String(t))}))}it.prototype.qa=!0,it.prototype.pa=function(){return this.a.toString()},it.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var st=/%{(\w+)}/g,ut=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^\/\\]|[^:\/\\%]+\/|[^:\/\\%]*[?#]|about:blank#)/i,ct={};function ht(t){var e=new it;return e.a=t,e}var lt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},ft=/&/g,pt=/</g,dt=/>/g,mt=/"/g,yt=/'/g,gt=/\x00/g,vt=/[\x00&<>"']/;function bt(t,e){return-1!=t.indexOf(e)}function wt(t,e){return t<e?-1:t>e?1:0}function Tt(){this.a="",this.b=At}function Et(t){return t instanceof Tt&&t.constructor===Tt&&t.b===At?t.a:(R("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}Tt.prototype.qa=!0,Tt.prototype.pa=function(){return this.a.toString()},Tt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var St=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i;function It(t){return t instanceof Tt?t:(t="object"==typeof t&&t.qa?t.pa():String(t),St.test(t)||(t="about:invalid#zClosurez"),Ct(t))}var _t,At={};function Ct(t){var e=new Tt;return e.a=t,e}Ct("about:blank");t:{var Nt=u.navigator;if(Nt){var Dt=Nt.userAgent;if(Dt){_t=Dt;break t}}_t=""}function kt(t){return bt(_t,t)}function Rt(){this.a="",this.b=Pt}function Ot(t){return t instanceof Rt&&t.constructor===Rt&&t.b===Pt?t.a:(R("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}Rt.prototype.qa=!0,Rt.prototype.pa=function(){return this.a.toString()},Rt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Pt={};function Lt(t){var e=new Rt;return e.a=t,e}Lt("<!DOCTYPE html>");var Mt,xt,Ut=Lt("");function Ft(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Vt(t){return vt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(ft,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(pt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(dt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(mt,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(yt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(gt,"&#0;"))),t}function Bt(t){u.setTimeout(function(){throw t},0)}function qt(){var t=u.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!kt("Presto")&&(t=function(){var t,e,n=document.createElement("IFRAME");n.style.display="none",t=n,e=ht(tt(rt)),F(t,"HTMLIFrameElement"),t.src=ot(e).toString(),document.documentElement.appendChild(n);var r=n.contentWindow;(n=r.document).open(),n.write(Ot(Ut)),n.close();var i="callImmediate"+Math.random(),o="file:"==r.location.protocol?"*":r.location.protocol+"//"+r.location.host;n=I(function(t){"*"!=o&&t.origin!=o||t.data!=i||this.port1.onmessage()},this),r.addEventListener("message",n,!1),this.port1={},this.port2={postMessage:function(){r.postMessage(i,o)}}}),void 0!==t&&!kt("Trident")&&!kt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){u.setTimeout(t,0)}}function jt(t,e){xt||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);xt=function(){t.then(Kt)}}else xt=function(){var t=Kt;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!kt("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(Mt||(Mt=qt()),Mt(t)):u.setImmediate(t)}}(),Gt||(xt(),Gt=!0),Wt.add(t,e)}Lt("<br>");var Gt=!1,Wt=new L;function Kt(){for(var t;t=x();){try{t.a.call(t.b)}catch(e){Bt(e)}P(M,t)}Gt=!1}function Ht(t,e){if(this.a=zt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=p)try{var n=this;t.call(e,function(t){oe(n,Qt,t)},function(t){if(!(t instanceof fe))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}oe(n,Yt,t)})}catch(r){oe(this,Yt,r)}}var zt=0,Qt=2,Yt=3;function Xt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Xt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Jt=new O(function(){return new Xt},function(t){t.reset()});function $t(t,e,n){var r=Jt.get();return r.g=t,r.b=e,r.f=n,r}function Zt(t){if(t instanceof Ht)return t;var e=new Ht(p);return oe(e,Qt,t),e}function te(t){return new Ht(function(e,n){n(t)})}function ee(t,e,n){ae(t,e,n,null)||jt(_(e,t))}function ne(t){return new Ht(function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Gb:!0,value:o}:{Gb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)ee(t[o],_(i,o,!0),_(i,o,!1));else e(r)})}function re(t,e){t.b||t.a!=Qt&&t.a!=Yt||se(t),t.f?t.f.next=e:t.b=e,t.f=e}function ie(t,e,n,r){var i=$t(null,null,null);return i.a=new Ht(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(a){o(a)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof fe?o(e):t(i)}catch(a){o(a)}}:o}),i.a.c=t,re(t,i),i.a}function oe(t,e,n){t.a==zt&&(t===n&&(e=Yt,n=new TypeError("Promise cannot resolve to itself")),t.a=1,ae(n,t.Oc,t.Pc,t)||(t.i=n,t.a=e,t.c=null,se(t),e!=Yt||n instanceof fe||function(t,e){t.g=!0,jt(function(){t.g&&le.call(null,e)})}(t,n)))}function ae(t,e,n,r){if(t instanceof Ht)return re(t,$t(e||p,n||null,r)),!0;if(N(t))return t.then(e,n,r),!0;if(b(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(i,t))},o)}catch(s){o(s)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function se(t){t.h||(t.h=!0,jt(t.Zb,t))}function ue(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ce(t,e,n,r){if(n==Yt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,he(e,n,r);else try{e.c?e.g.call(e.f):he(e,n,r)}catch(i){le.call(null,i)}P(Jt,e)}function he(t,e,n){e==Qt?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Ht.prototype.then=function(t,e,n){return ie(this,v(t)?t:null,v(e)?e:null,n)},Ht.prototype.$goog_Thenable=!0,(e=Ht.prototype).ka=function(t,e){return(t=$t(t,t,e)).c=!0,re(this,t),this},e.s=function(t,e){return ie(this,null,t,e)},e.cancel=function(t){this.a==zt&&jt(function(){!function t(e,n){if(e.a==zt)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==zt&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):ue(r),ce(r,o,Yt,n)))}e.c=null}else oe(e,Yt,n)}(this,new fe(t))},this)},e.Oc=function(t){this.a=zt,oe(this,Qt,t)},e.Pc=function(t){this.a=zt,oe(this,Yt,t)},e.Zb=function(){for(var t;t=ue(this);)ce(this,t,this.a,this.i);this.h=!1};var le=Bt;function fe(t){D.call(this,t)}function pe(){0!=de&&(me[this[w]||(this[w]=++T)]=this),this.va=this.va,this.la=this.la}C(fe,D),fe.prototype.name="cancel";var de=0,me={};function ye(t){if(!t.va&&(t.va=!0,t.za(),0!=de)){var e=t[w]||(t[w]=++T);if(0!=de&&t.la&&0<t.la.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete me[e]}}function ge(t){return ge[" "](t),t}pe.prototype.va=!1,pe.prototype.za=function(){if(this.la)for(;this.la.length;)this.la.shift()()},ge[" "]=p;var ve,be,we=kt("Opera"),Te=kt("Trident")||kt("MSIE"),Ee=kt("Edge"),Se=Ee||Te,Ie=kt("Gecko")&&!(bt(_t.toLowerCase(),"webkit")&&!kt("Edge"))&&!(kt("Trident")||kt("MSIE"))&&!kt("Edge"),_e=bt(_t.toLowerCase(),"webkit")&&!kt("Edge");function Ae(){var t=u.document;return t?t.documentMode:void 0}t:{var Ce="",Ne=(be=_t,Ie?/rv:([^\);]+)(\)|;)/.exec(be):Ee?/Edge\/([\d\.]+)/.exec(be):Te?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(be):_e?/WebKit\/(\S+)/.exec(be):we?/(?:Version)[ \/]?(\S+)/.exec(be):void 0);if(Ne&&(Ce=Ne?Ne[1]:""),Te){var De=Ae();if(null!=De&&De>parseFloat(Ce)){ve=String(De);break t}}ve=Ce}var ke,Re={};function Oe(t){return function(t,e){var n=Re;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=lt(String(ve)).split("."),r=lt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=wt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||wt(0==a[2].length,0==s[2].length)||wt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}ke=u.document&&Te?Ae():void 0;var Pe=Object.freeze||function(t){return t},Le=!Te||9<=Number(ke),Me=Te&&!Oe("9"),xe=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",p,e),u.removeEventListener("test",p,e)}catch(n){}return t}();function Ue(t,e){this.type=t,this.b=this.target=e,this.Mb=!0}function Fe(t,e){if(Ue.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Ie){t:{try{ge(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=c(t.pointerType)?t.pointerType:Ve[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ue.prototype.preventDefault=function(){this.Mb=!1},C(Fe,Ue);var Ve=Pe({2:"touch",3:"pen",4:"mouse"});Fe.prototype.preventDefault=function(){Fe.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Me)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Fe.prototype.f=function(){return this.a};var Be="closure_listenable_"+(1e6*Math.random()|0),qe=0;function je(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Pa=i,this.key=++qe,this.ta=this.Ka=!1}function Ge(t){t.ta=!0,t.listener=null,t.proxy=null,t.src=null,t.Pa=null}function We(t){this.src=t,this.a={},this.b=0}function Ke(t,e){var n=e.type;n in t.a&&W(t.a[n],e)&&(Ge(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function He(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ta&&o.listener==e&&o.capture==!!n&&o.Pa==r)return i}return-1}We.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=He(t,e,r,i);return-1<a?(e=t[a],n||(e.Ka=!1)):((e=new je(e,this.src,o,!!r,i)).Ka=n,t.push(e)),e};var ze="closure_lm_"+(1e6*Math.random()|0),Qe={};function Ye(t,e,n,r,i){if(r&&r.once)Je(t,e,n,r,i);else if(y(e))for(var o=0;o<e.length;o++)Ye(t,e[o],n,r,i);else n=sn(n),t&&t[Be]?cn(t,e,n,b(r)?!!r.capture:!!r,i):Xe(t,e,n,!1,r,i)}function Xe(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=b(i)?!!i.capture:!!i,s=on(t);if(s||(t[ze]=s=new We(t)),!(n=s.add(e,n,r,a,o)).proxy){if(r=function(){var t=rn,e=Le?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)xe||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(tn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function Je(t,e,n,r,i){if(y(e))for(var o=0;o<e.length;o++)Je(t,e[o],n,r,i);else n=sn(n),t&&t[Be]?hn(t,e,n,b(r)?!!r.capture:!!r,i):Xe(t,e,n,!0,r,i)}function $e(t,e,n,r,i){if(y(e))for(var o=0;o<e.length;o++)$e(t,e[o],n,r,i);else r=b(r)?!!r.capture:!!r,n=sn(n),t&&t[Be]?(t=t.u,(e=String(e).toString())in t.a&&(-1<(n=He(o=t.a[e],n,r,i))&&(Ge(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=on(t))&&(e=t.a[e.toString()],t=-1,e&&(t=He(e,n,r,i)),(n=-1<t?e[t]:null)&&Ze(n))}function Ze(t){if("number"!=typeof t&&t&&!t.ta){var e=t.src;if(e&&e[Be])Ke(e.u,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(tn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),0,(n=on(e))?(Ke(n,t),0==n.b&&(n.src=null,e[ze]=null)):Ge(t)}}}function tn(t){return t in Qe?Qe[t]:Qe[t]="on"+t}function en(t,e,n,r){var i=!0;if((t=on(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ta&&(o=nn(o,r),i=i&&!1!==o)}return i}function nn(t,e){var n=t.listener,r=t.Pa||t.src;return t.Ka&&Ze(t),n.call(r,e)}function rn(t,e){if(t.ta)return!0;if(!Le){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Fe(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=en(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=en(r[i],t,!1,e),n=n&&o}return n}return nn(t,new Fe(e,this))}function on(t){return(t=t[ze])instanceof We?t:null}var an="__closure_events_fn_"+(1e9*Math.random()>>>0);function sn(t){return v(t)?t:(t[an]||(t[an]=function(e){return t.handleEvent(e)}),t[an])}function un(){pe.call(this),this.u=new We(this),this.Sb=this,this.Xa=null}function cn(t,e,n,r,i){t.u.add(String(e),n,!1,r,i)}function hn(t,e,n,r,i){t.u.add(String(e),n,!0,r,i)}function ln(t,e,n,r){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ta&&a.capture==n){var s=a.listener,u=a.Pa||a.src;a.Ka&&Ke(t.u,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Mb}function fn(t,e,n){if(v(t))n&&(t=I(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=I(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function pn(t){var e=null;return new Ht(function(n,r){-1==(e=fn(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).s(function(t){throw u.clearTimeout(e),t})}function dn(t){if(t.U&&"function"==typeof t.U)return t.U();if(c(t))return t.split("");if(g(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function mn(t){if(t.X&&"function"==typeof t.X)return t.X();if(!t.U||"function"!=typeof t.U){if(g(t)||c(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function yn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof yn)for(n=t.X(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function gn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];vn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)vn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function vn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}C(un,pe),un.prototype[Be]=!0,un.prototype.addEventListener=function(t,e,n,r){Ye(this,t,e,n,r)},un.prototype.removeEventListener=function(t,e,n,r){$e(this,t,e,n,r)},un.prototype.dispatchEvent=function(t){var e,n=this.Xa;if(n)for(e=[];n;n=n.Xa)e.push(n);n=this.Sb;var r=t.type||t;if(c(t))t=new Ue(t,n);else if(t instanceof Ue)t.target=t.target||n;else{var i=t;$(t=new Ue(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=ln(a,r,!0,t)&&i}if(i=ln(a=t.b=n,r,!0,t)&&i,i=ln(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=ln(a=t.b=e[o],r,!1,t)&&i;return i},un.prototype.za=function(){if(un.qb.za.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,Ge(n[r]);delete e.a[t],e.b--}}this.Xa=null},(e=yn.prototype).U=function(){gn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.X=function(){return gn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(t,e){return vn(this.b,t)?this.b[t]:e},e.set=function(t,e){vn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.X(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var bn=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function wn(t,e){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,t instanceof wn?(this.h=void 0!==e?e:t.h,Tn(this,t.f),this.i=t.i,this.b=t.b,En(this,t.l),this.c=t.c,Sn(this,jn(t.a)),this.g=t.g):t&&(n=String(t).match(bn))?(this.h=!!e,Tn(this,n[1]||"",!0),this.i=Nn(n[2]||""),this.b=Nn(n[3]||"",!0),En(this,n[4]),this.c=Nn(n[5]||"",!0),Sn(this,n[6]||"",!0),this.g=Nn(n[7]||"")):(this.h=!!e,this.a=new xn(null,this.h))}function Tn(t,e,n){t.f=n?Nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function En(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.l=e}else t.l=null}function Sn(t,e,n){e instanceof xn?(t.a=e,function(t,e){e&&!t.f&&(Un(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Vn(this,e),qn(this,n,t))},t)),t.f=e}(t.a,t.h)):(n||(e=Dn(e,Ln)),t.a=new xn(e,t.h))}function In(t,e,n){t.a.set(e,n)}function _n(t,e){return t.a.get(e)}function An(t){return t instanceof wn?new wn(t):new wn(t,void 0)}function Cn(t,e){var n=new wn(null,void 0);return Tn(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function Nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Dn(t,e,n){return c(t)?(t=encodeURI(t).replace(e,kn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function kn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}wn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Dn(e,Rn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(Dn(e,Rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.l)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Dn(n,"/"==n.charAt(0)?Pn:On,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Dn(n,Mn)),t.join("")},wn.prototype.resolve=function(t){var e=new wn(this),n=!!t.f;n?Tn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.l;var r=t.c;if(n)En(e,t.l);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(bt(i,"./")||bt(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?Sn(e,jn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var Rn=/[#\/\?@]/g,On=/[#\?:]/g,Pn=/[#\?]/g,Ln=/[#\?@]/g,Mn=/#/g;function xn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Un(t){t.a||(t.a=new yn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Fn(t){var e=mn(t);if(void 0===e)throw Error("Keys are undefined");var n=new xn(null,void 0);t=dn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];y(o)?qn(n,i,o):n.add(i,o)}return n}function Vn(t,e){Un(t),e=Gn(t,e),vn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,vn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&gn(t)))}function Bn(t,e){return Un(t),e=Gn(t,e),vn(t.a.b,e)}function qn(t,e,n){Vn(t,e),0<n.length&&(t.c=null,t.a.set(Gn(t,e),z(n)),t.b+=n.length)}function jn(t){var e=new xn;return e.c=t.c,t.a&&(e.a=new yn(t.a),e.b=t.b),e}function Gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(e=xn.prototype).add=function(t,e){Un(this),this.c=null,t=Gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(t,e){Un(this),this.a.forEach(function(n,r){B(n,function(n){t.call(e,n,r,this)},this)},this)},e.X=function(){Un(this);for(var t=this.a.U(),e=this.a.X(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.U=function(t){Un(this);var e=[];if(c(t))Bn(this,t)&&(e=H(e,this.a.get(Gn(this,t))));else{t=this.a.U();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},e.set=function(t,e){return Un(this),this.c=null,Bn(this,t=Gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.U(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.X(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.U(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var Wn=!Te||9<=Number(ke);function Kn(t){var e=document;return c(t)?e.getElementById(t):t}function Hn(t,e){Q(e,function(e,n){e&&"object"==typeof e&&e.qa&&(e=e.pa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:zn.hasOwnProperty(n)?t.setAttribute(zn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}var zn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Qn(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!Wn&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Vt(a.name),'"'),a.type){o.push(' type="',Vt(a.type),'"');var s={};$(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=i.createElement(o),a&&(c(a)?o.className=a:y(a)?o.className=a.join(" "):Hn(o,a)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild(c(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!g(o)||b(o)&&0<o.nodeType?r(o):B(Yn(o)?z(o):o,r)}}(i,o,r),o}function Yn(t){if(t&&"number"==typeof t.length){if(b(t))return"function"==typeof t.item||"string"==typeof t.item;if(v(t))return"function"==typeof t.item}return!1}function Xn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(y(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&("function"!=typeof(a=n[i])&&(r.push(o),tr(i,r),r.push(":"),t(e,a,r),o=","));return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":tr(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Jn,t,e),e.join("")}function Jn(){}var $n={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Zn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function tr(t,e){e.push('"',t.replace(Zn,function(t){var e=$n[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),$n[t]=e),e}),'"')}function er(){var t=wr();return Te&&!!ke&&11==ke||/Edge\/\d+/.test(t)}function nr(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function rr(t,e){e=e||u.window;var n="about:blank";t&&(n=Et(It(t)).toString()),e.location.href=n}function ir(t){return!!((t=(t||wr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function or(t){t=t||u.window;try{t.close()}catch(e){}}function ar(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=wr().toLowerCase(),r&&(e.target=r,bt(n,"crios/")&&(e.target="_blank")),gr(wr())==mr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Tt?n:It(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((kt("iPhone")&&!kt("iPod")&&!kt("iPad")||kt("iPad")||kt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(F(a=r.document.createElement("A"),"HTMLAnchorElement"),e instanceof Tt||e instanceof Tt||(e="object"==typeof e&&e.qa?e.pa():String(e),St.test(e)||(e="about:invalid#zClosurez"),e=Ct(e)),a.href=Et(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=Et(e).toString(),a&&(Se&&bt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Lt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Vt(t)+'">'),a.document.write(Ot(t)),a.document.close())):(a=r.open(Et(e).toString(),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var sr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ur=/^[^@]+@[^@]+$/;function cr(){var t=null;return new Ht(function(e){"complete"==u.document.readyState?e():(t=function(){e()},Je(window,"load",t))}).s(function(e){throw $e(window,"load",t),e})}function hr(t){return t=t||wr(),!("file:"!==_r()&&"ionic:"!==_r()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function lr(){var t=u.window;try{return!(!t||t==t.top)}catch(e){return!1}}function fr(){return void 0!==u.WorkerGlobalScope&&"function"==typeof u.importScripts}function pr(){return r.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.a.INTERNAL.hasOwnProperty("node")?"Node":fr()?"Worker":"Browser"}function dr(){var t=pr();return"ReactNative"===t||"Node"===t}var mr="Firefox",yr="Chrome";function gr(t){var e=t.toLowerCase();return bt(e,"opera/")||bt(e,"opr/")||bt(e,"opios/")?"Opera":bt(e,"iemobile")?"IEMobile":bt(e,"msie")||bt(e,"trident/")?"IE":bt(e,"edge/")?"Edge":bt(e,"firefox/")?mr:bt(e,"silk/")?"Silk":bt(e,"blackberry")?"Blackberry":bt(e,"webos")?"Webos":!bt(e,"safari/")||bt(e,"chrome/")||bt(e,"crios/")||bt(e,"android")?!bt(e,"chrome/")&&!bt(e,"crios/")||bt(e,"edge/")?bt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":yr:"Safari"}var vr={Wc:"FirebaseCore-web",Yc:"FirebaseUI-web"};function br(t,e){e=e||[];var n,r=[],i={};for(n in vr)i[vr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=pr())?r=gr(i=wr()):"Worker"===r&&(r=gr(i=wr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function wr(){return u.navigator&&u.navigator.userAgent||""}function Tr(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Er(){try{var t=u.localStorage,e=kr();if(t)return t.setItem(e,"1"),t.removeItem(e),!er()||!!u.indexedDB}catch(n){return fr()&&!!u.indexedDB}return!1}function Sr(){return(Ir()||"chrome-extension:"===_r()||hr())&&!dr()&&Er()&&!fr()}function Ir(){return"http:"===_r()||"https:"===_r()}function _r(){return u.location&&u.location.protocol||null}function Ar(t){return!ir(t=t||wr())&&gr(t)!=mr}function Cr(t){return void 0===t?null:Xn(t)}function Nr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Dr(t){if(null!==t)return JSON.parse(t)}function kr(t){return t||Math.floor(1e9*Math.random()).toString()}function Rr(t){return"Safari"!=gr(t=t||wr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Or(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Pr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=wr(),e=pr(),this.b=ir(t)||"ReactNative"===e}function Lr(){var t=u.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Mr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function xr(){return!(!Tr("fireauth.oauthhelper",u)&&!Tr("fireauth.iframe",u))}Pr.prototype.get=function(){var t=u.navigator;return!t||"boolean"!=typeof t.onLine||!Ir()&&"chrome-extension:"!==_r()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Ur,Fr={};function Vr(t){Fr[t]||(Fr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Br={};Object.defineProperty(Br,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Br,"abcd",{configurable:!0,enumerable:!0,value:2}),Ur=2==Br.abcd}catch(be){Ur=!1}function qr(t,e,n){Ur?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function jr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&qr(t,n,e[n])}function Gr(t){var e={};return jr(e,t),e}function Wr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)qr(e,n,Wr(t[n]));return e}function Kr(t){var e={},n=t[zr],r=t[Qr];if(!(t=t[Yr])||t!=Hr&&!n)throw Error("Invalid provider user info!");e[Jr]=r||null,e[Xr]=n||null,qr(this,Zr,t),qr(this,$r,Wr(e))}var Hr="EMAIL_SIGNIN",zr="email",Qr="newEmail",Yr="requestType",Xr="email",Jr="fromEmail",$r="data",Zr="operation";function ti(t,e){this.code=ni+t,this.message=e||ri[t]||""}function ei(t){var e=t&&t.code;return e?new ti(e.substring(ni.length),t.message):null}C(ti,Error),ti.prototype.A=function(){return{code:this.code,message:this.message}},ti.prototype.toJSON=function(){return this.A()};var ni="auth/",ri={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function ii(t){var e=_n(t=An(t),oi)||null,n=_n(t,ai)||null,r=_n(t,ci)||null;if(r=r&&li[r]||null,!e||!n||!r)throw new ti("argument-error",oi+", "+ai+"and "+ci+" are required in a valid action code URL.");jr(this,{apiKey:e,operation:r,code:n,continueUrl:_n(t,si)||null,languageCode:_n(t,ui)||null,tenantId:_n(t,hi)||null})}var oi="apiKey",ai="oobCode",si="continueUrl",ui="languageCode",ci="mode",hi="tenantId",li={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",signIn:Hr,verifyEmail:"VERIFY_EMAIL"};function fi(t){try{return new ii(t)}catch(e){return null}}function pi(t){var e=t[vi];if(void 0===e)throw new ti("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new ti("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[di];if(n&&"object"==typeof n){e=n[Ti];var r=n[bi];if(n=n[wi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new ti("argument-error",bi+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new ti("argument-error",wi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new ti("argument-error",Ti+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new ti("missing-android-pkg-name")}}else if(void 0!==n)throw new ti("argument-error",di+" property must be a non null object when specified.");if(this.f=null,(e=t[gi])&&"object"==typeof e){if("string"==typeof(e=e[Ei])&&e.length)this.f=e;else if(void 0!==e)throw new ti("argument-error",Ei+" property must be a non empty string when specified.")}else if(void 0!==e)throw new ti("argument-error",gi+" property must be a non null object when specified.");if(void 0!==(e=t[yi])&&"boolean"!=typeof e)throw new ti("argument-error",yi+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[mi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new ti("argument-error",mi+" property must be a non empty string when specified.");this.i=t||null}var di="android",mi="dynamicLinkDomain",yi="handleCodeInApp",gi="iOS",vi="url",bi="installApp",wi="minimumVersion",Ti="packageName",Ei="bundleId";function Si(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Ii=null,_i=null;function Ai(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=_i[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ii){Ii={},_i={};for(var t=0;65>t;t++)Ii[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),_i[Ii[t]]=t,62<=t&&(_i["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}function Ci(t){this.f=t.sub,A(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.c=t.firebase&&t.firebase.tenant||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Ni(t){return(t=Di(t))&&t.sub&&t.iss&&t.aud&&t.exp?new Ci(t):null}function Di(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Ai(t))}catch(r){}return null}Ci.prototype.R=function(){return this.c},Ci.prototype.g=function(){return this.b};var ki,Ri={bd:{cb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},dd:{cb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ed:{cb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Oi(t){for(var e in Ri)if(Ri[e].id===t)return{firebaseEndpoint:(t=Ri[e]).cb,secureTokenEndpoint:t.ib};return null}ki=Oi("__EID__")?"__EID__":void 0;var Pi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Li=["client_id","response_type","scope","redirect_uri","state"],Mi={Xc:{Ea:"locale",sa:700,ra:600,Fa:"facebook.com",Qa:Li},Zc:{Ea:null,sa:500,ra:750,Fa:"github.com",Qa:Li},$c:{Ea:"hl",sa:515,ra:680,Fa:"google.com",Qa:Li},fd:{Ea:"lang",sa:485,ra:705,Fa:"twitter.com",Qa:Pi},Vc:{Ea:"locale",sa:600,ra:600,Fa:"apple.com",Qa:[]}};function xi(t){for(var e in Mi)if(Mi[e].Fa==t)return Mi[e];return null}function Ui(t){var e={};e["facebook.com"]=ji,e["google.com"]=Wi,e["github.com"]=Gi,e["twitter.com"]=Ki;var n=t&&t[Vi];try{if(n)return e[n]?new e[n](t):new qi(t);if(void 0!==t[Fi])return new Bi(t)}catch(r){}return null}var Fi="idToken",Vi="providerId";function Bi(t){var e=t[Vi];if(!e&&t[Fi]){var n=Ni(t[Fi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),qr(this,"providerId",e),qr(this,"isNewUser",n)}function qi(t){Bi.call(this,t),qr(this,"profile",Wr((t=Dr(t.rawUserInfo||"{}"))||{}))}function ji(t){if(qi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Gi(t){if(qi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");qr(this,"username",this.profile&&this.profile.login||null)}function Wi(t){if(qi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Ki(t){if(qi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");qr(this,"username",t.screenName||null)}function Hi(t){var e=An(t),n=_n(e,"link"),r=_n(An(n),"link");return e=_n(e,"deep_link_id"),_n(An(e),"link")||e||r||n||t}function zi(){}function Qi(t,e){return t.then(function(t){if(t[xa]){var n=Ni(t[xa]);if(!n||e!=n.f)throw new ti("user-mismatch");return t}throw new ti("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==ni+"user-not-found"?new ti("user-mismatch"):t})}function Yi(t,e){if(!e)throw new ti("internal-error","failed to construct a credential");this.a=e,qr(this,"providerId",t),qr(this,"signInMethod",t)}function Xi(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Ji(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Yi(t.providerId,t.pendingToken)}catch(e){}return null}function $i(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&qr(this,"idToken",e.idToken),e.accessToken&&qr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&qr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new ti("internal-error","failed to construct a credential");qr(this,"accessToken",e.oauthToken),qr(this,"secret",e.oauthTokenSecret)}qr(this,"providerId",t),qr(this,"signInMethod",n)}function Zi(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Fn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function to(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new $i(t.providerId,e,t.signInMethod)}catch(n){}}return null}function eo(t,e){this.Fc=e||[],jr(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(xi(t)||{}).Ea||null,this.bb=null}function no(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new ti("argument-error",'SAML provider IDs must be prefixed with "saml."');eo.call(this,t,[])}function ro(t){eo.call(this,t,Li),this.a=[]}function io(){ro.call(this,"facebook.com")}function oo(t){if(!t)throw new ti("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return b(t)&&(e=t.accessToken),(new io).credential({accessToken:e})}function ao(){ro.call(this,"github.com")}function so(t){if(!t)throw new ti("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return b(t)&&(e=t.accessToken),(new ao).credential({accessToken:e})}function uo(){ro.call(this,"google.com"),this.ya("profile")}function co(t,e){var n=t;return b(t)&&(n=t.idToken,e=t.accessToken),(new uo).credential({idToken:n,accessToken:e})}function ho(){eo.call(this,"twitter.com",Pi)}function lo(t,e){var n=t;if(b(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new ti("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new $i("twitter.com",n,"twitter.com")}function fo(t,e,n){this.a=t,this.c=e,qr(this,"providerId","password"),qr(this,"signInMethod",n===mo.EMAIL_LINK_SIGN_IN_METHOD?mo.EMAIL_LINK_SIGN_IN_METHOD:mo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function po(t){return t&&t.email&&t.password?new fo(t.email,t.password,t.signInMethod):null}function mo(){jr(this,{providerId:"password",isOAuthProvider:!1})}function yo(t,e){if(!(e=go(e)))throw new ti("argument-error","Invalid email link!");return new fo(t,e.code,mo.EMAIL_LINK_SIGN_IN_METHOD)}function go(t){return(t=fi(t=Hi(t)))&&t.operation===Hr?t:null}function vo(t){if(!(t.Va&&t.Ua||t.Ha&&t.ba))throw new ti("internal-error");this.a=t,qr(this,"providerId","phone"),qr(this,"signInMethod","phone")}function bo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return B(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new vo(e)}return null}function wo(t){return t.a.Ha&&t.a.ba?{temporaryProof:t.a.Ha,phoneNumber:t.a.ba}:{sessionInfo:t.a.Va,code:t.a.Ua}}function To(t){try{this.a=t||r.a.auth()}catch(e){throw new ti("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}jr(this,{providerId:"phone",isOAuthProvider:!1})}function Eo(t,e){if(!t)throw new ti("missing-verification-id");if(!e)throw new ti("missing-verification-code");return new vo({Va:t,Ua:e})}function So(t){if(t.temporaryProof&&t.phoneNumber)return new vo({Ha:t.temporaryProof,ba:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return co(o,n);case"facebook.com":return oo(n);case"github.com":return so(n);case"twitter.com":return lo(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new Yi(e,a):new $i(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new ro(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Io(t){if(!t.isOAuthProvider)throw new ti("invalid-oauth-provider")}function _o(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new ti("invalid-auth-event");if(this.g&&this.a)throw new ti("invalid-auth-event");if(this.g&&!this.f)throw new ti("invalid-auth-event")}function Ao(t){return(t=t||{}).type?new _o(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&ei(t.error),t.postBody,t.tenantId):null}function Co(){this.b=null,this.a=[]}C(qi,Bi),C(ji,qi),C(Gi,qi),C(Wi,qi),C(Ki,qi),Yi.prototype.na=function(t){return ts(t,Xi(this))},Yi.prototype.b=function(t,e){var n=Xi(this);return n.idToken=e,es(t,n)},Yi.prototype.f=function(t,e){return Qi(ns(t,Xi(this)),e)},Yi.prototype.A=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},$i.prototype.na=function(t){return ts(t,Zi(this))},$i.prototype.b=function(t,e){var n=Zi(this);return n.idToken=e,es(t,n)},$i.prototype.f=function(t,e){return Qi(ns(t,Zi(this)),e)},$i.prototype.A=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},eo.prototype.Ga=function(t){return this.zb=X(t),this},C(no,eo),C(ro,eo),ro.prototype.ya=function(t){return G(this.a,t)||this.a.push(t),this},ro.prototype.Hb=function(){return z(this.a)},ro.prototype.credential=function(t,e){var n;if(!(n=b(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new ti("argument-error","credential failed: must provide the ID token and/or the access token.");return new $i(this.providerId,n,this.providerId)},C(io,ro),qr(io,"PROVIDER_ID","facebook.com"),qr(io,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),C(ao,ro),qr(ao,"PROVIDER_ID","github.com"),qr(ao,"GITHUB_SIGN_IN_METHOD","github.com"),C(uo,ro),qr(uo,"PROVIDER_ID","google.com"),qr(uo,"GOOGLE_SIGN_IN_METHOD","google.com"),C(ho,eo),qr(ho,"PROVIDER_ID","twitter.com"),qr(ho,"TWITTER_SIGN_IN_METHOD","twitter.com"),fo.prototype.na=function(t){return this.signInMethod==mo.EMAIL_LINK_SIGN_IN_METHOD?Rs(t,hs,{email:this.a,oobCode:this.c}):Rs(t,Cs,{email:this.a,password:this.c})},fo.prototype.b=function(t,e){return this.signInMethod==mo.EMAIL_LINK_SIGN_IN_METHOD?Rs(t,ls,{idToken:e,email:this.a,oobCode:this.c}):Rs(t,Ts,{idToken:e,email:this.a,password:this.c})},fo.prototype.f=function(t,e){return Qi(this.na(t),e)},fo.prototype.A=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},jr(mo,{PROVIDER_ID:"password"}),jr(mo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),jr(mo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),vo.prototype.na=function(t){return t.Wa(wo(this))},vo.prototype.b=function(t,e){var n=wo(this);return n.idToken=e,Rs(t,Ds,n)},vo.prototype.f=function(t,e){var n=wo(this);return n.operation="REAUTH",Qi(t=Rs(t,ks,n),e)},vo.prototype.A=function(){var t={providerId:"phone"};return this.a.Va&&(t.verificationId=this.a.Va),this.a.Ua&&(t.verificationCode=this.a.Ua),this.a.Ha&&(t.temporaryProof=this.a.Ha),this.a.ba&&(t.phoneNumber=this.a.ba),t},To.prototype.Wa=function(t,e){var n=this.a.b;return Zt(e.verify()).then(function(r){if(!c(r))throw new ti("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return function(t,e){return Rs(t,bs,e)}(n,{phoneNumber:t,recaptchaToken:r}).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new ti("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},jr(To,{PROVIDER_ID:"phone"}),jr(To,{PHONE_SIGN_IN_METHOD:"phone"}),_o.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},_o.prototype.R=function(){return this.h},_o.prototype.A=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.A()}};var No,Do=null;function ko(t){var e="unauthorized-domain",n=void 0,r=An(t);t=r.b,"chrome-extension"==(r=r.f)?n=Ft("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Ft("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",ti.call(this,e,n)}function Ro(t,e,n){ti.call(this,t,n),(t=e||{}).Ab&&qr(this,"email",t.Ab),t.ba&&qr(this,"phoneNumber",t.ba),t.credential&&qr(this,"credential",t.credential),t.Qb&&qr(this,"tenantId",t.Qb)}function Oo(t){if(t.code){var e=t.code||"";0==e.indexOf(ni)&&(e=e.substring(ni.length));var n={credential:So(t),Qb:t.tenantId};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.ba=t.phoneNumber;else if(!n.credential)return new ti(e,t.message||void 0);return new Ro(e,n,t.message)}return null}function Po(){}function Lo(t){return t.c||(t.c=t.b())}function Mo(){}function xo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Uo(){}function Fo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=I(this.fc,this),this.a.onerror=I(this.Ib,this),this.a.onprogress=I(this.gc,this),this.a.ontimeout=I(this.kc,this)}function Vo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Bo(t,e,n){this.reset(t,e,n,void 0,void 0)}C(ko,ti),C(Ro,ti),Ro.prototype.A=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.A();return e&&$(t,e),t},Ro.prototype.toJSON=function(){return this.A()},Po.prototype.c=null,C(Mo,Po),Mo.prototype.a=function(){var t=xo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Mo.prototype.b=function(){var t={};return xo(this)&&(t[0]=!0,t[1]=!0),t},No=new Mo,C(Uo,Po),Uo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Fo;throw Error("Unsupported browser")},Uo.prototype.b=function(){return{}},(e=Fo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},e.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},e.fc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Vo(this,4)},e.Ib=function(){this.status=500,this.response=this.responseText="",Vo(this,4)},e.kc=function(){this.Ib()},e.gc=function(){this.status=200,Vo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Bo.prototype.a=null;function qo(t){this.f=t,this.b=this.c=this.a=null}function jo(t,e){this.name=t,this.value=e}Bo.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||A(),delete this.a},jo.prototype.toString=function(){return this.name};var Go=new jo("SEVERE",1e3),Wo=new jo("WARNING",900),Ko=new jo("CONFIG",700),Ho=new jo("FINE",500);qo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(R("Root logger has no level set."),null)}(this).value)for(v(e)&&(e=e()),t=new Bo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var zo={},Qo=null;function Yo(t){var e;if(Qo||(Qo=new qo(""),zo[""]=Qo,Qo.c=Ko),!(e=zo[t])){e=new qo(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=Yo(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,zo[t]=e}return e}function Xo(t,e){t&&t.log(Ho,e,void 0)}function Jo(t){this.f=t}function $o(t){un.call(this),this.o=t,this.readyState=Zo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=Yo("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}C(Jo,Po),Jo.prototype.a=function(){return new $o(this.f)},Jo.prototype.b=function(t){return function(){return t}}({}),C($o,un);var Zo=0;function ta(t){t.c.read().then(t.ec.bind(t)).catch(t.Oa.bind(t))}function ea(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,na(t)}function na(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ra(t){un.call(this),this.headers=new yn,this.B=t||null,this.c=!1,this.w=this.a=null,this.h=this.O=this.l="",this.f=this.J=this.i=this.I=!1,this.g=0,this.o=null,this.m=ia,this.v=this.P=!1}(e=$o.prototype).open=function(t,e){if(this.readyState!=Zo)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,na(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.jc.bind(this),this.Oa.bind(this))},e.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ea(this,!1)),this.readyState=Zo},e.jc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,na(this)),this.a&&(this.readyState=3,na(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.hc.bind(this),this.Oa.bind(this)):void 0!==u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,ta(this)):t.text().then(this.ic.bind(this),this.Oa.bind(this)))))},e.ec=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?ea(this,!0):na(this),3==this.readyState&&ta(this)}},e.ic=function(t){this.a&&(this.response=this.responseText=t,ea(this,!0))},e.hc=function(t){this.a&&(this.response=t,ea(this,!0))},e.Oa=function(t){var e=this.h;e&&e.log(Wo,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&ea(this,!0)},e.setRequestHeader=function(t,e){this.i.append(t,e)},e.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(Wo,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Wo,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},C(ra,un);var ia="";ra.prototype.b=Yo("goog.net.XhrIo");var oa=/^https?$/i,aa=["POST","PUT"];function sa(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.O=n,t.I=!1,t.c=!0,t.a=t.B?t.B.a():No.a(),t.w=t.B?Lo(t.B):Lo(No),t.a.onreadystatechange=I(t.Lb,t);try{Xo(t.b,ya(t,"Opening Xhr")),t.J=!0,t.a.open(n,String(e),!0),t.J=!1}catch(a){return Xo(t.b,ya(t,"Error opening Xhr: "+a.message)),void ca(t,a)}e=r||"";var o=new yn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(g(t)||c(t))B(t,e,void 0);else for(var n=mn(t),r=dn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=ua,n=t.length,r=c(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:c(t)?t.charAt(e):t[e]}(o.X()),r=u.FormData&&e instanceof u.FormData,!G(aa,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.P&&(t.a.withCredentials=t.P);try{pa(t),0<t.g&&(t.v=function(t){return Te&&Oe(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),Xo(t.b,ya(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=I(t.Ia,t)):t.o=fn(t.Ia,t.g,t)),Xo(t.b,ya(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(a){Xo(t.b,ya(t,"Send error: "+a.message)),ca(t,a)}}function ua(t){return"content-type"==t.toLowerCase()}function ca(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ha(t),fa(t)}function ha(t){t.I||(t.I=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function la(t){if(t.c&&void 0!==s)if(t.w[1]&&4==da(t)&&2==ma(t))Xo(t.b,ya(t,"Local request error detected and ignored"));else if(t.i&&4==da(t))fn(t.Lb,0,t);else if(t.dispatchEvent("readystatechange"),4==da(t)){Xo(t.b,ya(t,"Request complete")),t.c=!1;try{var e,n=ma(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(bn)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!oa.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<da(t)?t.a.statusText:""}catch(h){Xo(t.b,"Can not get status: "+h.message),c=""}t.h=c+" ["+ma(t)+"]",ha(t)}}finally{fa(t)}}}function fa(t,e){if(t.a){pa(t);var n=t.a,r=t.w[0]?p:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(Go,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function pa(t){t.a&&t.v&&(t.a.ontimeout=null),t.o&&(u.clearTimeout(t.o),t.o=null)}function da(t){return t.a?t.a.readyState:0}function ma(t){try{return 2<da(t)?t.a.status:-1}catch(e){return-1}}function ya(t,e){return e+" ["+t.O+" "+t.l+" "+ma(t)+"]"}function ga(t){var e=Na;this.g=[],this.v=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function va(t,e,n){t.a=!0,t.c=n,t.f=!e,Ea(t)}function ba(t){if(t.a){if(!t.u)throw new Sa(t);t.u=!1}}function wa(t,e,n,r){t.g.push([e,n,r]),t.a&&Ea(t)}function Ta(t){return j(t.g,function(t){return v(t[1])})}function Ea(t){if(t.h&&t.a&&Ta(t)){var e=t.h,n=Aa[e];n&&(u.clearTimeout(n.a),delete Aa[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.o,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(N(e)||"function"==typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,Ta(t)||(n=!0)}}t.c=e,r&&(s=I(t.m,t,!0),r=I(t.m,t,!1),e instanceof ga?(wa(e,s,r),e.w=!0):e.then(s,r)),n&&(e=new _a(e),Aa[e.a]=e,t.h=e.a)}function Sa(){D.call(this)}function Ia(){D.call(this)}function _a(t){this.a=u.setTimeout(I(this.c,this),0),this.b=t}(e=ra.prototype).Ia=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Xo(this.b,ya(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(Xo(this.b,ya(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),fa(this))},e.za=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),fa(this,!0)),ra.qb.za.call(this)},e.Lb=function(){this.va||(this.J||this.i||this.f?la(this):this.yc())},e.yc=function(){la(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ia:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Go,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return Xo(this.b,"Can not get response: "+e.message),null}},ga.prototype.cancel=function(t){if(this.a)this.c instanceof ga&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.o,this):this.u=!0,this.a||(t=new Ia(this),ba(this),va(this,!1,t))}},ga.prototype.m=function(t,e){this.i=!1,va(this,t,e)},ga.prototype.then=function(t,e,n){var r,i,o=new Ht(function(t,e){r=t,i=e});return wa(this,r,function(t){t instanceof Ia?o.cancel():i(t)}),o.then(t,e,n)},ga.prototype.$goog_Thenable=!0,C(Sa,D),Sa.prototype.message="Deferred has already fired",Sa.prototype.name="AlreadyCalledError",C(Ia,D),Ia.prototype.message="Deferred was canceled",Ia.prototype.name="CanceledError",_a.prototype.c=function(){throw delete Aa[this.a],this.b};var Aa={};function Ca(t){var e={},n=e.document||document,r=ot(t).toString(),i=document.createElement("SCRIPT"),o={Nb:i,Ia:void 0},a=new ga(o),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout(function(){Da(i,!0);var t=new Oa(Ra,"Timeout reached for loading script "+r);ba(a),va(a,!1,t)},c),o.Ia=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Da(i,e.gd||!1,s),ba(a),va(a,!0,null))},i.onerror=function(){Da(i,!0,s);var t=new Oa(ka,"Error while loading script "+r);ba(a),va(a,!1,t)},$(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),Hn(i,o),function(t,e){F(t,"HTMLScriptElement"),t.src=ot(e),null===f&&(f=(e=(e=u.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&l.test(e)?e:""),(e=f)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function Na(){if(this&&this.Nb){var t=this.Nb;t&&"SCRIPT"==t.tagName&&Da(t,!0,this.Ia)}}function Da(t,e,n){null!=n&&u.clearTimeout(n),t.onload=p,t.onerror=p,t.onreadystatechange=p,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var ka=0,Ra=1;function Oa(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),D.call(this,n),this.code=t}function Pa(t){this.f=t}function La(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.u=t.secureTokenTimeout||Ua,this.g=X(t.secureTokenHeaders||Fa),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.firebaseTimeout||Va,this.a=X(t.firebaseHeaders||Ba),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==pr(),!(n=u.XMLHttpRequest||n&&r.a.INTERNAL.node&&r.a.INTERNAL.node.XMLHttpRequest)&&!fr())throw new ti("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,fr()?this.f=new Jo(self):dr()?this.f=new Pa(n):this.f=new Uo,this.b=null}C(Oa,D),C(Pa,Po),Pa.prototype.a=function(){return new this.f},Pa.prototype.b=function(){return{}};var Ma,xa="idToken",Ua=new Pr(3e4,6e4),Fa={"Content-Type":"application/x-www-form-urlencoded"},Va=new Pr(3e4,6e4),Ba={"Content-Type":"application/json"};function qa(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function ja(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function Ga(t,e,n,r,i,o,a){(function(){var t=wr();return!((t=gr(t)!=yr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Te&&ke&&!(9<ke))})()||fr()?t=I(t.o,t):(Ma||(Ma=new Ht(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{u[Ka]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=at(Wa,{onload:Ka});!function(t,e){wa(t,null,e,void 0)}(Ca(n),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=I(t.m,t)),t(e,n,r,i,o,a)}La.prototype.R=function(){return this.b},La.prototype.o=function(t,e,n,r,i,o){if(fr()&&(void 0===u.fetch||void 0===u.Headers||void 0===u.Request))throw new ti("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new ra(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout(function(){a.dispatchEvent("timeout")},o)}cn(a,"complete",function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Xo(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)}),hn(a,"ready",function(){s&&clearTimeout(s),ye(this)}),hn(a,"timeout",function(){s&&clearTimeout(s),ye(this),e&&e(null)}),sa(a,t,n,r,i)};var Wa=new Z(nt,"https://apis.google.com/js/client.js?onload=%{onload}"),Ka="__fcb"+Math.floor(1e6*Math.random()).toString();function Ha(t){if(!c(t=t.email)||!ur.test(t))throw new ti("invalid-email")}function za(t){"email"in t&&Ha(t)}function Qa(t){if(!t[xa])throw new ti("internal-error")}function Ya(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new ti("internal-error")}else{if(!t.sessionInfo)throw new ti("missing-verification-id");if(!t.code)throw new ti("missing-verification-code")}}La.prototype.m=function(t,e,n,r,i){var o=this;Ma.then(function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},La.prototype.ob=function(){return Rs(this,Es,{})},La.prototype.rb=function(t,e){return Rs(this,ws,{idToken:t,email:e})},La.prototype.sb=function(t,e){return Rs(this,Ts,{idToken:t,password:e})};var Xa={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Ja(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new ti("internal-error")}function $a(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(Bn(t=new xn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Za(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Oo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Oo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Oo(t)):t.errorMessage&&(e=Os(t.errorMessage)),e)throw e;if(!t[xa])throw new ti("internal-error")}function ts(t,e){return e.returnIdpCredential=!0,Rs(t,Ss,e)}function es(t,e){return e.returnIdpCredential=!0,Rs(t,_s,e)}function ns(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Rs(t,Is,e)}function rs(t){if(!t.oobCode)throw new ti("invalid-action-code")}(e=La.prototype).tb=function(t,e){var n={idToken:t},r=[];return Q(Xa,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Rs(this,ws,n)},e.kb=function(t,e){return $(t={requestType:"PASSWORD_RESET",email:t},e),Rs(this,ms,t)},e.lb=function(t,e){return $(t={requestType:"EMAIL_SIGNIN",email:t},e),Rs(this,ps,t)},e.jb=function(t,e){return $(t={requestType:"VERIFY_EMAIL",idToken:t},e),Rs(this,ds,t)},e.Wa=function(t){return Rs(this,Ns,t)},e.ab=function(t,e){return Rs(this,vs,{oobCode:t,newPassword:e})},e.Ma=function(t){return Rs(this,os,{oobCode:t})},e.Ya=function(t){return Rs(this,is,{oobCode:t})};var is={endpoint:"setAccountInfo",D:rs,fa:"email",F:!0},os={endpoint:"resetPassword",D:rs,K:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new ti("internal-error")},F:!0},as={endpoint:"signupNewUser",D:function(t){if(Ha(t),!t.password)throw new ti("weak-password")},K:Qa,T:!0,F:!0},ss={endpoint:"createAuthUri",F:!0},us={endpoint:"deleteAccount",V:["idToken"]},cs={endpoint:"setAccountInfo",V:["idToken","deleteProvider"],D:function(t){if(!y(t.deleteProvider))throw new ti("internal-error")}},hs={endpoint:"emailLinkSignin",V:["email","oobCode"],D:Ha,K:Qa,T:!0,F:!0},ls={endpoint:"emailLinkSignin",V:["idToken","email","oobCode"],D:Ha,K:Qa,T:!0},fs={endpoint:"getAccountInfo"},ps={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new ti("internal-error");Ha(t)},fa:"email",F:!0},ds={endpoint:"getOobConfirmationCode",V:["idToken","requestType"],D:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new ti("internal-error")},fa:"email",F:!0},ms={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("PASSWORD_RESET"!=t.requestType)throw new ti("internal-error");Ha(t)},fa:"email",F:!0},ys={wb:!0,endpoint:"getProjectConfig",Kb:"GET"},gs={wb:!0,endpoint:"getRecaptchaParam",Kb:"GET",K:function(t){if(!t.recaptchaSiteKey)throw new ti("internal-error")}},vs={endpoint:"resetPassword",D:rs,fa:"email",F:!0},bs={endpoint:"sendVerificationCode",V:["phoneNumber","recaptchaToken"],fa:"sessionInfo",F:!0},ws={endpoint:"setAccountInfo",V:["idToken"],D:za,T:!0},Ts={endpoint:"setAccountInfo",V:["idToken"],D:function(t){if(za(t),!t.password)throw new ti("weak-password")},K:Qa,T:!0},Es={endpoint:"signupNewUser",K:Qa,T:!0,F:!0},Ss={endpoint:"verifyAssertion",D:Ja,Ra:$a,K:Za,T:!0,F:!0},Is={endpoint:"verifyAssertion",D:Ja,Ra:$a,K:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new ti("user-not-found");if(t.errorMessage)throw Os(t.errorMessage);if(!t[xa])throw new ti("internal-error")},T:!0,F:!0},_s={endpoint:"verifyAssertion",D:function(t){if(Ja(t),!t.idToken)throw new ti("internal-error")},Ra:$a,K:Za,T:!0},As={endpoint:"verifyCustomToken",D:function(t){if(!t.token)throw new ti("invalid-custom-token")},K:Qa,T:!0,F:!0},Cs={endpoint:"verifyPassword",D:function(t){if(Ha(t),!t.password)throw new ti("wrong-password")},K:Qa,T:!0,F:!0},Ns={endpoint:"verifyPhoneNumber",D:Ya,K:Qa,F:!0},Ds={endpoint:"verifyPhoneNumber",D:function(t){if(!t.idToken)throw new ti("internal-error");Ya(t)},K:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Oo(t);Qa(t)}},ks={Yb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:Ya,K:Qa,F:!0};function Rs(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.V))return te(new ti("internal-error"));var r,i=e.Kb||"POST";return Zt(n).then(e.D).then(function(){return e.T&&(n.returnSecureToken=!0),e.F&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o){var a=An(t.h+e);In(a,"key",t.c),o&&In(a,"cb",A().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&In(a,u,r[u]);return new Ht(function(e,o){Ga(t,a.toString(),function(t){t?t.error?o(Ps(t,i||{})):e(t):o(new ti("network-request-failed"))},n,s?void 0:Xn(Nr(r)),t.a,t.i.get())})}(t,e.endpoint,i,n,e.Yb,e.wb||!1)}).then(function(t){return r=t,e.Ra?e.Ra(n,r):r}).then(e.K).then(function(){if(!e.fa)return r;if(!(e.fa in r))throw new ti("internal-error");return r[e.fa]})}function Os(t){return Ps({error:{errors:[{message:t}],code:400,message:t}})}function Ps(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new ti(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",$(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new ti(r[i],e);return!e&&t&&(e=Cr(t)),new ti("internal-error",e)}function Ls(t){this.b=t,this.a=null,this.gb=function(t){return(Fs||(Fs=new Ht(function(t,e){function n(){Or(),Tr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Or(),e(Error("Network Error"))},timeout:xs.get()})}if(Tr("gapi.iframes.Iframe"))t();else if(Tr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){Tr("gapi.load")?n():e(Error("Network Error"))},Zt(Ca(r=at(Ms,{onload:r}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw Fs=null,t}))).then(function(){return new Ht(function(e,n){Tr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Tr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},Us.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}(this)}var Ms=new Z(nt,"https://apis.google.com/js/api.js?onload=%{onload}"),xs=new Pr(3e4,6e4),Us=new Pr(5e3,15e3),Fs=null;function Vs(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Cn(this.i,"/__/auth/iframe"),In(this.a,"apiKey",this.g),In(this.a,"appName",this.h),this.b=null,this.c=[]}function Bs(t,e,n,r,i){this.o=t,this.m=e,this.c=n,this.u=r,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function qs(t){try{return r.a.app(t).auth().Ca()}catch(e){return[]}}function js(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function Gs(t){var e=nr();return function(t){return Rs(t,ys,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=An(e),r=n.f;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=An(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:sr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new ko(nr())})}function Ws(t){return t.l?t.l:(t.l=cr().then(function(){if(!t.o){var e=t.c,n=t.h,r=qs(t.b),i=new Vs(t.u,t.f,t.b);i.f=e,i.b=n,i.c=z(r||[]),t.o=i.toString()}t.i=new Ls(t.o),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.gb.then(function(){t.a.register("authEvent",e,Tr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Ao(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Zt(n)}return n.status="ERROR",Zt(n)})}(t)}),t.l)}function Ks(t){return t.m||(t.v=t.c?br(t.c,qs(t.b)):null,t.m=new La(t.f,Oi(t.h),t.v)),t.m}function Hs(t,e,n,r,i,o,a,s,u,c,h){return(t=new Bs(t,e,n,r,i)).l=o,t.g=a,t.i=s,t.b=X(u||null),t.f=c,t.nb(h).toString()}function zs(t){if(this.a=t||r.a.INTERNAL.reactNative&&r.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new ti("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Qs(t){this.b=t,this.a={},this.f=I(this.c,this)}Vs.prototype.toString=function(){return this.f?In(this.a,"v",this.f):Vn(this.a.a,"v"),this.b?In(this.a,"eid",this.b):Vn(this.a.a,"eid"),this.c.length?In(this.a,"fw",this.c.join(",")):Vn(this.a.a,"fw"),this.a.toString()},Bs.prototype.nb=function(t){return this.h=t,this},Bs.prototype.toString=function(){var t=Cn(this.o,"/__/auth/handler");if(In(t,"apiKey",this.m),In(t,"appName",this.c),In(t,"authType",this.u),this.a.isOAuthProvider){var e=this.a;try{var n=r.a.app(this.c).auth().ha()}catch(u){n=null}for(var i in e.bb=n,In(t,"providerId",this.a.providerId),n=Nr((e=this.a).zb))n[i]=n[i].toString();i=e.Fc,n=X(n);for(var o=0;o<i.length;o++){var a=i[o];a in n&&delete n[a]}e.eb&&e.bb&&!n[e.eb]&&(n[e.eb]=e.bb),Y(n)||In(t,"customParameters",Cr(n))}if("function"==typeof this.a.Hb&&((e=this.a.Hb()).length&&In(t,"scopes",e.join(","))),this.l?In(t,"redirectUrl",this.l):Vn(t.a,"redirectUrl"),this.g?In(t,"eventId",this.g):Vn(t.a,"eventId"),this.i?In(t,"v",this.i):Vn(t.a,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!_n(t,s)&&In(t,s,this.b[s]);return this.h?In(t,"tid",this.h):Vn(t.a,"tid"),this.f?In(t,"eid",this.f):Vn(t.a,"eid"),(s=qs(this.c)).length&&In(t,"fw",s.join(",")),t.toString()},(e=js.prototype).Fb=function(t,e,n){var r=new ti("popup-closed-by-user"),i=new ti("web-storage-unsupported"),o=this,a=!1;return this.ia().then(function(){(function(t){var e={type:"webStorageSupport"};return Ws(t).then(function(){return function(t,e){return t.gb.then(function(){return new Ht(function(n){t.a.send(e.type,e,n,Tr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&or(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return function(t){return new Ht(function(e){return function n(){pn(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return pn(n).then(function(){e(r)})})},e.Ob=function(){var t=wr();return!Ar(t)&&!Rr(t)},e.Jb=function(){return!1},e.Db=function(t,e,n,r,i,o,a,s){if(!t)return te(new ti("popup-blocked"));if(a&&!Ar())return this.ia().s(function(e){or(t),i(e)}),r(),Zt();this.a||(this.a=Gs(Ks(this)));var u=this;return this.a.then(function(){var e=u.ia().s(function(e){throw or(t),i(e),e});return r(),e}).then(function(){(Io(n),a)||rr(Hs(u.u,u.f,u.b,e,n,null,o,u.c,void 0,u.h,s),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t})},e.Eb=function(t,e,n,r){this.a||(this.a=Gs(Ks(this)));var i=this;return this.a.then(function(){Io(e),rr(Hs(i.u,i.f,i.b,t,e,nr(),n,i.c,void 0,i.h,r))}).s(function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t})},e.ia=function(){var t=this;return Ws(this).then(function(){return t.i.gb}).s(function(){throw t.a=null,new ti("network-request-failed")})},e.Rb=function(){return!0},e.Aa=function(t){this.g.push(t)},e.Na=function(t){K(this.g,function(e){return e==t})},(e=zs.prototype).get=function(t){return Zt(this.a.getItem(t)).then(function(t){return t&&Dr(t)})},e.set=function(t,e){return Zt(this.a.setItem(t,Cr(e)))},e.S=function(t){return Zt(this.a.removeItem(t))},e.$=function(){},e.ea=function(){};var Ys,Xs=[];function Js(t,e,n){Y(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function $s(t){this.a=t}function Zs(t){this.c=t,this.b=!1,this.a=[]}function tu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return te(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Ht(function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout(function(){r(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))}).then(function(e){return eu(t,c),e}).s(function(e){throw eu(t,c),e})}function eu(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),K(t.a,function(t){return t==e})}}function nu(){if(!ou())throw new ti("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=u.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;fr()&&self?(this.l=function(){var t=fr()?self:null;if(B(Xs,function(n){n.b==t&&(e=n)}),!e){var e=new Qs(t);Xs.push(e)}return e}(),Js(this.l,"keyChanged",function(e,n){return hu(t).then(function(e){return 0<e.length&&B(t.a,function(t){t(e)}),{keyProcessed:G(e,n.key)}})}),Js(this.l,"ping",function(){return Zt(["keyChanged"])})):function(){var t=u.navigator;return t&&t.serviceWorker?Zt().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):Zt(null)}().then(function(e){(t.h=e)&&(t.g=new Zs(new $s(e)),tu(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&G(e[0].value,"keyChanged")&&(t.o=!0)}).s(function(){}))})}function ru(t){return new Ht(function(e,n){var r=t.u.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Ht(function(e,n){var r=t.u.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}})}(t).then(function(){return ru(t)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function iu(t){return t.m||(t.m=ru(t)),t.m}function ou(){try{return!!u.indexedDB}catch(be){return!1}}function au(t){return t.objectStore("firebaseLocalStorage")}function su(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function uu(t){return new Ht(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function cu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?tu(t.g,"keyChanged",{key:e},t.o).then(function(){}).s(function(){}):Zt()}function hu(t){return iu(t).then(function(t){var e=au(su(t,!1));return e.getAll?uu(e.getAll()):new Ht(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r})}function lu(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function fu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Zt().then(function(){if(ou()){var t=kr(),r="__sak"+t;return Ys||(Ys=new nu),(n=Ys).set(r,t).then(function(){return n.get(r)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.S(r)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.$(function(t){B(e.a,function(e){e(t)})}),t})}function pu(){this.a={},this.type="inMemory"}function du(){if(!function(){var t="Node"==pr();if(!(t=mu()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==pr())throw new ti("internal-error","The LocalStorage compatibility library was not found.");throw new ti("web-storage-unsupported")}this.a=mu()||r.a.INTERNAL.node.localStorage,this.type="localStorage"}function mu(){try{var t=u.localStorage,e=kr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function yu(){this.type="nullStorage"}function gu(){if(!function(){var t="Node"==pr();if(!(t=vu()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==pr())throw new ti("internal-error","The SessionStorage compatibility library was not found.");throw new ti("web-storage-unsupported")}this.a=vu()||r.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function vu(){try{var t=u.sessionStorage,e=kr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function bu(){var t={};t.Browser=Eu,t.Node=Su,t.ReactNative=Iu,t.Worker=_u,this.a=t[pr()]}Qs.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];B(r,function(e){i.push(Zt().then(function(){return e(t.origin,t.data.data)}))}),ne(i).then(function(r){var i=[];B(r,function(t){i.push({fulfilled:t.Gb,value:t.value,reason:t.reason?t.reason.message:void 0})}),B(i,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})})}},$s.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Zs.prototype.close=function(){for(;0<this.a.length;)eu(this,this.a[0]);this.b=!0},(e=nu.prototype).set=function(t,e){var n,r=!1,i=this;return iu(this).then(function(e){return uu((e=au(su(n=e,!0))).get(t))}).then(function(o){var a=au(su(n,!0));return o?(o.value=e,uu(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,uu(a.add(o)))}).then(function(){return i.c[t]=e,cu(i,t)}).ka(function(){r&&i.b--})},e.get=function(t){return iu(this).then(function(e){return uu(au(su(e,!1)).get(t))}).then(function(t){return t&&t.value})},e.S=function(t){var e=!1,n=this;return iu(this).then(function(r){return e=!0,n.b++,uu(au(su(r,!0)).delete(t))}).then(function(){return delete n.c[t],cu(n,t)}).ka(function(){e&&n.b--})},e.$=function(t){0==this.a.length&&function(t){lu(t),function e(){t.f=setTimeout(function(){t.i=hu(t).then(function(e){0<e.length&&B(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},e.ea=function(t){K(this.a,function(e){return e==t}),0==this.a.length&&lu(this)},(e=fu.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},e.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},e.S=function(t){return this.b.then(function(e){return e.S(t)})},e.$=function(t){this.a.push(t)},e.ea=function(t){K(this.a,function(e){return e==t})},(e=pu.prototype).get=function(t){return Zt(this.a[t])},e.set=function(t,e){return this.a[t]=e,Zt()},e.S=function(t){return delete this.a[t],Zt()},e.$=function(){},e.ea=function(){},(e=du.prototype).get=function(t){var e=this;return Zt().then(function(){return Dr(e.a.getItem(t))})},e.set=function(t,e){var n=this;return Zt().then(function(){var r=Cr(e);null===r?n.S(t):n.a.setItem(t,r)})},e.S=function(t){var e=this;return Zt().then(function(){e.a.removeItem(t)})},e.$=function(t){u.window&&Ye(u.window,"storage",t)},e.ea=function(t){u.window&&$e(u.window,"storage",t)},(e=yu.prototype).get=function(){return Zt(null)},e.set=function(){return Zt()},e.S=function(){return Zt()},e.$=function(){},e.ea=function(){},(e=gu.prototype).get=function(t){var e=this;return Zt().then(function(){return Dr(e.a.getItem(t))})},e.set=function(t,e){var n=this;return Zt().then(function(){var r=Cr(e);null===r?n.S(t):n.a.setItem(t,r)})},e.S=function(t){var e=this;return Zt().then(function(){e.a.removeItem(t)})},e.$=function(){},e.ea=function(){};var wu,Tu,Eu={C:du,Ta:gu},Su={C:du,Ta:gu},Iu={C:zs,Ta:yu},_u={C:du,Ta:yu},Au={ad:"local",NONE:"none",cd:"session"};function Cu(){var t=!(Rr(wr())||!lr()),e=Ar(),n=Er();this.m=t,this.h=e,this.l=n,this.a={},wu||(wu=new bu),t=wu;try{this.g=!er()&&xr()||!u.indexedDB?new t.a.C:new fu(fr()?new pu:new t.a.C)}catch(r){this.g=new pu,this.h=!0}try{this.i=new t.a.Ta}catch(r){this.i=new pu}this.u=new pu,this.f=I(this.Pb,this),this.b={}}function Nu(){return Tu||(Tu=new Cu),Tu}function Du(t,e){switch(e){case"session":return t.i;case"none":return t.u;default:return t.g}}function ku(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Ru(t,e,n){return n=ku(e,n),"local"==e.C&&(t.b[n]=null),Du(t,e.C).S(n)}function Ou(t){t.c&&(clearInterval(t.c),t.c=null)}function Pu(t){this.a=t,this.b=Nu()}(e=Cu.prototype).get=function(t,e){return Du(this,t.C).get(ku(t,e))},e.set=function(t,e,n){var r=ku(t,n),i=this,o=Du(this,t.C);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.C&&(i.b[r]=e)})},e.addListener=function(t,e,n){t=ku(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),Y(this.a)&&(Du(this,"local").$(this.f),this.h||(er()||!xr())&&u.indexedDB||!this.l||function(t){Ou(t),t.c=setInterval(function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Fe({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Pb(n))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},e.removeListener=function(t,e,n){t=ku(t,e),this.a[t]&&(K(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),Y(this.a)&&(Du(this,"local").ea(this.f),Ou(this))},e.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.$a(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Du(this,"local").ea(this.f):Ou(this),this.m)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.$a(e))},Te&&ke&&10==ke&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else B(t,I(this.$a,this))},e.$a=function(t){this.a[t]&&B(this.a[t],function(t){t()})};var Lu,Mu={name:"authEvent",C:"local"};function xu(){this.a=Nu()}function Uu(t,e){this.b=Fu,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0!==Lu||(Lu=u.Int32Array?new Int32Array(Ku):Ku),this.reset()}C(Uu,function(){this.b=-1});for(var Fu=64,Vu=Fu-1,Bu=[],qu=0;qu<Vu;qu++)Bu[qu]=0;var ju=H(128,Bu);function Gu(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|Lu[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Wu(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(c(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Gu(t),i=0);else{if(!g(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(Gu(t),i=0)}}t.c=i,t.g+=n}Uu.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):z(this.h)};var Ku=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Hu(){Uu.call(this,8,zu)}C(Hu,Uu);var zu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Qu(t,e,n,r,i){this.u=t,this.i=e,this.l=n,this.m=r||null,this.o=i||null,this.h=e+":"+n,this.v=new xu,this.g=new Pu(this.h),this.f=null,this.b=[],this.a=this.c=null}function Yu(t){return new ti("invalid-cordova-configuration",t)}function Xu(t){var e=new Hu;Wu(e,t),t=[];var n=8*e.g;56>e.c?Wu(e,ju,56-e.c):Wu(e,ju,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Gu(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return q(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function Ju(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function $u(t){return t.f||(t.f=t.ia().then(function(){return new Ht(function(e){t.Aa(function n(r){return e(r),t.Na(n),!1}),function(t){function e(e){r=!0,i&&i.cancel(),Zu(t).then(function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=Hi(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Dr(_n(o=An(i),"firebaseError")||null))?ei(o):null)?new _o(r.c,r.b,null,null,o,null,r.R()):new _o(r.c,r.b,i,r.f,null,null,r.R())),i=o||n}Ju(t,i)})}var n=new _o("unknown",null,null,null,new ti("no-auth-event")),r=!1,i=pn(500).then(function(){return Zu(t).then(function(){r||Ju(t,n)})}),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Tr("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(n){console.error(n)}},Do||(Do=new Co),function(t){var e=Do;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Tr("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)})})),t.f}function Zu(t){var e=null;return function(t){return t.b.get(Mu,t.a).then(function(t){return Ao(t)})}(t.g).then(function(n){return e=n,Ru((n=t.g).b,Mu,n.a)}).then(function(){return e})}function tc(t){this.a=t,this.b=Nu()}(e=Qu.prototype).ia=function(){return this.Da?this.Da:this.Da=(hr(void 0)?cr().then(function(){return new Ht(function(t,e){var n=u.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):te(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof Tr("universalLinks.subscribe",u))throw Yu("cordova-universal-links-plugin-fix is not installed");if(void 0===Tr("BuildInfo.packageName",u))throw Yu("cordova-plugin-buildinfo is not installed");if("function"!=typeof Tr("cordova.plugins.browsertab.openUrl",u))throw Yu("cordova-plugin-browsertab is not installed");if("function"!=typeof Tr("cordova.InAppBrowser.open",u))throw Yu("cordova-plugin-inappbrowser is not installed")},function(){throw new ti("cordova-not-ready")})},e.Fb=function(t,e){return e(new ti("operation-not-supported-in-this-environment")),Zt()},e.Db=function(){return te(new ti("operation-not-supported-in-this-environment"))},e.Rb=function(){return!1},e.Ob=function(){return!0},e.Jb=function(){return!0},e.Eb=function(t,e,n,r){if(this.c)return te(new ti("redirect-operation-pending"));var i=this,o=u.document,a=null,s=null,c=null,h=null;return this.c=Zt().then(function(){return Io(e),$u(i)}).then(function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new _o(e,r,null,o,new ti("no-auth-event"),null,i),s=Tr("BuildInfo.packageName",u);if("string"!=typeof s)throw new ti("invalid-cordova-configuration");var c=Tr("BuildInfo.displayName",u),h={};if(wr().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=s;else{if(!wr().toLowerCase().match(/android/))return te(new ti("operation-not-supported-in-this-environment"));h.apn=s}c&&(h.appDisplayName=c),o=Xu(o),h.sessionId=o;var l=Hs(t.u,t.i,t.l,e,n,null,r,t.m,h,t.o,i);return t.ia().then(function(){var e=t.h;return t.v.a.set(Mu,a.A(),e)}).then(function(){var e=Tr("cordova.plugins.browsertab.isAvailable",u);if("function"!=typeof e)throw new ti("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=Tr("cordova.plugins.browsertab.openUrl",u)))throw new ti("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=Tr("cordova.InAppBrowser.open",u)))throw new ti("invalid-cordova-configuration");e=wr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(i,t,e,n,r)}).then(function(){return new Ht(function(t,e){s=function(){var e=Tr("cordova.plugins.browsertab.close",u);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Aa(s),c=function(){a||(a=pn(2e3).then(function(){e(new ti("redirect-cancelled-by-user"))}))},h=function(){Lr()&&c()},o.addEventListener("resume",c,!1),wr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)}).s(function(t){return Zu(i).then(function(){throw t})})}).ka(function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),a&&a.cancel(),s&&i.Na(s),i.c=null})},e.Aa=function(t){this.b.push(t),$u(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new _o("unknown",null,null,null,new ti("no-auth-event")),t(e))})},e.Na=function(t){K(this.b,function(e){return e==t})};var ec={name:"pendingRedirect",C:"session"};function nc(t){return Ru(t.b,ec,t.a)}function rc(t,e,n){this.i={},this.v=0,this.B=t,this.u=e,this.m=n,this.h=[],this.f=!1,this.l=I(this.o,this),this.b=new gc,this.w=new Ec,this.g=new tc(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.w,this.c.linkViaPopup=this.w,this.c.reauthViaPopup=this.w,this.a=ic(this.B,this.u,this.m,ki)}function ic(t,e,n,i){var o=r.a.SDK_VERSION||null;return hr()?new Qu(t,e,n,o,i):new js(t,e,n,o,i)}function oc(t){t.f||(t.f=!0,t.a.Aa(t.l));var e=t.a;return t.a.ia().s(function(n){throw t.a==e&&t.reset(),n})}function ac(t){t.a.Ob()&&oc(t).s(function(e){var n=new _o("unknown",null,null,null,new ti("operation-not-supported-in-this-environment"));fc(e)&&t.o(n)}),t.a.Jb()||vc(t.b)}function sc(t,e){G(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(ec,t.a).then(function(t){return"pending"==t})}(t.g).then(function(e){e?nc(t.g).then(function(){oc(t).s(function(e){var n=new _o("unknown",null,null,null,new ti("operation-not-supported-in-this-environment"));fc(e)&&t.o(n)})}):ac(t)}).s(function(){ac(t)})}function uc(t,e){K(t.h,function(t){return t==e})}rc.prototype.reset=function(){this.f=!1,this.a.Na(this.l),this.a=ic(this.B,this.u,this.m),this.i={}},rc.prototype.o=function(t){if(!t)throw new ti("invalid-auth-event");if(6e5<=A()-this.v&&(this.i={},this.v=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.v=A())),e=!0;break}}return vc(this.b),e};var cc=new Pr(2e3,1e4),hc=new Pr(3e4,6e4);function lc(t,e,n,r,i,o,a){return t.a.Db(e,n,r,function(){t.f||(t.f=!0,t.a.Aa(t.l))},function(){t.reset()},i,o,a)}function fc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function pc(t,e,n,r,i){var o;return function(t){return t.b.set(ec,"pending",t.a)}(t.g).then(function(){return t.a.Eb(e,n,r,i).s(function(e){if(fc(e))throw new ti("operation-not-supported-in-this-environment");return o=e,nc(t.g).then(function(){throw o})}).then(function(){return t.a.Rb()?new Ht(function(){}):nc(t.g).then(function(){return t.oa()}).then(function(){}).s(function(){})})})}function dc(t,e,n,r,i){return t.a.Fb(r,function(t){e.ja(n,null,t,i)},cc.get())}rc.prototype.oa=function(){return this.b.oa()};var mc={};function yc(t,e,n){var r=e+":"+n;return mc[r]||(mc[r]=new rc(t,e,n)),mc[r]}function gc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function vc(t){t.g||(t.g=!0,Tc(t,!1,null,null))}function bc(t){t.g&&!t.i&&Tc(t,!1,null,null)}function wc(t,e){if(t.b=function(){return Zt(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Tc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return te(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):wc(t,n):wc(t,{user:null}),t.f=[],t.c=[]}function Ec(){}function Sc(){this.vb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.vb},set:function(t){this.vb=t},enumerable:!1})}function Ic(t,e){this.a=e,qr(this,"verificationId",t)}function _c(t,e,n,r){return new To(t).Wa(e,n).then(function(t){return new Ic(t,r)})}function Ac(t){var e=Di(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new ti("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");jr(this,{token:t,expirationTime:Mr(1e3*e.exp),authTime:Mr(1e3*e.auth_time),issuedAtTime:Mr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function Cc(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Nc(t){this.f=t,this.b=this.a=null,this.c=0}function Dc(t,e){var n=e[xa],r=e.refreshToken;e=kc(e.expiresIn),t.b=n,t.c=e,t.a=r}function kc(t){return A()+1e3*parseInt(t,10)}function Rc(t,e){return function(t,e){return new Ht(function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Ga(t,t.l+"?key="+encodeURIComponent(t.c),function(t){t?t.error?r(Ps(t)):t.access_token&&t.refresh_token?n(t):r(new ti("internal-error")):r(new ti("network-request-failed"))},"POST",Fn(e).toString(),t.g,t.u.get()):r(new ti("internal-error"))})}(t.f,e).then(function(e){return t.b=e.access_token,t.c=kc(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function Oc(t,e){this.a=t||null,this.b=e||null,jr(this,{lastSignInTime:Mr(e||null),creationTime:Mr(t||null)})}function Pc(t,e,n,r,i,o){jr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Lc(t,e){for(var n in Ue.call(this,t),e)this[n]=e[n]}function Mc(t,e,n){this.I=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null,t=r.a.SDK_VERSION?br(r.a.SDK_VERSION):null,this.a=new La(this.l,Oi(ki),t),this.b=new Nc(this.a),jc(this,e[xa]),Dc(this.b,e),qr(this,"refreshToken",this.b.a),Kc(this,n||{}),un.call(this),this.J=!1,this.o&&Sr()&&(this.i=yc(this.o,this.l,this.m)),this.O=[],this.h=null,this.w=function(t){return new Cc(function(){return t.G(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.b.c-A()-3e5;return 0<e?e:0})}(this),this.W=I(this.Ja,this);var i=this;this.ga=null,this.xa=function(t){i.ua(t.g)},this.Z=null,this.P=[],this.wa=function(t){Uc(i,t.c)},this.Y=null}function xc(t,e){t.Z&&$e(t.Z,"languageCodeChanged",t.xa),(t.Z=e)&&Ye(e,"languageCodeChanged",t.xa)}function Uc(t,e){t.P=e,ja(t.a,r.a.SDK_VERSION?br(r.a.SDK_VERSION,t.P):null)}function Fc(t,e){t.Y&&$e(t.Y,"frameworkChanged",t.wa),(t.Y=e)&&Ye(e,"frameworkChanged",t.wa)}function Vc(t){try{return r.a.app(t.m).auth()}catch(e){throw new ti("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Bc(t){t.B||t.w.b||(t.w.start(),$e(t,"tokenChanged",t.W),Ye(t,"tokenChanged",t.W))}function qc(t){$e(t,"tokenChanged",t.W),t.w.stop()}function jc(t,e){t.ma=e,qr(t,"_lat",e)}function Gc(t){for(var e=[],n=0;n<t.O.length;n++)e.push(t.O[n](t));return ne(e).then(function(){return t})}function Wc(t){t.i&&!t.J&&(t.J=!0,sc(t.i,t))}function Kc(t,e){jr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new Oc(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Hc(){}function zc(t){return Zt().then(function(){if(t.B)throw new ti("app-deleted")})}function Qc(t){return q(t.providerData,function(t){return t.providerId})}function Yc(t,e){e&&(Xc(t,e.providerId),t.providerData.push(e))}function Xc(t,e){K(t.providerData,function(t){return t.providerId==e})}function Jc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&qr(t,e,n)}function $c(t,e){t!=e&&(jr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?qr(t,"metadata",function(t){return new Oc(t.a,t.b)}(e.metadata)):qr(t,"metadata",new Oc),B(e.providerData,function(e){Yc(t,e)}),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),qr(t,"refreshToken",t.b.a))}function Zc(t){return t.G().then(function(e){var n=t.isAnonymous;return function(t,e){return Rs(t.a,fs,{idToken:e}).then(I(t.zc,t))}(t,e).then(function(){return n||Jc(t,"isAnonymous",!1),e})})}function th(t,e){e[xa]&&t.ma!=e[xa]&&(Dc(t.b,e),t.dispatchEvent(new Lc("tokenChanged")),jc(t,e[xa]),Jc(t,"refreshToken",t.b.a))}function eh(t,e){return Zc(t).then(function(){if(G(Qc(t),e))return Gc(t).then(function(){throw new ti("provider-already-linked")})})}function nh(t,e,n){return Gr({user:t,credential:So(e),additionalUserInfo:e=Ui(e),operationType:n})}function rh(t,e){return th(t,e),t.reload().then(function(){return t})}function ih(t,e,n,i,o){if(!Sr())return te(new ti("operation-not-supported-in-this-environment"));if(t.h&&!o)return te(t.h);var a=xi(n.providerId),s=kr(t.uid+":::"),u=null;(!Ar()||lr())&&t.o&&n.isOAuthProvider&&(u=Hs(t.o,t.l,t.m,e,n,null,s,r.a.SDK_VERSION||null,null,null,t.tenantId));var c=ar(u,a&&a.sa,a&&a.ra);return i=i().then(function(){if(ah(t),!o)return t.G().then(function(){})}).then(function(){return lc(t.i,c,e,n,s,!!u,t.tenantId)}).then(function(){return new Ht(function(n,r){t.ja(e,null,new ti("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=s,t.c=dc(t.i,t,e,c,s)})}).then(function(t){return c&&or(c),t?Gr(t):null}).s(function(t){throw c&&or(c),t}),sh(t,i,o)}function oh(t,e,n,r,i){if(!Sr())return te(new ti("operation-not-supported-in-this-environment"));if(t.h&&!i)return te(t.h);var o=null,a=kr(t.uid+":::");return r=r().then(function(){if(ah(t),!i)return t.G().then(function(){})}).then(function(){return t.ca=a,Gc(t)}).then(function(e){return t.da&&(e=(e=t.da).b.set(hh,t.A(),e.a)),e}).then(function(){return pc(t.i,e,n,a,t.tenantId)}).s(function(e){if(o=e,t.da)return lh(t.da);throw o}).then(function(){if(o)throw o}),sh(t,r,i)}function ah(t){if(!t.i||!t.J){if(t.i&&!t.J)throw new ti("internal-error");throw new ti("auth-domain-config-required")}}function sh(t,e,n){var r=function(t,e,n){return t.h&&!n?(e.cancel(),te(t.h)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new Lc("userInvalidated")),t.h=e),e})}(t,e,n);return t.I.push(r),r.ka(function(){W(t.I,r)}),r}function uh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[xa]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-A())/1e3;var r=new Mc(e,n,t);return t.providerData&&B(t.providerData,function(t){t&&Yc(r,Gr(t))}),t.redirectEventId&&(r.ca=t.redirectEventId),r}function ch(t){this.a=t,this.b=Nu()}gc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},gc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Tc(this,!0,null,t.a),Zt()):e.Ba(n,r)?function(t,e,n){n=n.Ba(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.R(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then(function(e){Tc(t,s,e,null)}).s(function(e){Tc(t,s,null,e)})}(this,t,e):te(new ti("invalid-auth-event")):(Tc(this,!1,null,null),Zt())}else te(new ti("invalid-auth-event"))},gc.prototype.oa=function(){var t=this;return new Ht(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new ti("timeout");t.a&&t.a.cancel(),t.a=pn(hc.get()).then(function(){t.b||(t.g=!0,Tc(t,!0,null,e))})}(t))})},Ec.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ja(t.c,null,t.a,t.b),Zt()):e.Ba(n,r)?function(t,e){var n=t.b,r=t.c;e.Ba(r,n)(t.g,t.f,t.R(),t.i).then(function(t){e.ja(r,t,null,n)}).s(function(t){e.ja(r,null,t,n)})}(t,e):te(new ti("invalid-auth-event"))}else te(new ti("invalid-auth-event"))},Ic.prototype.confirm=function(t){return t=Eo(this.verificationId,t),this.a(t)},Cc.prototype.start=function(){this.a=this.c,function t(e,n){e.stop();e.b=pn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return t=u.document,e=null,Lr()||!t?Zt():new Ht(function(n){e=function(){Lr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},Cc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Nc.prototype.A=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Nc.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?te(new ti("user-token-expired")):t||!this.b||A()>this.c-3e4?this.a?Rc(this,{grant_type:"refresh_token",refresh_token:this.a}):Zt(null):Zt({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Oc.prototype.A=function(){return{lastLoginAt:this.b,createdAt:this.a}},C(Lc,Ue),C(Mc,un),Mc.prototype.ua=function(t){this.ga=t,qa(this.a,t)},Mc.prototype.ha=function(){return this.ga},Mc.prototype.Ca=function(){return z(this.P)},Mc.prototype.Ja=function(){this.w.b&&(this.w.stop(),this.w.start())},qr(Mc.prototype,"providerId","firebase"),(e=Mc.prototype).reload=function(){var t=this;return sh(this,zc(this).then(function(){return Zc(t).then(function(){return Gc(t)}).then(Hc)}))},e.dc=function(t){return this.G(t).then(function(t){return new Ac(t)})},e.G=function(t){var e=this;return sh(this,zc(this).then(function(){return e.b.getToken(t)}).then(function(t){if(!t)throw new ti("internal-error");return t.accessToken!=e.ma&&(jc(e,t.accessToken),e.dispatchEvent(new Lc("tokenChanged"))),Jc(e,"refreshToken",t.refreshToken),t.accessToken}))},e.zc=function(t){if(!(t=t.users)||!t.length)throw new ti("internal-error");Kc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?q(t,function(t){return new Pc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)Yc(this,e[n]);Jc(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},e.Ac=function(t){return Vr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(t)},e.hb=function(t){var e=this,n=null;return sh(this,t.f(this.a,this.uid).then(function(t){return th(e,t),n=nh(e,t,"reauthenticate"),e.h=null,e.reload()}).then(function(){return n}),!0)},e.rc=function(t){return Vr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(t)},e.fb=function(t){var e=this,n=null;return sh(this,eh(this,t.providerId).then(function(){return e.G()}).then(function(n){return t.b(e.a,n)}).then(function(t){return n=nh(e,t,"link"),rh(e,t)}).then(function(){return n}))},e.sc=function(t,e){var n=this;return sh(this,eh(this,"phone").then(function(){return _c(Vc(n),t,e,I(n.fb,n))}))},e.Bc=function(t,e){var n=this;return sh(this,Zt().then(function(){return _c(Vc(n),t,e,I(n.hb,n))}),!0)},e.rb=function(t){var e=this;return sh(this,this.G().then(function(n){return e.a.rb(n,t)}).then(function(t){return th(e,t),e.reload()}))},e.Sc=function(t){var e=this;return sh(this,this.G().then(function(n){return t.b(e.a,n)}).then(function(t){return th(e,t),e.reload()}))},e.sb=function(t){var e=this;return sh(this,this.G().then(function(n){return e.a.sb(n,t)}).then(function(t){return th(e,t),e.reload()}))},e.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return zc(this);var e=this;return sh(this,this.G().then(function(n){return e.a.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return th(e,t),Jc(e,"displayName",t.displayName||null),Jc(e,"photoURL",t.photoUrl||null),B(e.providerData,function(t){"password"===t.providerId&&(qr(t,"displayName",e.displayName),qr(t,"photoURL",e.photoURL))}),Gc(e)}).then(Hc))},e.Qc=function(t){var e=this;return sh(this,Zc(this).then(function(n){return G(Qc(e),t)?function(t,e,n){return Rs(t,cs,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then(function(t){var n={};return B(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),B(Qc(e),function(t){n[t]||Xc(e,t)}),n[To.PROVIDER_ID]||qr(e,"phoneNumber",null),Gc(e)}):Gc(e).then(function(){throw new ti("no-such-provider")})}))},e.delete=function(){var t=this;return sh(this,this.G().then(function(e){return Rs(t.a,us,{idToken:e})}).then(function(){t.dispatchEvent(new Lc("userDeleted"))})).then(function(){for(var e=0;e<t.I.length;e++)t.I[e].cancel("app-deleted");xc(t,null),Fc(t,null),t.I=[],t.B=!0,qc(t),qr(t,"refreshToken",null),t.i&&uc(t.i,t)})},e.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ca||null)==e||"reauthViaRedirect"==t&&(this.ca||null)==e)},e.ja=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.Ba=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?I(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?I(this.Cb,this):"linkViaRedirect"==t&&(this.ca||null)==e?I(this.Bb,this):"reauthViaRedirect"==t&&(this.ca||null)==e?I(this.Cb,this):null},e.tc=function(t){var e=this;return ih(this,"linkViaPopup",t,function(){return eh(e,t.providerId).then(function(){return Gc(e)})},!1)},e.Cc=function(t){return ih(this,"reauthViaPopup",t,function(){return Zt()},!0)},e.uc=function(t){var e=this;return oh(this,"linkViaRedirect",t,function(){return eh(e,t.providerId)},!1)},e.Dc=function(t){return oh(this,"reauthViaRedirect",t,function(){return Zt()},!0)},e.Bb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return sh(this,this.G().then(function(n){return es(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})}).then(function(t){return o=nh(i,t,"link"),rh(i,t)}).then(function(){return o}))},e.Cb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return sh(this,Zt().then(function(){return Qi(ns(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)}).then(function(t){return o=nh(i,t,"reauthenticate"),th(i,t),i.h=null,i.reload()}).then(function(){return o}),!0)},e.jb=function(t){var e=this,n=null;return sh(this,this.G().then(function(e){return n=e,void 0===t||Y(t)?{}:Si(new pi(t))}).then(function(t){return e.a.jb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},e.toJSON=function(){return this.A()},e.A=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.A(),redirectEventId:this.ca||null};return this.metadata&&$(t,this.metadata.A()),B(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var hh={name:"redirectUser",C:"session"};function lh(t){return Ru(t.b,hh,t.a)}function fh(t){this.a=t,this.b=Nu(),this.c=null,this.f=function(t){var e=mh("local"),n=mh("session"),r=mh("none");return function(t,e,n){var r=ku(e,n),i=Du(t,e.C);return t.get(e,n).then(function(o){var a=null;try{a=Dr(u.localStorage.getItem(r))}catch(s){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)})}(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(i){return i?n:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(dh,t.a).then(function(t){return t?mh(t):e})})})}).then(function(e){return t.c=e,ph(t,e.C)}).s(function(){t.c||(t.c=e)})}(this),this.b.addListener(mh("local"),this.a,I(this.g,this))}function ph(t,e){var n,r=[];for(n in Au)Au[n]!==e&&r.push(Ru(t.b,mh(Au[n]),t.a));return r.push(Ru(t.b,dh,t.a)),function(t){return new Ht(function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)ee(t[s],_(o,s),a);else e(i)})}(r)}fh.prototype.g=function(){var t=this,e=mh("local");bh(this,function(){return Zt().then(function(){return t.c&&"local"!=t.c.C?t.b.get(e,t.a):null}).then(function(n){if(n)return ph(t,"local").then(function(){t.c=e})})})};var dh={name:"persistence",C:"session"};function mh(t){return{name:"authUser",C:t}}function yh(t,e){return bh(t,function(){return t.b.set(t.c,e.A(),t.a)})}function gh(t){return bh(t,function(){return Ru(t.b,t.c,t.a)})}function vh(t,e){return bh(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),uh(t||{})})})}function bh(t,e){return t.f=t.f.then(e,e),t.f}function wh(t){if(this.l=!1,qr(this,"settings",new Sc),qr(this,"app",t),!Nh(this).options||!Nh(this).options.apiKey)throw new ti("invalid-api-key");t=r.a.SDK_VERSION?br(r.a.SDK_VERSION):null,this.b=new La(Nh(this).options&&Nh(this).options.apiKey,Oi(ki),t),this.O=[],this.m=[],this.J=[],this.Ub=r.a.INTERNAL.createSubscribe(I(this.oc,this)),this.W=void 0,this.Vb=r.a.INTERNAL.createSubscribe(I(this.pc,this)),Ah(this,null),this.h=new fh(Nh(this).options.apiKey+":"+Nh(this).name),this.w=new ch(Nh(this).options.apiKey+":"+Nh(this).name),this.Y=Oh(this,function(t){var e=Nh(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(hh,t.a).then(function(t){return t&&e&&(t.authDomain=e),uh(t||{})})}(t.w,Nh(t).options.authDomain).then(function(e){return(t.B=e)&&(e.da=t.w),lh(t.w)});return Oh(t,e)}(t).then(function(){return vh(t.h,e)}).then(function(e){return e?(e.da=t.w,t.B&&(t.B.ca||null)==(e.ca||null)?e:e.reload().then(function(){return yh(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:gh(t.h)})):null}).then(function(e){Ah(t,e||null)});return Oh(t,n)}(this)),this.i=Oh(this,function(t){return t.Y.then(function(){return Ih(t)}).s(function(){}).then(function(){if(!t.l)return t.ma()}).s(function(){}).then(function(){if(!t.l){t.ga=!0;var e=t.h;e.b.addListener(mh("local"),e.a,t.ma)}})}(this)),this.ga=!1,this.ma=I(this.Nc,this),this.ub=I(this.aa,this),this.wa=I(this.bc,this),this.xa=I(this.mc,this),this.Ja=I(this.nc,this),this.a=null,function(t){var e=Nh(t).options.authDomain,n=Nh(t).options.apiKey;e&&Sr()&&(t.Tb=t.Y.then(function(){if(!t.l){if(t.a=yc(e,n,Nh(t).name),sc(t.a,t),Dh(t)&&Wc(Dh(t)),t.B){Wc(t.B);var r=t.B;r.ua(t.ha()),xc(r,t),Uc(r=t.B,t.I),Fc(r,t),t.B=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=I(this.delete,this),this.INTERNAL.logFramework=I(this.vc,this),this.o=0,un.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ha()},set:function(t){this.ua(t)},enumerable:!1}),t.Z=null,Object.defineProperty(t,"ti",{get:function(){return this.R()},set:function(t){this.nb(t)},enumerable:!1}),t.P=null}(this),this.I=[]}function Th(t){Ue.call(this,"languageCodeChanged"),this.g=t}function Eh(t){Ue.call(this,"frameworkChanged"),this.c=t}function Sh(t){return t.Tb||te(new ti("auth-domain-config-required"))}function Ih(t){if(!Sr())return te(new ti("operation-not-supported-in-this-environment"));var e=Sh(t).then(function(){return t.a.oa()}).then(function(t){return t?Gr(t):null});return Oh(t,e)}function _h(t,e){var n={};return n.apiKey=Nh(t).options.apiKey,n.authDomain=Nh(t).options.authDomain,n.appName=Nh(t).name,t.Y.then(function(){return function(t,e,n,r){var i=new Mc(t,e);return n&&(i.da=n),r&&Uc(i,r),i.reload().then(function(){return i})}(n,e,t.w,t.Ca())}).then(function(e){return Dh(t)&&e.uid==Dh(t).uid?($c(Dh(t),e),t.aa(e)):(Ah(t,e),Wc(e),t.aa(e))}).then(function(){Rh(t)})}function Ah(t,e){Dh(t)&&(function(t,e){K(t.O,function(t){return t==e})}(Dh(t),t.ub),$e(Dh(t),"tokenChanged",t.wa),$e(Dh(t),"userDeleted",t.xa),$e(Dh(t),"userInvalidated",t.Ja),qc(Dh(t))),e&&(e.O.push(t.ub),Ye(e,"tokenChanged",t.wa),Ye(e,"userDeleted",t.xa),Ye(e,"userInvalidated",t.Ja),0<t.o&&Bc(e)),qr(t,"currentUser",e),e&&(e.ua(t.ha()),xc(e,t),Uc(e,t.I),Fc(e,t))}function Ch(t,e){var n=null,r=null;return Oh(t,e.then(function(e){return n=So(e),r=Ui(e),_h(t,e)}).then(function(){return Gr({user:Dh(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Nh(t){return t.app}function Dh(t){return t.currentUser}function kh(t){return Dh(t)&&Dh(t)._lat||null}function Rh(t){if(t.ga){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](kh(t));if(t.W!==t.getUid()&&t.J.length)for(t.W=t.getUid(),e=0;e<t.J.length;e++)t.J[e]&&t.J[e](kh(t))}}function Oh(t,e){return t.O.push(e),e.ka(function(){W(t.O,e)}),e}function Ph(){}function Lh(){this.a={},this.b=1e12}fh.prototype.mb=function(t){var e=null,n=this;return function(t){var e=new ti("invalid-persistence-type"),n=new ti("unsupported-persistence-type");t:{for(r in Au)if(Au[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(pr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!Er()&&"none"!==t)throw n}}(t),bh(this,function(){return t!=n.c.C?n.b.get(n.c,n.a).then(function(r){return e=r,ph(n,t)}).then(function(){if(n.c=mh(t),e)return n.b.set(n.c,e,n.a)}):Zt()})},C(wh,un),C(Th,Ue),C(Eh,Ue),(e=wh.prototype).mb=function(t){return Oh(this,t=this.h.mb(t))},e.ua=function(t){this.Z===t||this.l||(this.Z=t,qa(this.b,this.Z),this.dispatchEvent(new Th(this.ha())))},e.ha=function(){return this.Z},e.Tc=function(){var t=u.navigator;this.ua(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},e.vc=function(t){this.I.push(t),ja(this.b,r.a.SDK_VERSION?br(r.a.SDK_VERSION,this.I):null),this.dispatchEvent(new Eh(this.I))},e.Ca=function(){return z(this.I)},e.nb=function(t){this.P===t||this.l||(this.P=t,this.b.b=this.P)},e.R=function(){return this.P},e.toJSON=function(){return{apiKey:Nh(this).options.apiKey,authDomain:Nh(this).options.authDomain,appName:Nh(this).name,currentUser:Dh(this)&&Dh(this).A()}},e.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},e.ja=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.Ba=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?I(this.ac,this):null},e.ac=function(t,e,n,r){var i=this;t={requestUri:t,postBody:r,sessionId:e,tenantId:n},this.c&&(this.c.cancel(),this.c=null);var o=null,a=null,s=ts(i.b,t).then(function(t){return o=So(t),a=Ui(t),t});return Oh(this,t=i.Y.then(function(){return s}).then(function(t){return _h(i,t)}).then(function(){return Gr({user:Dh(i),credential:o,additionalUserInfo:a,operationType:"signIn"})}))},e.Lc=function(t){if(!Sr())return te(new ti("operation-not-supported-in-this-environment"));var e=this,n=xi(t.providerId),i=kr(),o=null;(!Ar()||lr())&&Nh(this).options.authDomain&&t.isOAuthProvider&&(o=Hs(Nh(this).options.authDomain,Nh(this).options.apiKey,Nh(this).name,"signInViaPopup",t,null,i,r.a.SDK_VERSION||null,null,null,this.R()));var a=ar(o,n&&n.sa,n&&n.ra);return Oh(this,n=Sh(this).then(function(n){return lc(n,a,"signInViaPopup",t,i,!!o,e.R())}).then(function(){return new Ht(function(t,n){e.ja("signInViaPopup",null,new ti("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=i,e.c=dc(e.a,e,"signInViaPopup",a,i)})}).then(function(t){return a&&or(a),t?Gr(t):null}).s(function(t){throw a&&or(a),t}))},e.Mc=function(t){if(!Sr())return te(new ti("operation-not-supported-in-this-environment"));var e=this;return Oh(this,Sh(this).then(function(){return bh(t=e.h,function(){return t.b.set(dh,t.c.C,t.a)});var t}).then(function(){return pc(e.a,"signInViaRedirect",t,void 0,e.R())}))},e.oa=function(){var t=this;return Ih(this).then(function(e){return t.a&&bc(t.a.b),e}).s(function(e){throw t.a&&bc(t.a.b),e})},e.Rc=function(t){if(!t)return te(new ti("null-user"));if(this.P!=t.tenantId)return te(new ti("tenant-id-mismatch"));var e=this,n={};n.apiKey=Nh(this).options.apiKey,n.authDomain=Nh(this).options.authDomain,n.appName=Nh(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.o,appName:t.m};var i=t.b,o={};return o[xa]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-A())/1e3,e=new Mc(e,o),n&&(e.da=n),r&&Uc(e,r),$c(e,t),e}(t,n,e.w,e.Ca());return Oh(this,this.i.then(function(){if(Nh(e).options.apiKey!=t.l)return r.reload()}).then(function(){return Dh(e)&&t.uid==Dh(e).uid?($c(Dh(e),t),e.aa(t)):(Ah(e,r),Wc(r),e.aa(r))}).then(function(){Rh(e)}))},e.pb=function(){var t=this;return Oh(this,this.i.then(function(){return t.a&&bc(t.a.b),Dh(t)?(Ah(t,null),gh(t.h).then(function(){Rh(t)})):Zt()}))},e.Nc=function(){var t=this;return vh(this.h,Nh(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=Dh(t)&&e){n=Dh(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return $c(Dh(t),e),Dh(t).G();(Dh(t)||e)&&(Ah(t,e),e&&(Wc(e),e.da=t.w),t.a&&sc(t.a,t),Rh(t))}})},e.aa=function(t){return yh(this.h,t)},e.bc=function(){Rh(this),this.aa(Dh(this))},e.mc=function(){this.pb()},e.nc=function(){this.pb()},e.oc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(Dh(e))})},e.pc=function(t){var e=this;!function(t,e){t.J.push(e),Oh(t,t.i.then(function(){!t.l&&G(t.J,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(kh(t)))}))}(this,function(){t.next(Dh(e))})},e.xc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then(function(){v(t)?t(Dh(r)):v(t.next)&&t.next(Dh(r))}),this.Ub(t,e,n)},e.wc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then(function(){r.W=r.getUid(),v(t)?t(Dh(r)):v(t.next)&&t.next(Dh(r))}),this.Vb(t,e,n)},e.cc=function(t){var e=this;return Oh(this,this.i.then(function(){return Dh(e)?Dh(e).G(t).then(function(t){return{accessToken:t}}):null}))},e.Hc=function(t){var e=this;return this.i.then(function(){return Ch(e,Rs(e.b,As,{token:t}))}).then(function(t){var n=t.user;return Jc(n,"isAnonymous",!1),e.aa(n),t})},e.Ic=function(t,e){var n=this;return this.i.then(function(){return Ch(n,Rs(n.b,Cs,{email:t,password:e}))})},e.Xb=function(t,e){var n=this;return this.i.then(function(){return Ch(n,Rs(n.b,as,{email:t,password:e}))})},e.Sa=function(t){var e=this;return this.i.then(function(){return Ch(e,t.na(e.b))})},e.Gc=function(t){return Vr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Sa(t)},e.ob=function(){var t=this;return this.i.then(function(){var e=Dh(t);if(e&&e.isAnonymous){var n=Gr({providerId:null,isNewUser:!1});return Gr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Ch(t,t.b.ob()).then(function(e){var n=e.user;return Jc(n,"isAnonymous",!0),t.aa(n),e})})},e.getUid=function(){return Dh(this)&&Dh(this).uid||null},e.Wb=function(t){this.addAuthTokenListener(t),this.o++,0<this.o&&Dh(this)&&Bc(Dh(this))},e.Ec=function(t){var e=this;B(this.m,function(n){n==t&&e.o--}),0>this.o&&(this.o=0),0==this.o&&Dh(this)&&qc(Dh(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(t){var e=this;this.m.push(t),Oh(this,this.i.then(function(){e.l||G(e.m,t)&&t(kh(e))}))},e.removeAuthTokenListener=function(t){K(this.m,function(e){return e==t})},e.delete=function(){this.l=!0;for(var t=0;t<this.O.length;t++)this.O[t].cancel("app-deleted");return this.O=[],this.h&&(t=this.h).b.removeListener(mh("local"),t.a,this.ma),this.a&&(uc(this.a,this),bc(this.a.b)),Promise.resolve()},e.$b=function(t){return Oh(this,function(t,e){return Rs(t,ss,{identifier:e,continueUri:Ir()?nr():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.b,t))},e.qc=function(t){return!!go(t)},e.lb=function(t,e){var n=this;return Oh(this,Zt().then(function(){var t=new pi(e);if(!t.c)throw new ti("argument-error",yi+" must be true when sending sign in link to email");return Si(t)}).then(function(e){return n.b.lb(t,e)}).then(function(){}))},e.Uc=function(t){return this.Ma(t).then(function(t){return t.data.email})},e.ab=function(t,e){return Oh(this,this.b.ab(t,e).then(function(){}))},e.Ma=function(t){return Oh(this,this.b.Ma(t).then(function(t){return new Kr(t)}))},e.Ya=function(t){return Oh(this,this.b.Ya(t).then(function(){}))},e.kb=function(t,e){var n=this;return Oh(this,Zt().then(function(){return void 0===e||Y(e)?{}:Si(new pi(e))}).then(function(e){return n.b.kb(t,e)}).then(function(){}))},e.Kc=function(t,e){return Oh(this,_c(this,t,e,I(this.Sa,this)))},e.Jc=function(t,e){var n=this;return Oh(this,Zt().then(function(){var r=e||nr(),i=yo(t,r);if(!(r=go(r)))throw new ti("argument-error","Invalid email link!");if(r.tenantId!==n.R())throw new ti("tenant-id-mismatch");return n.Sa(i)}))},Ph.prototype.render=function(){},Ph.prototype.reset=function(){},Ph.prototype.getResponse=function(){},Ph.prototype.execute=function(){};var Mh=null;function xh(t,e){return(e=Uh(e))&&t.a[e]||null}function Uh(t){return(t=void 0===t?1e12:t)?t.toString():null}function Fh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Kn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Ye(this.f,"click",this.i)}function Vh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Bh(){}Lh.prototype.render=function(t,e){return this.a[this.b.toString()]=new Fh(t,e),this.b++},Lh.prototype.reset=function(t){var e=xh(this,t);t=Uh(t),e&&t&&(e.delete(),delete this.a[t])},Lh.prototype.getResponse=function(t){return(t=xh(this,t))?t.getResponse():null},Lh.prototype.execute=function(t){(t=xh(this,t))&&t.execute()},Fh.prototype.getResponse=function(){return Vh(this),this.b},Fh.prototype.execute=function(){Vh(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()},6e4)},500))},Fh.prototype.delete=function(){Vh(this),this.g=!0,clearTimeout(this.a),this.a=null,$e(this.f,"click",this.i)},Bh.prototype.g=function(){return Mh||(Mh=new Lh),Zt(Mh)},Bh.prototype.c=function(){};var qh=null;function jh(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Gh=new Z(nt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Wh=new Pr(3e4,6e4);jh.prototype.g=function(t){var e=this;return new Ht(function(n,r){var i=setTimeout(function(){r(new ti("network-request-failed"))},Wh.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new ti("internal-error"));delete u[e.a]},Zt(Ca(at(Gh,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(i),r(new ti("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),n(u.grecaptcha))})},jh.prototype.c=function(){this.b--};var Kh=null;function Hh(t,e,n,r,i,o,a){if(qr(this,"type","recaptcha"),this.c=this.f=null,this.B=!1,this.u=e,this.g=null,a?(qh||(qh=new Bh),a=qh):(Kh||(Kh=new jh),a=Kh),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Yh])throw new ti("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Xh],!u.document)throw new ti("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Kn(e)||!this.i&&Kn(e).hasChildNodes())throw new ti("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new La(t,o||null,i||null),this.v=r||function(){return null};var s=this;this.l=[];var c=this.a[zh];this.a[zh]=function(t){if(Jh(s,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Tr(c,u);"function"==typeof e&&e(t)}};var h=this.a[Qh];this.a[Qh]=function(){if(Jh(s,null),"function"==typeof h)h();else if("string"==typeof h){var t=Tr(h,u);"function"==typeof t&&t()}}}var zh="callback",Qh="expired-callback",Yh="sitekey",Xh="size";function Jh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function $h(t,e){return t.h.push(e),e.ka(function(){W(t.h,e)}),e}function Zh(t){if(t.B)throw new ti("internal-error","RecaptchaVerifier instance has been destroyed.")}function tl(t,e,n){var i=!1;try{this.b=n||r.a.app()}catch(s){throw new ti("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new ti("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ca()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.a.SDK_VERSION?br(r.a.SDK_VERSION,a):null,Hh.call(this,n,t,e,function(){try{var t=o.b.auth().ha()}catch(e){t=null}return t},a,Oi(ki),i)}function el(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new ti("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].N(n[i])&&!o){if(e=e[i],0>i||i>=nl.length)throw new ti("internal-error","Argument validator received an unsupported number of arguments.");n=nl[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.M+".";break t}r=null}}if(r)throw new ti("argument-error",t+" failed: "+r)}(e=Hh.prototype).Da=function(){var t=this;return this.f?this.f:this.f=$h(this,Zt().then(function(){if(Ir()&&!fr())return cr();throw new ti("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.m.g(t.v())}).then(function(e){return t.g=e,Rs(t.o,gs,{})}).then(function(e){t.a[Yh]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},e.render=function(){Zh(this);var t=this;return $h(this,this.Da().then(function(){if(null===t.c){var e=t.u;if(!t.i){var n=Kn(e);e=Qn("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},e.verify=function(){Zh(this);var t=this;return $h(this,this.render().then(function(e){return new Ht(function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){K(t.l,function(t){return t==e})}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}})}))},e.reset=function(){Zh(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Zh(this),this.B=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=Kn(this.u);for(var e;e=t.firstChild;)t.removeChild(e)}},C(tl,Hh);var nl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function rl(t,e){return{name:t||"",M:"a valid string",optional:!!e,N:c}}function il(t,e){return{name:t||"",M:"a boolean",optional:!!e,N:h}}function ol(t,e){return{name:t||"",M:"a valid object",optional:!!e,N:b}}function al(t,e){return{name:t||"",M:"a function",optional:!!e,N:v}}function sl(t,e){return{name:t||"",M:"null",optional:!!e,N:m}}function ul(t){return{name:t?t+"Credential":"credential",M:t?"a valid "+t+" credential":"a valid credential",optional:!1,N:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.na||!n)}}}function cl(){return{name:"applicationVerifier",M:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,N:function(t){return!!(t&&c(t.type)&&v(t.verify))}}}function hl(t,e,n,r){return{name:n||"",M:t.M+" or "+e.M,optional:!!r,N:function(n){return t.N(n)||e.N(n)}}}function ll(t,e){for(var n in e){var r=e[n].name;t[r]=dl(r,t[n],e[n].j)}}function fl(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:_(function(t){return this[t]},n),set:_(function(t,e,n,r){el(t,[n],[r],!0),this[e]=r},r,n,e[n].Za),enumerable:!0})}}function pl(t,e,n,r){t[e]=dl(e,n,r)}function dl(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return el(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}ll(wh.prototype,{Ya:{name:"applyActionCode",j:[rl("code")]},Ma:{name:"checkActionCode",j:[rl("code")]},ab:{name:"confirmPasswordReset",j:[rl("code"),rl("newPassword")]},Xb:{name:"createUserWithEmailAndPassword",j:[rl("email"),rl("password")]},$b:{name:"fetchSignInMethodsForEmail",j:[rl("email")]},oa:{name:"getRedirectResult",j:[]},qc:{name:"isSignInWithEmailLink",j:[rl("emailLink")]},wc:{name:"onAuthStateChanged",j:[hl(ol(),al(),"nextOrObserver"),al("opt_error",!0),al("opt_completed",!0)]},xc:{name:"onIdTokenChanged",j:[hl(ol(),al(),"nextOrObserver"),al("opt_error",!0),al("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[rl("email"),hl(ol("opt_actionCodeSettings",!0),sl(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[rl("email"),ol("actionCodeSettings")]},mb:{name:"setPersistence",j:[rl("persistence")]},Gc:{name:"signInAndRetrieveDataWithCredential",j:[ul()]},ob:{name:"signInAnonymously",j:[]},Sa:{name:"signInWithCredential",j:[ul()]},Hc:{name:"signInWithCustomToken",j:[rl("token")]},Ic:{name:"signInWithEmailAndPassword",j:[rl("email"),rl("password")]},Jc:{name:"signInWithEmailLink",j:[rl("email"),rl("emailLink",!0)]},Kc:{name:"signInWithPhoneNumber",j:[rl("phoneNumber"),cl()]},Lc:{name:"signInWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Mc:{name:"signInWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Rc:{name:"updateCurrentUser",j:[hl({name:"user",M:"an instance of Firebase User",optional:!1,N:function(t){return!!(t&&t instanceof Mc)}},sl(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[rl(null,!0)]},Tc:{name:"useDeviceLanguage",j:[]},Uc:{name:"verifyPasswordResetCode",j:[rl("code")]}}),fl(wh.prototype,{lc:{name:"languageCode",Za:hl(rl(),sl(),"languageCode")},ti:{name:"tenantId",Za:hl(rl(),sl(),"tenantId")}}),wh.Persistence=Au,wh.Persistence.LOCAL="local",wh.Persistence.SESSION="session",wh.Persistence.NONE="none",ll(Mc.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[il("opt_forceRefresh",!0)]},G:{name:"getIdToken",j:[il("opt_forceRefresh",!0)]},rc:{name:"linkAndRetrieveDataWithCredential",j:[ul()]},fb:{name:"linkWithCredential",j:[ul()]},sc:{name:"linkWithPhoneNumber",j:[rl("phoneNumber"),cl()]},tc:{name:"linkWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},uc:{name:"linkWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ac:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ul()]},hb:{name:"reauthenticateWithCredential",j:[ul()]},Bc:{name:"reauthenticateWithPhoneNumber",j:[rl("phoneNumber"),cl()]},Cc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[hl(ol("opt_actionCodeSettings",!0),sl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[rl(null,!0)]},Qc:{name:"unlink",j:[rl("provider")]},rb:{name:"updateEmail",j:[rl("email")]},sb:{name:"updatePassword",j:[rl("password")]},Sc:{name:"updatePhoneNumber",j:[ul("phone")]},tb:{name:"updateProfile",j:[ol("profile")]}}),ll(Lh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),ll(Ph.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),ll(Ht.prototype,{ka:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),fl(Sc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",Za:il("appVerificationDisabledForTesting")}}),ll(Ic.prototype,{confirm:{name:"confirm",j:[rl("verificationCode")]}}),pl(zi,"fromJSON",function(t){t=c(t)?JSON.parse(t):t;for(var e,n=[to,po,bo,Ji],r=0;r<n.length;r++)if(e=n[r](t))return e;return null},[hl(rl(),ol(),"json")]),pl(mo,"credential",function(t,e){return new fo(t,e)},[rl("email"),rl("password")]),ll(fo.prototype,{A:{name:"toJSON",j:[rl(null,!0)]}}),ll(io.prototype,{ya:{name:"addScope",j:[rl("scope")]},Ga:{name:"setCustomParameters",j:[ol("customOAuthParameters")]}}),pl(io,"credential",oo,[hl(rl(),ol(),"token")]),pl(mo,"credentialWithLink",yo,[rl("email"),rl("emailLink")]),ll(ao.prototype,{ya:{name:"addScope",j:[rl("scope")]},Ga:{name:"setCustomParameters",j:[ol("customOAuthParameters")]}}),pl(ao,"credential",so,[hl(rl(),ol(),"token")]),ll(uo.prototype,{ya:{name:"addScope",j:[rl("scope")]},Ga:{name:"setCustomParameters",j:[ol("customOAuthParameters")]}}),pl(uo,"credential",co,[hl(rl(),hl(ol(),sl()),"idToken"),hl(rl(),sl(),"accessToken",!0)]),ll(ho.prototype,{Ga:{name:"setCustomParameters",j:[ol("customOAuthParameters")]}}),pl(ho,"credential",lo,[hl(rl(),ol(),"token"),rl("secret",!0)]),ll(ro.prototype,{ya:{name:"addScope",j:[rl("scope")]},credential:{name:"credential",j:[hl(rl(),hl(ol(),sl()),"optionsOrIdToken"),hl(rl(),sl(),"accessToken",!0)]},Ga:{name:"setCustomParameters",j:[ol("customOAuthParameters")]}}),ll($i.prototype,{A:{name:"toJSON",j:[rl(null,!0)]}}),ll(Yi.prototype,{A:{name:"toJSON",j:[rl(null,!0)]}}),pl(To,"credential",Eo,[rl("verificationId"),rl("verificationCode")]),ll(To.prototype,{Wa:{name:"verifyPhoneNumber",j:[rl("phoneNumber"),cl()]}}),ll(vo.prototype,{A:{name:"toJSON",j:[rl(null,!0)]}}),ll(ti.prototype,{toJSON:{name:"toJSON",j:[rl(null,!0)]}}),ll(Ro.prototype,{toJSON:{name:"toJSON",j:[rl(null,!0)]}}),ll(ko.prototype,{toJSON:{name:"toJSON",j:[rl(null,!0)]}}),ll(tl.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),pl(ii,"parseLink",fi,[rl("link")]),function(){if(void 0===r.a||!r.a.INTERNAL||!r.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Hr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:wh,AuthCredential:zi,Error:ti};pl(t,"EmailAuthProvider",mo,[]),pl(t,"FacebookAuthProvider",io,[]),pl(t,"GithubAuthProvider",ao,[]),pl(t,"GoogleAuthProvider",uo,[]),pl(t,"TwitterAuthProvider",ho,[]),pl(t,"OAuthProvider",ro,[rl("providerId")]),pl(t,"SAMLAuthProvider",no,[rl("providerId")]),pl(t,"PhoneAuthProvider",To,[{name:"auth",M:"an instance of Firebase Auth",optional:!0,N:function(t){return!!(t&&t instanceof wh)}}]),pl(t,"RecaptchaVerifier",tl,[hl(rl(),{name:"",M:"an HTML element",optional:!1,N:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),ol("recaptchaParameters",!0),{name:"app",M:"an instance of Firebase App",optional:!0,N:function(t){return!!(t&&t instanceof r.a.app.App)}}]),pl(t,"ActionCodeURL",ii,[]),r.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new wh(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),r.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:I((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:I(t.cc,t),addAuthTokenListener:I(t.Wb,t),removeAuthTokenListener:I(t.Ec,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.a.registerVersion("@firebase/auth","0.13.5"),r.a.INTERNAL.extendNamespace({User:Mc})}()}).apply(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(this,n(25))},148:function(t,e,n){"use strict";var r,i=(r=n(898))&&"object"==typeof r&&"default"in r?r.default:r;i.registerVersion("firebase","7.8.1","app"),t.exports=i},151:function(t,e,n){e.__esModule=!0,e.Helmet=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=l(n(0)),a=l(n(3)),s=l(n(1391)),u=l(n(1392)),c=n(1395),h=n(1334);function l(t){return t&&t.__esModule?t:{default:t}}function f(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var p,d,m,y=(0,s.default)(c.reducePropsToState,c.handleClientStateChange,c.mapStateOnServer)(function(){return null}),g=(p=y,m=d=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.shouldComponentUpdate=function(t){return!(0,u.default)(this.props,t)},e.prototype.mapNestedChildrenToProps=function(t,e){if(!e)return null;switch(t.type){case h.TAG_NAMES.SCRIPT:case h.TAG_NAMES.NOSCRIPT:return{innerHTML:e};case h.TAG_NAMES.STYLE:return{cssText:e}}throw new Error("<"+t.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},e.prototype.flattenArrayTypeChildren=function(t){var e,n=t.child,i=t.arrayTypeChildren,o=t.newChildProps,a=t.nestedChildren;return r({},i,((e={})[n.type]=[].concat(i[n.type]||[],[r({},o,this.mapNestedChildrenToProps(n,a))]),e))},e.prototype.mapObjectTypeChildren=function(t){var e,n,i=t.child,o=t.newProps,a=t.newChildProps,s=t.nestedChildren;switch(i.type){case h.TAG_NAMES.TITLE:return r({},o,((e={})[i.type]=s,e.titleAttributes=r({},a),e));case h.TAG_NAMES.BODY:return r({},o,{bodyAttributes:r({},a)});case h.TAG_NAMES.HTML:return r({},o,{htmlAttributes:r({},a)})}return r({},o,((n={})[i.type]=r({},a),n))},e.prototype.mapArrayTypeChildrenToProps=function(t,e){var n=r({},e);return Object.keys(t).forEach(function(e){var i;n=r({},n,((i={})[e]=t[e],i))}),n},e.prototype.warnOnInvalidChildren=function(t,e){return!0},e.prototype.mapChildrenToProps=function(t,e){var n=this,r={};return o.default.Children.forEach(t,function(t){if(t&&t.props){var i=t.props,o=i.children,a=f(i,["children"]),s=(0,c.convertReactPropstoHtmlAttributes)(a);switch(n.warnOnInvalidChildren(t,o),t.type){case h.TAG_NAMES.LINK:case h.TAG_NAMES.META:case h.TAG_NAMES.NOSCRIPT:case h.TAG_NAMES.SCRIPT:case h.TAG_NAMES.STYLE:r=n.flattenArrayTypeChildren({child:t,arrayTypeChildren:r,newChildProps:s,nestedChildren:o});break;default:e=n.mapObjectTypeChildren({child:t,newProps:e,newChildProps:s,nestedChildren:o})}}}),e=this.mapArrayTypeChildrenToProps(r,e)},e.prototype.render=function(){var t=this.props,e=t.children,n=f(t,["children"]),i=r({},n);return e&&(i=this.mapChildrenToProps(e,i)),o.default.createElement(p,i)},i(e,null,[{key:"canUseDOM",set:function(t){p.canUseDOM=t}}]),e}(o.default.Component),d.propTypes={base:a.default.object,bodyAttributes:a.default.object,children:a.default.oneOfType([a.default.arrayOf(a.default.node),a.default.node]),defaultTitle:a.default.string,defer:a.default.bool,encodeSpecialCharacters:a.default.bool,htmlAttributes:a.default.object,link:a.default.arrayOf(a.default.object),meta:a.default.arrayOf(a.default.object),noscript:a.default.arrayOf(a.default.object),onChangeClientState:a.default.func,script:a.default.arrayOf(a.default.object),style:a.default.arrayOf(a.default.object),title:a.default.string,titleAttributes:a.default.object,titleTemplate:a.default.string},d.defaultProps={defer:!0,encodeSpecialCharacters:!0},d.peek=p.peek,d.rewind=function(){var t=p.rewind();return t||(t=(0,c.mapStateOnServer)({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),t},m);g.renderStatic=g.rewind,e.Helmet=g,e.default=g},217:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},289:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forceCheck=e.lazyload=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),o=f(i),a=f(n(13)),s=f(n(3)),u=n(910),c=f(n(911)),h=f(n(912)),l=f(n(913));function f(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var y=0,g=0,v=0,b=0,w="data-lazyload-listened",T=[],E=[],S=!1;try{var I=Object.defineProperty({},"passive",{get:function(){S=!0}});window.addEventListener("test",null,I)}catch(O){}var _=!!S&&{capture:!1,passive:!0},A=function(t){var e=a.default.findDOMNode(t);if(e instanceof HTMLElement){var n=(0,c.default)(e);(t.props.overflow&&n!==e.ownerDocument&&n!==document&&n!==document.documentElement?function(t,e){var n=a.default.findDOMNode(t),r=void 0,i=void 0,o=void 0,s=void 0;try{var u=e.getBoundingClientRect();r=u.top,i=u.left,o=u.height,s=u.width}catch(O){r=y,i=g,o=b,s=v}var c=window.innerHeight||document.documentElement.clientHeight,h=window.innerWidth||document.documentElement.clientWidth,l=Math.max(r,0),f=Math.max(i,0),p=Math.min(c,r+o)-l,d=Math.min(h,i+s)-f,m=void 0,w=void 0,T=void 0,E=void 0;try{var S=n.getBoundingClientRect();m=S.top,w=S.left,T=S.height,E=S.width}catch(O){m=y,w=g,T=b,E=v}var I=m-l,_=w-f,A=Array.isArray(t.props.offset)?t.props.offset:[t.props.offset,t.props.offset];return I-A[0]<=p&&I+T+A[1]>=0&&_-A[0]<=d&&_+E+A[1]>=0}(t,n):function(t){var e=a.default.findDOMNode(t);if(!(e.offsetWidth||e.offsetHeight||e.getClientRects().length))return!1;var n=void 0,r=void 0;try{var i=e.getBoundingClientRect();n=i.top,r=i.height}catch(O){n=y,r=b}var o=window.innerHeight||document.documentElement.clientHeight,s=Array.isArray(t.props.offset)?t.props.offset:[t.props.offset,t.props.offset];return n-s[0]<=o&&n+r+s[1]>=0}(t))?t.visible||(t.props.once&&E.push(t),t.visible=!0,t.forceUpdate()):t.props.once&&t.visible||(t.visible=!1,t.props.unmountIfInvisible&&t.forceUpdate())}},C=function(){for(var t=0;t<T.length;++t){var e=T[t];A(e)}E.forEach(function(t){var e=T.indexOf(t);-1!==e&&T.splice(e,1)}),E=[]},N=void 0,D=null,k=function(t){function e(t){p(this,e);var n=d(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.visible=!1,n}return m(e,i.Component),r(e,[{key:"componentDidMount",value:function(){var t=window,e=this.props.scrollContainer;e&&"string"==typeof e&&(t=t.document.querySelector(e));var n=void 0!==this.props.debounce&&"throttle"===N||"debounce"===N&&void 0===this.props.debounce;if(n&&((0,u.off)(t,"scroll",D,_),(0,u.off)(window,"resize",D,_),D=null),D||(void 0!==this.props.debounce?(D=(0,h.default)(C,"number"==typeof this.props.debounce?this.props.debounce:300),N="debounce"):void 0!==this.props.throttle?(D=(0,l.default)(C,"number"==typeof this.props.throttle?this.props.throttle:300),N="throttle"):D=C),this.props.overflow){var r=(0,c.default)(a.default.findDOMNode(this));if(r&&"function"==typeof r.getAttribute){var i=+r.getAttribute(w)+1;1===i&&r.addEventListener("scroll",D,_),r.setAttribute(w,i)}}else if(0===T.length||n){var o=this.props,s=o.scroll,f=o.resize;s&&(0,u.on)(t,"scroll",D,_),f&&(0,u.on)(window,"resize",D,_)}T.push(this),A(this)}},{key:"shouldComponentUpdate",value:function(){return this.visible}},{key:"componentWillUnmount",value:function(){if(this.props.overflow){var t=(0,c.default)(a.default.findDOMNode(this));if(t&&"function"==typeof t.getAttribute){var e=+t.getAttribute(w)-1;0===e?(t.removeEventListener("scroll",D,_),t.removeAttribute(w)):t.setAttribute(w,e)}}var n=T.indexOf(this);-1!==n&&T.splice(n,1),0===T.length&&"undefined"!=typeof window&&((0,u.off)(window,"resize",D,_),(0,u.off)(window,"scroll",D,_))}},{key:"render",value:function(){return this.visible?this.props.children:this.props.placeholder?this.props.placeholder:o.default.createElement("div",{style:{height:this.props.height},className:"lazyload-placeholder"})}}]),e}();k.propTypes={once:s.default.bool,height:s.default.oneOfType([s.default.number,s.default.string]),offset:s.default.oneOfType([s.default.number,s.default.arrayOf(s.default.number)]),overflow:s.default.bool,resize:s.default.bool,scroll:s.default.bool,children:s.default.node,throttle:s.default.oneOfType([s.default.number,s.default.bool]),debounce:s.default.oneOfType([s.default.number,s.default.bool]),placeholder:s.default.node,scrollContainer:s.default.oneOfType([s.default.string,s.default.object]),unmountIfInvisible:s.default.bool},k.defaultProps={once:!1,offset:0,overflow:!1,resize:!1,scroll:!0,unmountIfInvisible:!1};var R=function(t){return t.displayName||t.name||"Component"};e.lazyload=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e){return function(n){function a(){p(this,a);var t=d(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.displayName="LazyLoad"+R(e),t}return m(a,i.Component),r(a,[{key:"render",value:function(){return o.default.createElement(k,t,o.default.createElement(e,this.props))}}]),a}()}},e.default=k,e.forceCheck=C},291:function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],h=!1,l=-1;function f(){h&&u&&(h=!1,u.length?c=u.concat(c):l=-1,c.length&&p())}function p(){if(!h){var t=s(f);h=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||h||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},294:function(t,e,n){"use strict";n(1476)},295:function(t,e,n){"use strict";n(1478)},296:function(t,e){t.exports=XMLHttpRequest},300:function(t,e,n){"use strict";var r=n(898),i=n.n(r),o=n(793),a=n(924),s="firebasestorage.googleapis.com",u="storageBucket",c=12e4,h=6e5,l=-9007199254740991,f=function(){function t(t,e){this.code_=d(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return d(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),p={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function d(t){return"storage/"+t}function m(){return new f(p.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function y(){return new f(p.CANCELED,"User canceled the upload/download.")}function g(){return new f(p.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function v(t,e,n){return new f(p.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function b(){return new f(p.APP_DELETED,"The Firebase app was deleted.")}function w(t,e){return new f(p.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function T(t){throw new f(p.INTERNAL_ERROR,"Internal error: "+t)}var E={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function S(t){switch(t){case E.RAW:case E.BASE64:case E.BASE64URL:case E.DATA_URL:return;default:throw"Expected one of the event types: ["+E.RAW+", "+E.BASE64+", "+E.BASE64URL+", "+E.DATA_URL+"]."}}var I=function(){return function(t,e){this.data=t,this.contentType=e||null}}();function _(t,e){switch(t){case E.RAW:return new I(A(e));case E.BASE64:case E.BASE64URL:return new I(C(t,e));case E.DATA_URL:return new I((n=new N(e)).base64?C(E.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(n){throw w(E.DATA_URL,"Malformed data URL.")}return A(e)}(n.rest),function(t){return new N(t).contentType}(e))}var n;throw m()}function A(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function C(t,e){switch(t){case E.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw w(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case E.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw w(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(c){throw w(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var N=function(){return function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw w(E.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var r,i}}();var D,k={STATE_CHANGED:"state_changed"},R={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},O={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function P(t){switch(t){case R.RUNNING:case R.PAUSING:case R.CANCELING:return O.RUNNING;case R.PAUSED:return O.PAUSED;case R.SUCCESS:return O.SUCCESS;case R.CANCELED:return O.CANCELED;case R.ERROR:default:return O.ERROR}}function L(t){return null!=t}function M(t){return void 0!==t}function x(t){return"function"==typeof t}function U(t){return"object"==typeof t}function F(t){return U(t)&&null!==t}function V(t){return"string"==typeof t||t instanceof String}function B(t){return q(t)&&Number.isInteger(t)}function q(t){return"number"==typeof t||t instanceof Number}function j(t){return G()&&t instanceof Blob}function G(){return"undefined"!=typeof Blob}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(D||(D={}));var W=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=D.NO_ERROR,this.sendPromise_=new Promise(function(e){t.xhr_.addEventListener("abort",function(){t.errorCode_=D.ABORT,e(t)}),t.xhr_.addEventListener("error",function(){t.errorCode_=D.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(){e(t)})})}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw T("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),L(r))for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return L(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw T("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw T("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw T("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){L(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){L(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),K=function(){function t(){}return t.prototype.createXhrIo=function(){return new W},t}();function H(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}var z=function(){function t(t,e){var n=0,r="";j(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(j(this.data_)){var r=this.data_,i=(a=e,s=n,(o=r).webkitSlice?o.webkitSlice(a,s):o.mozSlice?o.mozSlice(a,s):o.slice?o.slice(a,s):null);return null===i?null:new t(i)}var o,a,s;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(G()){var r=e.map(function(e){return e instanceof t?e.data_:e});return new t(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=H();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(G())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}.apply(null,r))}var i=e.map(function(t){return V(t)?_(E.RAW,t).data:t.data_}),o=0;i.forEach(function(t){o+=t.byteLength});var a=new Uint8Array(o),s=0;return i.forEach(function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]}),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Q=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n,r;try{n=t.makeFromUrl(e)}catch(i){return new t(e,"")}if(""===n.path)return n;throw r=e,new f(p.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")},t.makeFromUrl=function(e){var n=null;var r=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");for(var i=s.replace(/[.]/g,"\\."),o=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+i+"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(t){t.path_=decodeURIComponent(t.path)}}],a=0;a<o.length;a++){var u=o[a],c=u.regex.exec(e);if(c){var h=c[u.indices.bucket],l=c[u.indices.path];l||(l=""),n=new t(h,l),u.postModify(n);break}}if(null==n)throw function(t){return new f(p.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return n},t}();function Y(t){var e,n;try{e=JSON.parse(t)}catch(r){return null}return U(n=e)&&!Array.isArray(n)?e:null}function X(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function J(t){return"https://"+s+"/v0"+t}function $(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}function Z(t,e){return e}var tt=function(){return function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Z}}(),et=null;function nt(){if(et)return et;var t=[];t.push(new tt("bucket")),t.push(new tt("generation")),t.push(new tt("metageneration")),t.push(new tt("name","fullPath",!0));var e=new tt("name");e.xform=function(t,e){return function(t){return!V(t)||t.length<2?t:X(t)}(e)},t.push(e);var n=new tt("size");return n.xform=function(t,e){return L(e)?Number(e):e},t.push(n),t.push(new tt("timeCreated")),t.push(new tt("updated")),t.push(new tt("md5Hash",null,!0)),t.push(new tt("cacheControl",null,!0)),t.push(new tt("contentDisposition",null,!0)),t.push(new tt("contentEncoding",null,!0)),t.push(new tt("contentLanguage",null,!0)),t.push(new tt("contentType",null,!0)),t.push(new tt("metadata","customMetadata",!0)),et=t}function rt(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new Q(n,r);return e.makeStorageReference(i)}})}(r,t),r}function it(t,e,n){var r=Y(e);return null===r?null:rt(t,r,n)}function ot(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function at(t){if(!U(t)||!t)throw"Expected Metadata object.";for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if("customMetadata"===e){if(!U(n))throw"Expected object for 'customMetadata' mapping."}else if(F(n))throw"Mapping for '"+e+"' cannot be an object."}}var st="maxResults",ut=1e3,ct="pageToken",ht="prefixes",lt="items";function ft(t,e){var n={prefixes:[],items:[],nextPageToken:e.nextPageToken},r=t.bucket();if(null===r)throw new f(p.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+u+"' property when initializing the app?");if(e[ht])for(var i=0,o=e[ht];i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t.makeStorageReference(new Q(r,a));n.prefixes.push(s)}if(e[lt])for(var c=0,h=e[lt];c<h.length;c++){var l=h[c];s=t.makeStorageReference(new Q(r,l.name));n.items.push(s)}return n}function pt(t){if(!U(t)||!t)throw"Expected ListOptions object.";for(var e in t)if(e===st){if(!B(t[st])||t[st]<=0)throw"Expected maxResults to be a positive number.";if(t[st]>1e3)throw"Expected maxResults to be less than or equal to "+ut+"."}else{if(e!==ct)throw"Unknown option: "+e;if(t[ct]&&!V(t[ct]))throw"Expected pageToken to be string."}}var dt=function(){return function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}();function mt(t){if(!t)throw m()}function yt(t,e){return function(n,r){var i=it(t,r,e);return mt(null!==i),i}}function gt(t){return function(e,n){var r=function(t,e){var n=Y(e);return null===n?null:ft(t,n)}(t,n);return mt(null!==r),r}}function vt(t,e){return function(n,r){var i=it(t,r,e);return mt(null!==i),function(t,e){var n=Y(e);if(null===n)return null;if(!V(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map(function(e){var n=t.bucket,r=t.fullPath;return J("/b/"+i(n)+"/o/"+i(r))+$({alt:"media",token:e})})[0]}(i,r)}}function bt(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=new f(p.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new f(p.QUOTA_EXCEEDED,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new f(p.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.setServerResponseProp(n.serverResponseProp()),r}}function wt(t){var e=bt(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new f(p.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),o.setServerResponseProp(r.serverResponseProp()),o}}function Tt(t,e,n){var r=J(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new dt(r,"GET",yt(t,n),i);return o.errorHandler=wt(e),o}function Et(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}var St=function(){return function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}}();function It(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(r){mt(!1)}return mt(!!n&&-1!==(e||["active"]).indexOf(n)),n}function _t(t,e,n,r,i,o,a,s){var u=new St(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new f(p.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,d=l+h,m={"X-Goog-Upload-Command":h===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},y=r.slice(l,d);if(null===y)throw g();var v=e.maxUploadRetryTime(),b=new dt(n,"POST",function(t,n){var i,a=It(t,["active","final"]),s=u.current+h,c=r.size();return i="final"===a?yt(e,o)(t,n):null,new St(s,c,"final"===a,i)},v);return b.headers=m,b.body=y.uploadData(),b.progressCallback=s||null,b.errorHandler=bt(t),b}var At=function(){return function(t,e,n){if(x(t)||L(e)||L(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}}}(),Ct=function(){return function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o}}();function Nt(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}var a,s,u,c,h,l;if(!(r<=n.length&&n.length<=i))throw a=r,s=i,u=t,c=n.length,a===s?(h=a,l=1===a?"argument":"arguments"):(h="between "+a+" and "+s,l="arguments"),new f(p.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+u+"`: Expected "+h+" "+l+", received "+c+".");for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(d){throw d instanceof Error?v(o,t,d.message):v(o,t,d)}}var Dt=function(){return function(t,e){var n=this;this.validator=function(e){n.optional&&!M(e)||t(e)},this.optional=!!e}}();function kt(t,e){function n(t){if(!V(t))throw"Expected string."}var r,i,o;return t?(i=n,o=t,r=function(t){i(t),o(t)}):r=n,new Dt(r,e)}function Rt(){return new Dt(function(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||G()&&t instanceof Blob))throw"Expected Blob or File."})}function Ot(t){return new Dt(at,t)}function Pt(){return new Dt(function(t){if(!(q(t)&&t>=0))throw"Expected a number 0 or greater."})}function Lt(t,e){return new Dt(function(e){if(!(null===e||L(e)&&e instanceof Object))throw"Expected an Object.";null!=t&&t(e)},e)}function Mt(t){return new Dt(function(t){if(null!==t&&!x(t))throw"Expected a Function."},t)}function xt(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then(function(){return t.apply(void 0,e)})}}var Ut=function(){function t(t,e,n,r,i,o){var a=this;void 0===o&&(o=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=R.RUNNING,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(p.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(R.ERROR))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(p.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(R.ERROR))},this.promise_=new Promise(function(t,e){a.resolve_=t,a.reject_=e,a.start_()}),this.promise_.then(null,function(){})}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n){return t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===R.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then(function(n){switch(e.state_){case R.RUNNING:t(n);break;case R.CANCELING:e.transition_(R.CANCELED);break;case R.PAUSING:e.transition_(R.PAUSED)}})},t.prototype.createResumable_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=Et(e,r,i),s={name:a.fullPath},u=J(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},h=ot(a,n),l=t.maxUploadRetryTime(),f=new dt(u,"POST",function(t){var e;It(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(n){mt(!1)}return mt(V(e)),e},l);return f.urlParams=s,f.headers=c,f.body=h,f.errorHandler=bt(e),f}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()},t.errorHandler_)})},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_(function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime(),o=new dt(n,"POST",function(t){var e=It(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(o){mt(!1)}n||mt(!1);var i=Number(n);return mt(!isNaN(i)),new St(i,r.size(),"final"===e)},i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=bt(e),o}(t.authWrapper_,t.location_,e,t.blob_),i=t.authWrapper_.makeRequest(r,n);t.request_=i,i.getPromise().then(function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()},t.errorHandler_)})},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new St(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=_t(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(s){return t.error_=s,void t.transition_(R.ERROR)}var a=t.authWrapper_.makeRequest(o,i);t.request_=a,a.getPromise().then(function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(R.SUCCESS)):t.completeTransitions_()},t.errorHandler_)})},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_(function(e){var n=Tt(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.transition_(R.SUCCESS)},t.metadataErrorHandler_)})},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=Et(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ot(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+s+"--",l=z.getBlob(c,r,h);if(null===l)throw g();var f={name:u.fullPath},p=J(o),d=t.maxUploadRetryTime(),m=new dt(p,"POST",yt(t,n),d);return m.urlParams=f,m.headers=a,m.body=l.uploadData(),m.errorHandler=bt(e),m}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(R.SUCCESS)},t.errorHandler_)})},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case R.CANCELING:case R.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case R.RUNNING:var e=this.state_===R.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case R.PAUSED:this.state_=t,this.notifyObservers_();break;case R.CANCELED:this.error_=y(),this.state_=t,this.notifyObservers_();break;case R.ERROR:case R.SUCCESS:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case R.PAUSING:this.transition_(R.PAUSED);break;case R.CANCELING:this.transition_(R.CANCELED);break;case R.RUNNING:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=P(this.state_);return new Ct(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){var i="Expected a function or an Object with one of `next`, `error`, `complete` properties.",o=Mt(!0).validator,a=Lt(null,!0).validator;function s(t){try{return void o(t)}catch(e){}try{if(a(t),!(M(t.next)||M(t.error)||M(t.complete)))throw"";return}catch(e){throw i}}Nt("on",[kt(function(){if(t!==k.STATE_CHANGED)throw"Expected one of the event types: ["+k.STATE_CHANGED+"]."}),Lt(s,!0),Mt(!0),Mt(!0)],arguments);var u=this;function c(t){return function(e,n,i){null!==t&&Nt("on",t,arguments);var o=new At(e,n,r);return u.addObserver_(o),function(){u.removeObserver_(o)}}}var h=[Lt(function(t){if(null===t)throw i;s(t)}),Mt(!0),Mt(!0)];return!(M(e)||M(n)||M(r))?c(h):c(null)(e,n,r)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);-1!==e&&this.observers_.splice(e,1)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),this.observers_.slice().forEach(function(e){t.notifyObserver_(e)})},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(P(this.state_)){case O.SUCCESS:xt(this.resolve_.bind(null,this.snapshot))();break;case O.CANCELED:case O.ERROR:xt(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(P(this.state_)){case O.RUNNING:case O.PAUSED:t.next&&xt(t.next.bind(t,this.snapshot))();break;case O.SUCCESS:t.complete&&xt(t.complete.bind(t))();break;case O.CANCELED:case O.ERROR:t.error&&xt(t.error.bind(t,this.error_))();break;default:t.error&&xt(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){Nt("resume",[],arguments);var t=this.state_===R.PAUSED||this.state_===R.PAUSING;return t&&this.transition_(R.RUNNING),t},t.prototype.pause=function(){Nt("pause",[],arguments);var t=this.state_===R.RUNNING;return t&&this.transition_(R.PAUSING),t},t.prototype.cancel=function(){Nt("cancel",[],arguments);var t=this.state_===R.RUNNING||this.state_===R.PAUSING;return t&&this.transition_(R.CANCELING),t},t}(),Ft=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof Q?e:Q.makeFromUrl(e)}return t.prototype.toString=function(){return Nt("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return nt()},t.prototype.child=function(t){Nt("child",[kt()],arguments);var e=function(t,e){var n=e.split("/").filter(function(t){return t.length>0}).join("/");return 0===t.length?n:t+"/"+n}(this.location.path,t),n=new Q(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new Q(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new Q(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return X(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),Nt("put",[Rt(),Ot(!0)],arguments),this.throwIfRoot_("put"),new Ut(this,this.authWrapper,this.location,this.mappings(),new z(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=E.RAW),Nt("putString",[kt(),kt(S,!0),Ot(!0)],arguments),this.throwIfRoot_("putString");var r=_(e,t),i=Object.assign({},n);return!L(i.contentType)&&L(r.contentType)&&(i.contentType=r.contentType),new Ut(this,this.authWrapper,this.location,this.mappings(),new z(r.data,!0),i)},t.prototype.delete=function(){var t=this;return Nt("delete",[],arguments),this.throwIfRoot_("delete"),this.authWrapper.getAuthToken().then(function(e){var n=function(t,e){var n=J(e.fullServerUrl()),r=t.maxOperationRetryTime(),i=new dt(n,"DELETE",function(t,e){},r);return i.successCodes=[200,204],i.errorHandler=wt(e),i}(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.listAll=function(){Nt("listAll",[],arguments);var t={prefixes:[],items:[]};return this.listAllHelper(t).then(function(){return t})},t.prototype.listAllHelper=function(t,e){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,r,i,a;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return n={pageToken:e},[4,this.list(n)];case 1:return r=o.sent(),(i=t.prefixes).push.apply(i,r.prefixes),(a=t.items).push.apply(a,r.items),null==r.nextPageToken?[3,3]:[4,this.listAllHelper(t,r.nextPageToken)];case 2:o.sent(),o.label=3;case 3:return[2]}})})},t.prototype.list=function(t){var e;Nt("list",[(e=!0,new Dt(pt,e))],arguments);var n=this;return this.authWrapper.getAuthToken().then(function(e){var r=t||{},i=function(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=J(e.bucketOnlyServerUrl()),s=t.maxOperationRetryTime(),u=new dt(a,"GET",gt(t),s);return u.urlParams=o,u.errorHandler=bt(e),u}(n.authWrapper,n.location,"/",r.pageToken,r.maxResults);return n.authWrapper.makeRequest(i,e).getPromise()})},t.prototype.getMetadata=function(){var t=this;return Nt("getMetadata",[],arguments),this.throwIfRoot_("getMetadata"),this.authWrapper.getAuthToken().then(function(e){var n=Tt(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){var e=this;return Nt("updateMetadata",[Ot()],arguments),this.throwIfRoot_("updateMetadata"),this.authWrapper.getAuthToken().then(function(n){var r=function(t,e,n,r){var i=J(e.fullServerUrl()),o=ot(n,r),a=t.maxOperationRetryTime(),s=new dt(i,"PATCH",yt(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=wt(e),s}(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()})},t.prototype.getDownloadURL=function(){var t=this;return Nt("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.authWrapper.getAuthToken().then(function(e){var n=function(t,e,n){var r=J(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new dt(r,"GET",vt(t,n),i);return o.errorHandler=wt(e),o}(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise().then(function(t){if(null===t)throw new f(p.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return t})})},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new f(p.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},t}(),Vt=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}(),Bt=function(){function t(){this.map=new Map,this.id=l}return t.prototype.addRequest=function(t){var e=this,n=this.id;this.id++,this.map.set(n,t),t.getPromise().then(function(){return e.map.delete(n)},function(){return e.map.delete(n)})},t.prototype.clear=function(){this.map.forEach(function(t){t&&t.cancel(!0)}),this.map.clear()},t}(),qt=function(){function t(e,n,r,i,o,a){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var s=this.app_.options;L(s)&&(this.bucket_=t.extractBucket_(s))}this.authProvider_=n,this.storageRefMaker_=r,this.requestMaker_=i,this.pool_=a,this.service_=o,this.maxOperationRetryTime_=c,this.maxUploadRetryTime_=h,this.requestMap_=new Bt}return t.extractBucket_=function(t){var e=t[u]||null;return null==e?null:Q.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){var t=this.authProvider_.getImmediate({optional:!0});return t?t.getToken().then(function(t){return null!==t?t.accessToken:null},function(){return null}):Promise.resolve(null)},t.prototype.bucket=function(){if(this.deleted_)throw b();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new Vt(b());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}();var jt=function(){function t(t,e,n,r,i,o,a,s,u,c,h){var l=this;this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise(function(t,e){l.resolve_=t,l.reject_=e,l.start_()})}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());M(s)?i(s):i()}catch(u){o(u)}else null!==a?((r=m()).setServerResponseProp(a.getResponseText()),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?b():y()):o(r=new f(p.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new Gt(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,i=null,a=!1,s=0;function u(){return 2===s}var c=!1;function h(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];c||(c=!0,e.apply(null,t))}function l(e){i=setTimeout(function(){i=null,t(f,u())},e)}function f(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];c||(t?h.call.apply(h,Object(o.__spreadArrays)([null,t],n)):u()||a?h.call.apply(h,Object(o.__spreadArrays)([null,t],n)):(r<64&&(r*=2),1===s?(s=2,e=0):e=1e3*(r+Math.random()),l(e)))}var p=!1;function d(t){p||(p=!0,c||(null!==i?(t||(s=2),clearTimeout(i),l(0)):t||(s=1)))}return l(0),setTimeout(function(){a=!0,d(!0)},n),d}(function(e,n){if(n)e(!1,new Gt(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then(function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===D.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new Gt(a,n))}else{var s=n.getErrorCode()===D.ABORT;e(!1,new Gt(!1,null,s))}})}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}},e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),Gt=function(){return function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}}();function Wt(t,e,n){var r=$(t.urlParams),o=t.url+r,a=Object.assign({},t.headers);return function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(a,e),function(t){var e=void 0!==i.a?i.a.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(a),new jt(o,t.method,a,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}var Kt,Ht,zt=function(){function t(t,e,n,r){if(this.bucket_=null,this.authWrapper_=new qt(t,e,function(t,e){return new Ft(t,e)},Wt,this,n),this.app_=t,null!=r)this.bucket_=Q.makeFromBucketSpec(r);else{var i=this.authWrapper_.bucket();null!=i&&(this.bucket_=new Q(i,""))}this.internals_=new Qt(this)}return t.prototype.ref=function(t){if(Nt("ref",[kt(function(t){if("string"!=typeof t)throw"Path is not a string.";if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new Ft(this.authWrapper_,this.bucket_);return null!=t?e.child(t):e},t.prototype.refFromURL=function(t){return Nt("refFromURL",[kt(function(t){if("string"!=typeof t)throw"Path is not a string.";if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{Q.makeFromUrl(t)}catch(e){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new Ft(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){Nt("setMaxUploadRetryTime",[Pt()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},t.prototype.setMaxOperationRetryTime=function(t){Nt("setMaxOperationRetryTime",[Pt()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),Qt=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),Promise.resolve()},t}(),Yt="@firebase/storage",Xt="0.3.26",Jt="storage";function $t(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new zt(n,r,new K,e)}Kt=i.a,Ht={TaskState:O,TaskEvent:k,StringFormat:E,Storage:zt,Reference:Ft},Kt.INTERNAL.registerComponent(new a.Component(Jt,$t,"PUBLIC").setServiceProps(Ht).setMultipleInstances(!0)),Kt.registerVersion(Yt,Xt)},365:function(t,e){t.exports=function(t,e,n,r){var i=n?n.call(r,t,e):void 0;if(void 0!==i)return!!i;if(t===e)return!0;if("object"!=typeof t||!t||"object"!=typeof e||!e)return!1;var o=Object.keys(t),a=Object.keys(e);if(o.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(e),u=0;u<o.length;u++){var c=o[u];if(!s(c))return!1;var h=t[c],l=e[c];if(!1===(i=n?n.call(r,h,l,c):void 0)||void 0===i&&h!==l)return!1}return!0}},793:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return i}),n.d(e,"__assign",function(){return o}),n.d(e,"__rest",function(){return a}),n.d(e,"__decorate",function(){return s}),n.d(e,"__param",function(){return u}),n.d(e,"__metadata",function(){return c}),n.d(e,"__awaiter",function(){return h}),n.d(e,"__generator",function(){return l}),n.d(e,"__exportStar",function(){return f}),n.d(e,"__values",function(){return p}),n.d(e,"__read",function(){return d}),n.d(e,"__spread",function(){return m}),n.d(e,"__spreadArrays",function(){return y}),n.d(e,"__await",function(){return g}),n.d(e,"__asyncGenerator",function(){return v}),n.d(e,"__asyncDelegator",function(){return b}),n.d(e,"__asyncValues",function(){return w}),n.d(e,"__makeTemplateObject",function(){return T}),n.d(e,"__importStar",function(){return E}),n.d(e,"__importDefault",function(){return S});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function l(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function p(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function d(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function g(t){return this instanceof g?(this.v=t,this):new g(t)}function v(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||s(t,e)})})}function s(t,e){try{(n=i[t](e)).value instanceof g?Promise.resolve(n.value.v).then(u,c):h(o[0][2],n)}catch(r){h(o[0][3],r)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function h(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:g(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=p(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,i){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,i,(e=t[n](e)).done,e.value)})}}}function T(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function E(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function S(t){return t&&t.__esModule?t:{default:t}}},898:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i,o=n(793),a=n(923),s=n(924),u=n(1352),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),h=new a.ErrorFactory("app","Firebase",c),l="@firebase/app",f="0.5.4",p="[DEFAULT]",d=((i={})[l]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),m=new u.Logger("@firebase/app"),y=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=a.deepCopy(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",function(){return u},"PUBLIC"));try{for(var c=o.__values(this.firebase_.INTERNAL.components.values()),h=c.next();!h.done;h=c.next()){var l=h.value;this._addComponent(l)}}catch(f){r={error:f}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(t){return t.delete()}))}).then(function(){t.isDeleted_=!0})},t.prototype._getService=function(t,e){return void 0===e&&(e=p),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=p),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){m.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw h.create("app-deleted",{appName:this.name_})},t}();y.prototype.name&&y.prototype.options||y.prototype.delete||console.log("dc");var g="7.8.1";var v=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){if(void 0===i&&(i={}),"object"!=typeof i||null===i){var o=i;i={name:o}}var s=i;void 0===s.name&&(s.name=p);var u=s.name;if("string"!=typeof u||!u)throw h.create("bad-app-name",{appName:String(u)});if(a.contains(e,u))throw h.create("duplicate-app",{appName:u});var c=new t(n,s,r);return e[u]=c,c},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=d[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&c.push("and"),a&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void m.warn(c.join(" "))}u(new s.Component(i+"-version",function(){return{library:i,version:e}},"VERSION"))},apps:null,SDK_VERSION:g,INTERNAL:{registerComponent:u,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||p,!a.contains(e,t))throw h.create("no-app",{appName:t});return e[t]}function u(s){var u,c,l=s.name;if(n.has(l))return m.debug("There were multiple attempts to register component "+l+"."),"PUBLIC"===s.type?r[l]:null;if(n.set(l,s),"PUBLIC"===s.type){var f=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[l])throw h.create("invalid-app-argument",{appName:l});return t[l]()};void 0!==s.serviceProps&&a.deepExtend(f,s.serviceProps),r[l]=f,t.prototype[l]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,l).apply(this,s.multipleInstances?t:[])}}try{for(var p=o.__values(Object.keys(e)),d=p.next();!d.done;d=p.next()){var y=d.value;e[y]._addComponent(s)}}catch(g){u={error:g}}finally{try{d&&!d.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}return"PUBLIC"===s.type?r[l]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map(function(t){return e[t]})}}),i.App=t,r}(y);return e.INTERNAL=o.__assign(o.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){a.deepExtend(e,t)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),e}(),b=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if(function(t){var e,n=t.getComponent();return"VERSION"===(null===(e=n)||void 0===e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null}).filter(function(t){return t}).join(" ")},t}();if(a.isBrowser()&&void 0!==self.firebase){m.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var w=self.firebase.SDK_VERSION;w&&w.indexOf("LITE")>=0&&m.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var T=v.initializeApp;v.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return a.isNode()&&m.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),T.apply(void 0,t)};var E=v;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",function(t){return new b(t)},"PRIVATE")),t.registerVersion(l,f,e),t.registerVersion("fire-js","")}(E),e.default=E,e.firebase=E},906:function(t,e,n){var r;!function(){"use strict";var i=!("undefined"==typeof window||!window.document||!window.document.createElement),o={canUseDOM:i,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen};void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r)}()},910:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.on=function(t,e,n,r){r=r||!1,t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on"+e,function(e){n.call(t,e||window.event)})},e.off=function(t,e,n,r){r=r||!1,t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent&&t.detachEvent("on"+e,n)}},911:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(!(t instanceof HTMLElement))return document.documentElement;for(var e="absolute"===t.style.position,n=/(scroll|auto)/,r=t;r;){if(!r.parentNode)return t.ownerDocument||document.documentElement;var i=window.getComputedStyle(r),o=i.position,a=i.overflow,s=i["overflow-x"],u=i["overflow-y"];if("static"===o&&e)r=r.parentNode;else{if(n.test(a)&&n.test(s)&&n.test(u))return r;r=r.parentNode}}return t.ownerDocument||t.documentElement||document.documentElement}},912:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){var r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,u=function u(){var c=+new Date-a;c<e&&c>=0?r=setTimeout(u,e-c):(r=null,n||(s=t.apply(o,i),r||(o=null,i=null)))};return function(){o=this,i=arguments,a=+new Date;var c=n&&!r;return r||(r=setTimeout(u,e)),c&&(s=t.apply(o,i),o=null,i=null),s}}},913:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){var r,i;return e||(e=250),function(){var o=n||this,a=+new Date,s=arguments;r&&a<r+e?(clearTimeout(i),i=setTimeout(function(){r=a,t.apply(o,s)},e)):(r=a,t.apply(o,s))}}},923:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(793),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var h=a<<4&240|s>>2;if(r.push(h),64!==u){var l=s<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){try{return u.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=h(t[n],e[n]));return t}var l=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var p="FirebaseError",d=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=p,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return r.__extends(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?function(t,e){return t.replace(y,function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"})}(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new d(i,s),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),u[l]=r[l])}return u},t}();var y=/\{\$([^}]+)}/g;function g(t){return JSON.parse(t)}var v=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=g(c(o[0])||""),n=g(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:e,claims:n,data:r,signature:i}};var b=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();var w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=T),void 0===r.error&&(r.error=T),void 0===r.complete&&(r.complete=T);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function T(){}function E(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}e.CONSTANTS=i,e.Deferred=l,e.ErrorFactory=m,e.FirebaseError=d,e.Sha1=b,e.assert=o,e.assertionError=a,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}},e.base64=u,e.base64Decode=c,e.base64Encode=function(t){var e=s(t);return u.encodeByteArray(e,!0)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new w(t,e);return n.subscribe.bind(n)},e.decode=v,e.deepCopy=function(t){return h(void 0,t)},e.deepExtend=h,e.errorPrefix=E,e.getUA=f,e.isAdmin=function(t){var e=v(t).claims;return"object"==typeof e&&!0===e.admin},e.isBrowser=function(){return"object"==typeof self&&self.self===self},e.isBrowserExtension=function(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id},e.isElectron=function(){return f().indexOf("Electron/")>=0},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isIE=function(){var t=f();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},e.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}},e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isUWP=function(){return f().indexOf("MSAppHost/")>=0},e.isValidFormat=function(t){var e=v(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e=v(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=v(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=g,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r},e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;o(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(E(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(E(t,e,r)+"must be a valid context object.")},e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(E(t,e,r)+"must be a valid firebase namespace.")}}).call(this,n(25))},924:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(793),i=n(923),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),a="[DEFAULT]",s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=a);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r.__assign({identifier:a,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(u){if(i)return null;throw u}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService(a)}catch(f){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=r.__read(o.value,2),u=s[0],c=s[1],h=this.normalizeInstanceIdentifier(u);try{var l=this.getOrInitializeService(h);c.resolve(l)}catch(f){}}}catch(p){e={error:p}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=a),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))];case 1:return e.sent(),[2]}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===a?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:a:t},t}();var u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();e.Component=o,e.ComponentContainer=u,e.Provider=s}}]);
//# sourceMappingURL=1-49154a35d27f4488f455.js.map